var __extends=this.__extends||function(n,t){function r(){this.constructor=n}for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i]);r.prototype=t.prototype,n.prototype=new r},GameRunnerInstance,eg,EndGate;(function(n){var t=function(){function n(t,i,r){typeof i=="undefined"&&(i=0),typeof r=="undefined"&&(r=0),this._type="TimeSpan",this.Milliseconds=t+i*n._secondsMultiplier+r*n._minutesMultiplier}return Object.defineProperty(n.prototype,"Milliseconds",{get:function(){return this._milliseconds},set:function(t){this._milliseconds=t,this._seconds=t/n._secondsMultiplier,this._minutes=t/n._minutesMultiplier},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"Seconds",{get:function(){return this._seconds},set:function(t){this._seconds=t,this._milliseconds=t*n._secondsMultiplier,this._minutes=this._milliseconds/n._minutesMultiplier},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"Minutes",{get:function(){return this._seconds},set:function(t){this._minutes=t,this._seconds=t*60,this._milliseconds=this._seconds*n._secondsMultiplier},enumerable:!0,configurable:!0}),n.prototype.Add=function(t){return t._type==="TimeSpan"?new n(this.Milliseconds+t.Milliseconds):new n(this.Milliseconds+t)},n.prototype.Multiply=function(t){return t._type==="TimeSpan"?new n(this.Milliseconds*t.Milliseconds):new n(this.Milliseconds*t)},n.prototype.Subtract=function(t){return t._type==="TimeSpan"?new n(this.Milliseconds-t.Milliseconds):new n(this.Milliseconds-t)},n.prototype.SubtractFrom=function(t){return t._type==="TimeSpan"?new n(t.Milliseconds-this.Milliseconds):new n(t-this.Milliseconds)},n.prototype.Divide=function(t){return t._type==="TimeSpan"?new n(this.Milliseconds/t.Milliseconds):new n(this.Milliseconds/t)},n.prototype.DivideFrom=function(t){return t._type==="TimeSpan"?new n(t.Milliseconds/this.Milliseconds):new n(t/this.Milliseconds)},n.prototype.Equivalent=function(n){return this.Milliseconds===n.Milliseconds},n.prototype.Clone=function(){return new n(this.Milliseconds)},n.prototype.toString=function(){return this.Milliseconds+":"+this.Seconds+":"+this.Minutes},n.FromMilliseconds=function(t){return new n(t)},n.FromSeconds=function(t){return new n(0,t)},n.FromMinutes=function(t){return new n(0,0,t)},n.DateSpan=function(t,i){return new n(i.getTime()-t.getTime())},Object.defineProperty(n,"Zero",{get:function(){return new n(0)},enumerable:!0,configurable:!0}),n._secondsMultiplier=1e3,n._minutesMultiplier=n._secondsMultiplier*60,n}();n.TimeSpan=t})(EndGate||(EndGate={})),function(n){var t=function(){function t(){this._type="GameTime",this._start=this._lastUpdate=new Date,this.Update()}return Object.defineProperty(t.prototype,"Elapsed",{get:function(){return this._elapsed},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"Now",{get:function(){return this._lastUpdate},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"Total",{get:function(){return n.TimeSpan.DateSpan(this._start,new Date)},enumerable:!0,configurable:!0}),t.prototype.Update=function(){var t=new Date;this._elapsed=new n.TimeSpan(t.getTime()-this._lastUpdate.getTime()),this._lastUpdate=t},t}();n.GameTime=t}(EndGate||(EndGate={})),function(n){var t=function(){function n(n,t){this._type="Size2d",this.Width=n||0,this.Height=typeof t!="undefined"?t:this.Width}return Object.defineProperty(n,"Zero",{get:function(){return new n(0,0)},enumerable:!0,configurable:!0}),Object.defineProperty(n,"One",{get:function(){return new n(1,1)},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"Radius",{get:function(){return.5*Math.sqrt(this.Width*this.Width+this.Height*this.Height)},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"HalfWidth",{get:function(){return this.Width/2},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"HalfHeight",{get:function(){return this.Height/2},enumerable:!0,configurable:!0}),n.prototype.Apply=function(n){this.Width=n(this.Width),this.Height=n(this.Height)},n.prototype.Trigger=function(n){n(this.Width),n(this.Height)},n.prototype.Add=function(t){return t._type==="Size2d"?new n(this.Width+t.Width,this.Height+t.Height):t._type==="Vector2d"?new n(this.Width+t.X,this.Height+t.Y):new n(this.Width+t,this.Height+t)},n.prototype.Multiply=function(t){return t._type==="Size2d"?new n(this.Width*t.Width,this.Height*t.Height):t._type==="Vector2d"?new n(this.Width*t.X,this.Height*t.Y):new n(this.Width*t,this.Height*t)},n.prototype.Subtract=function(t){return t._type==="Size2d"?new n(this.Width-t.Width,this.Height-t.Height):t._type==="Vector2d"?new n(this.Width-t.X,this.Height-t.Y):new n(this.Width-t,this.Height-t)},n.prototype.SubtractFrom=function(t){return t._type==="Size2d"?new n(t.Width-this.Width,t.Height-this.Height):t._type==="Vector2d"?new n(t.X-this.Width,t.Y-this.Height):new n(t-this.Width,t-this.Height)},n.prototype.Divide=function(t){return t._type==="Size2d"?new n(this.Width/t.Width,this.Height/t.Height):t._type==="Vector2d"?new n(this.Width/t.X,this.Height/t.Y):new n(this.Width/t,this.Height/t)},n.prototype.DivideFrom=function(t){return t._type==="Size2d"?new n(t.Width/this.Width,t.Height/this.Height):t._type==="Vector2d"?new n(t.X/this.Width,t.Y/this.Height):new n(t/this.Width,t/this.Height)},n.prototype.Negate=function(){return new n(this.Width*-1,this.Height*-1)},n.prototype.Equivalent=function(n){return this.Width===n.Width&&this.Height===n.Height},n.prototype.Clone=function(){return new n(this.Width,this.Height)},n.prototype.toString=function(){return"("+this.Width+", "+this.Height+")"},n}();n.Size2d=t}(EndGate||(EndGate={})),Math.roundTo=function(n,t){var i=Math.pow(10,t);return Math.round(n*i)/i},Math.twoPI=Math.PI*2,function(n){var t=function(){function n(n,t){this._type="Vector2d",this.X=n||0,this.Y=t||0}return Object.defineProperty(n,"Zero",{get:function(){return new n(0,0)},enumerable:!0,configurable:!0}),Object.defineProperty(n,"One",{get:function(){return new n(1,1)},enumerable:!0,configurable:!0}),n.prototype.Reflect=function(t){var i=t.Unit(),r=this.Dot(i)*2;return new n(this.X-r*i.X,this.Y-r*i.Y)},n.prototype.ProjectOnto=function(n){return n.Multiply(this.Dot(n)/n.Dot(n))},n.prototype.RotateAround=function(t,i,r){typeof r=="undefined"&&(r=2);var u=Math.cos(i),f=Math.sin(i);return new n(Math.roundTo(u*(this.X-t.X)-f*(this.Y-t.Y)+t.X,r),Math.roundTo(f*(this.X-t.X)+u*(this.Y-t.Y)+t.Y,r))},n.prototype.Apply=function(n){this.X=n(this.X),this.Y=n(this.Y)},n.prototype.Trigger=function(n){n(this.X),n(this.Y)},n.prototype.Normalized=function(){var t=this.Magnitude();return new n(this.X/t,this.Y/t)},n.prototype.Magnitude=function(){return Math.sqrt(this.X*this.X+this.Y*this.Y)},n.prototype.Length=function(){return this.Magnitude()},n.prototype.Dot=function(n){return n.X*this.X+n.Y*this.Y},n.prototype.Abs=function(){return new n(Math.abs(this.X),Math.abs(this.Y))},n.prototype.Sign=function(){return new n(this.X/Math.abs(this.X),this.Y/Math.abs(this.Y))},n.prototype.Unit=function(){var t=this.Magnitude();return new n(this.X/t,this.Y/t)},n.prototype.Distance=function(t){return new n(Math.abs(t.X-this.X),Math.abs(t.Y-this.Y))},n.prototype.Add=function(t){return t._type==="Vector2d"?new n(this.X+t.X,this.Y+t.Y):t._type==="Size2d"?new n(this.X+t.Width,this.Y+t.Height):new n(this.X+t,this.Y+t)},n.prototype.Multiply=function(t){return t._type==="Vector2d"?new n(this.X*t.X,this.Y*t.Y):t._type==="Size2d"?new n(this.X*t.Width,this.Y*t.Height):new n(this.X*t,this.Y*t)},n.prototype.Subtract=function(t){return t._type==="Vector2d"?new n(this.X-t.X,this.Y-t.Y):t._type==="Size2d"?new n(this.X-t.Width,this.Y-t.Height):new n(this.X-t,this.Y-t)},n.prototype.SubtractFrom=function(t){return t._type==="Vector2d"?new n(t.X-this.X,t.Y-this.Y):t._type==="Size2d"?new n(t.Width-this.X,t.Height=this.Y):new n(t-this.X,t-this.Y)},n.prototype.Divide=function(t){return t._type==="Vector2d"?new n(this.X/t.X,this.Y/t.Y):t._type==="Size2d"?new n(this.X/t.Width,this.Y/t.Height):new n(this.X/t,this.Y/t)},n.prototype.DivideFrom=function(t){return t._type==="Vector2d"?new n(t.X/this.X,t.Y/this.Y):t._type==="Size2d"?new n(t.Width/this.X,t.Height/this.Y):new n(t/this.X,t/this.Y)},n.prototype.IsZero=function(){return this.X===0&&this.Y===0},n.prototype.Negate=function(){return new n(this.X*-1,this.Y*-1)},n.prototype.Equivalent=function(n){return this.X===n.X&&this.Y===n.Y},n.prototype.Clone=function(){return new n(this.X,this.Y)},n.prototype.toString=function(){return"("+this.X+", "+this.Y+")"},n}();n.Vector2d=t}(EndGate||(EndGate={})),function(n){(function(n){(function(n){var t=function(){function n(n,t){this._boundsType="Bounds2d",this.Position=n,this.Rotation=t||0}return n.prototype.Scale=function(){throw new Error("This method is abstract!");},n.prototype.ContainsPoint=function(){throw new Error("This method is abstract!");},n.prototype.Intersects=function(n){if(n._boundsType==="BoundingCircle")return this.IntersectsCircle(n);if(n._boundsType==="BoundingRectangle")return this.IntersectsRectangle(n);throw new Error("Cannot intersect with unidentifiable object, must be BoundingCircle or BoundingRectangle");},n.prototype.IntersectsCircle=function(){throw new Error("This method is abstract!");},n.prototype.IntersectsRectangle=function(){throw new Error("This method is abstract!");},n}();n.Bounds2d=t})(n.Abstractions||(n.Abstractions={}));var t=n.Abstractions})(n.Bounds||(n.Bounds={}));var t=n.Bounds}(EndGate||(EndGate={})),function(n){(function(n){(function(n){var t=function(){function n(t){this._type="LooperCallback",this.Callback=t,this.ID=n._ids++}return n._ids=0,n}();n.LooperCallback=t})(n.Loopers||(n.Loopers={}));var t=n.Loopers})(n._||(n._={}));var t=n._}(EndGate||(EndGate={})),function(n){(function(n){(function(n){var t=function(n){function t(t,i){n.call(this,i),this._type="TimedCallback",this.Fps=t,this.TimeoutID=0,this.Active=!1}return __extends(t,n),t}(n.LooperCallback);n.TimedCallback=t})(n.Loopers||(n.Loopers={}));var t=n.Loopers})(n._||(n._={}));var t=n._}(EndGate||(EndGate={})),function(n){(function(n){(function(n){var t=function(){function n(){this._type="Looper",this._running=!1,this._callbacks=[]}return n.prototype.AddCallback=function(n){var t=this;this._callbacks.push(n),n.Active=!0,this._running&&window.setTimeout(function(){t.Loop(n)},0)},n.prototype.RemoveCallback=function(n){for(var t=0;t<this._callbacks.length;t++)if(this._callbacks[t].ID===n.ID){window.clearTimeout(n.TimeoutID),n.Active=!1,this._callbacks.splice(t,1);return}},n.prototype.Start=function(){this._running=!0,this.Run()},n.prototype.Run=function(){for(var t=this,n=0;n<this._callbacks.length;n++)window.setTimeout(function(n){return function(){t.Loop(t._callbacks[n])}}(n),0)},n.prototype.Loop=function(n){var t=this,i=1e3/n.Fps;n.Callback(),n.Active&&(n.TimeoutID=window.setTimeout(function(){t.Loop(n)},i))},n.prototype.Dispose=function(){for(var n=this._callbacks.length-1;n>=0;n--)this.RemoveCallback(this._callbacks[n]);this._callbacks=[],this._running=!1},n}();n.Looper=t})(n.Loopers||(n.Loopers={}));var t=n.Loopers})(n._||(n._={}));var t=n._}(EndGate||(EndGate={})),window.OnRepaintCompleted=function(){return window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(n){window.setTimeout(n,0)}}(),function(n){(function(n){(function(n){var t=function(){function n(){this._type="RepaintLooper",this._running=!1,this._callbacksModified=!1,this._callbacks=[]}return n.prototype.Start=function(){this._running=!0,this.Run()},n.prototype.Run=function(){var t=this,n;if(this._running){for(this._callbacksModified=!1,n=0;n<this._callbacks.length;n++)if(this._callbacks[n].Callback(),this._callbacksModified)break;window.OnRepaintCompleted(function(){t.Run()})}},n.prototype.AddCallback=function(n){this._callbacksModified=!0,this._callbacks.push(n)},n.prototype.RemoveCallback=function(n){for(var t=0;t<this._callbacks.length;t++)if(this._callbacks[t].ID===n.ID){this._callbacksModified=!0,this._callbacks.splice(t,1);return}},n.prototype.Dispose=function(){this._callbacksModified=!0,this._callbacks=[],this._running=!1},n}();n.RepaintLooper=t})(n.Loopers||(n.Loopers={}));var t=n.Loopers})(n._||(n._={}));var t=n._}(EndGate||(EndGate={})),function(n){(function(n){var t=function(){function t(){this._type="GameRunner",this._updateCallbacks={},this._drawCallbacks={},this._updateLoop=null,this._drawLoop=null,this._callbackCount=0}return t.prototype.Register=function(n){var t=this.CreateAndCacheUpdateCallback(n),i=this.CreateAndCacheDrawCallback(n);return this._callbackCount++,this.TryLoopStart(),this._updateLoop.AddCallback(t),this._drawLoop.AddCallback(i),this.CreateUpdateRateSetter(t)},t.prototype.Unregister=function(n){var t,i;this._updateCallbacks[n._ID]&&(t=this._updateCallbacks[n._ID],i=this._drawCallbacks[n._ID],this._updateLoop.RemoveCallback(t),this._drawLoop.RemoveCallback(i),delete this._updateCallbacks[n._ID],delete this._drawCallbacks[n._ID],this._callbackCount--,this.TryLoopStop())},t.prototype.TryLoopStart=function(){this._callbackCount===1&&(this._updateLoop=new n.Loopers.Looper,this._updateLoop.Start(),this._drawLoop=new n.Loopers.RepaintLooper,this._drawLoop.Start())},t.prototype.TryLoopStop=function(){this._callbackCount===0&&this._updateLoop!=null&&(this._updateLoop.Dispose(),this._updateLoop=null,this._drawLoop.Dispose(),this._drawLoop=null)},t.prototype.CreateAndCacheUpdateCallback=function(t){var i=new n.Loopers.TimedCallback(0,function(){t._PrepareUpdate()});return this._updateCallbacks[t._ID]=i,i},t.prototype.CreateAndCacheDrawCallback=function(t){var i=new n.Loopers.LooperCallback(function(){t._PrepareDraw()});return this._drawCallbacks[t._ID]=i,i},t.prototype.CreateUpdateRateSetter=function(n){return function(t){n.Fps=t}},t}();n.GameRunner=t})(n._||(n._={}));var t=n._}(EndGate||(EndGate={})),GameRunnerInstance=new EndGate._.GameRunner,function(n){var t=function(){function n(n){this._defaultUpdateRate=40,this._updateRateSetter=n,this._updateRate=this._defaultUpdateRate}return Object.defineProperty(n.prototype,"UpdateRate",{get:function(){return this._updateRate},set:function(n){this._updateRate=n,this._updateRateSetter(this._updateRate)},enumerable:!0,configurable:!0}),n}();n.GameConfiguration=t}(EndGate||(EndGate={})),function(n){var t=function(){function n(){this._type="Event",this._actions=[],this._hasBindings=!1}return n.prototype.Bind=function(n){this._actions.push(n),this._hasBindings=!0},n.prototype.Unbind=function(n){for(var t=0;t<this._actions.length;t++)if(this._actions[t]===n){this._actions.splice(t,1),this._hasBindings=this._actions.length>0;return}},n.prototype.HasBindings=function(){return this._hasBindings},n.prototype.Trigger=function(n){for(var t=0;t<this._actions.length;t++)this._actions[t](n)},n}();n.EventHandler1=t}(EndGate||(EndGate={})),function(n){(function(n){(function(n){var t=function(){function n(n,t){this.At=n,this.With=t}return n}();n.CollisionData=t})(n.Assets||(n.Assets={}));var t=n.Assets})(n.Collision||(n.Collision={}));var t=n.Collision}(EndGate||(EndGate={})),function(n){(function(t){var i=function(){function t(i){this._type="Collidable",this._disposed=!1,this.Bounds=i,this._id=t._collidableIDs++,this._onCollision=new n.EventHandler1,this._onDisposed=new n.EventHandler1}return Object.defineProperty(t.prototype,"OnCollision",{get:function(){return this._onCollision},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"OnDisposed",{get:function(){return this._onDisposed},enumerable:!0,configurable:!0}),t.prototype.IsCollidingWith=function(n){return this.Bounds.Intersects(n.Bounds)},t.prototype.Collided=function(n){this.OnCollision.Trigger(n)},t.prototype.Dispose=function(){if(this._disposed)throw new Error("Cannot dispose collidable more than once.");else this._disposed=!0,this.OnDisposed.Trigger(this)},t._collidableIDs=0,t}();t.Collidable=i})(n.Collision||(n.Collision={}));var t=n.Collision}(EndGate||(EndGate={})),function(n){var t=function(){function n(){this._type="Event",this._actions=[],this._hasBindings=!1}return n.prototype.Bind=function(n){this._actions.push(n),this._hasBindings=!0},n.prototype.Unbind=function(n){for(var t=0;t<this._actions.length;t++)if(this._actions[t]===n){this._actions.splice(t,1),this._hasBindings=this._actions.length>0;return}},n.prototype.HasBindings=function(){return this._hasBindings},n.prototype.Trigger=function(n,t){for(var i=0;i<this._actions.length;i++)this._actions[i](n,t)},n}();n.EventHandler2=t}(EndGate||(EndGate={})),function(n){(function(t){var i=function(){function i(){this._type="CollisionManager",this._collidables=[],this._enabled=!1,this._onCollision=new n.EventHandler2}return Object.defineProperty(i.prototype,"OnCollision",{get:function(){return this._onCollision},enumerable:!0,configurable:!0}),i.prototype.Monitor=function(n){var t=this;this._enabled=!0,n.OnDisposed.Bind(function(){t.Unmonitor(n)}),this._collidables.push(n)},i.prototype.Unmonitor=function(n){for(var t=0;t<this._collidables.length;t++)if(this._collidables[t]._id===n._id){this._collidables.splice(t,1);break}},i.prototype.Update=function(){var n,i,r,u;if(this._enabled)for(r=0;r<this._collidables.length;r++)for(n=this._collidables[r],u=r+1;u<this._collidables.length;u++)i=this._collidables[u],n.IsCollidingWith(i)&&(n.Collided(new t.Assets.CollisionData(n.Bounds.Position.Clone(),i)),i.Collided(new t.Assets.CollisionData(i.Bounds.Position.Clone(),n)),this.OnCollision.Trigger(n,i))},i}();t.CollisionManager=i})(n.Collision||(n.Collision={}));var t=n.Collision}(EndGate||(EndGate={})),function(n){(function(n){(function(n){(function(n){var t=function(){function n(){this._cachedState={}}return Object.defineProperty(n.prototype,"StrokeStyle",{get:function(){return this._cachedState.strokeStyle},set:function(n){this._cachedState.strokeStyle=n},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"FillStyle",{get:function(){return this._cachedState.fillStyle},set:function(n){this._cachedState.fillStyle=n},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"GlobalAlpha",{get:function(){return this._cachedState.globalAlpha},set:function(n){this._cachedState.globalAlpha=n},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"LineWidth",{get:function(){return this._cachedState.lineWidth},set:function(n){this._cachedState.lineWidth=n},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"LineCap",{get:function(){return this._cachedState.lineCap},set:function(n){this._cachedState.lineCap=n},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"LineJoin",{get:function(){return this._cachedState.lineJoin},set:function(n){this._cachedState.lineJoin=n},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"MiterLimit",{get:function(){return this._cachedState.miterLimit},set:function(n){this._cachedState.miterLimit=n},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"ShadowOffsetX",{get:function(){return this._cachedState.shadowOffsetX},set:function(n){this._cachedState.shadowOffsetX=n},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"ShadowOffsetY",{get:function(){return this._cachedState.shadowOffsetY},set:function(n){this._cachedState.shadowOffsetY=n},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"ShadowBlur",{get:function(){return this._cachedState.shadowBlur},set:function(n){this._cachedState.shadowBlur=n},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"ShadowColor",{get:function(){return this._cachedState.shadowColor},set:function(n){this._cachedState.shadowColor=n},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"GlobalCompositeOperation",{get:function(){return this._cachedState.globalCompositeOperation},set:function(n){this._cachedState.globalCompositeOperation=n},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"Font",{get:function(){return this._cachedState.font},set:function(n){this._cachedState.font=n},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"TextAlign",{get:function(){return this._cachedState.textAlign},set:function(n){this._cachedState.textAlign=n},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"TextBaseline",{get:function(){return this._cachedState.textBaseline},set:function(n){this._cachedState.textBaseline=n},enumerable:!0,configurable:!0}),n.prototype.SetContextState=function(n){for(var t in this._cachedState)n[t]=this._cachedState[t]},n}();n.Graphic2dState=t})(n._||(n._={}));var t=n._})(n.Assets||(n.Assets={}));var t=n.Assets})(n.Graphics||(n.Graphics={}));var t=n.Graphics}(EndGate||(EndGate={})),function(n){(function(t){(function(i){var r=function(){function i(i){this._type="Graphic2d",this.Position=i,this.Rotation=0,this.ZIndex=0,this.Visible=!0,this._State=new t.Assets._.Graphic2dState,this._children=[],this._disposed=!1,this._onDisposed=new n.EventHandler1}return Object.defineProperty(i.prototype,"OnDisposed",{get:function(){return this._onDisposed},enumerable:!0,configurable:!0}),i.prototype.AddChild=function(n){this._children.push(n),this._children.sort(i._zindexSort)},i.prototype.RemoveChild=function(n){var t=this._children.indexOf(n);return t>=0?(this._children.splice(t,1),!0):!1},i.prototype.Children=function(){return this._children},i.prototype._StartDraw=function(n){n.save(),this._State.SetContextState(n),n.translate(this.Position.X,this.Position.Y),this.Rotation!==0&&n.rotate(this.Rotation)},i.prototype._EndDraw=function(n){for(var t=0;t<this._children.length;t++)this._children[t].Draw(n);n.restore()},i.prototype.Draw=function(){throw new Error("The Draw method is abstract on Graphic2d and should not be called.");},i.prototype.GetDrawBounds=function(){throw new Error("GetDrawBounds is abstract, it must be implemented.");},i.prototype.Dispose=function(){if(this._disposed)throw new Error("Cannot dispose graphic more than once.");else this._disposed=!0,this.OnDisposed.Trigger(this)},i._zindexSort=function(n,t){return n.ZIndex-t.ZIndex},i}();i.Graphic2d=r})(t.Abstractions||(t.Abstractions={}));var i=t.Abstractions})(n.Graphics||(n.Graphics={}));var t=n.Graphics}(EndGate||(EndGate={})),function(n){(function(n){var t=function(){function n(n,t){this.Min=n,this.Max=t}return n}();n.MinMax=t})(n._||(n._={}));var t=n._}(EndGate||(EndGate={})),function(n){(function(n){var t=function(){function t(){}return t.GetMinMaxProjections=function(t,i){for(var u=i[0].ProjectOnto(t).Dot(t),e=u,o,r,f=1;f<i.length;f++)o=i[f],r=o.ProjectOnto(t).Dot(t),r<u?u=r:r>e&&(e=r);return new n.MinMax(u,e)},t}();n.Vector2dHelpers=t})(n._||(n._={}));var t=n._}(EndGate||(EndGate={})),function(n){(function(n){var t=function(n){function t(t,i){n.call(this,t),this._type="BoundingCircle",this._boundsType="BoundingCircle",this.Radius=i}return __extends(t,n),t.prototype.Scale=function(n){this.Radius*=n},t.prototype.Area=function(){return Math.PI*this.Radius*this.Radius},t.prototype.Circumference=function(){return 2*Math.PI*this.Radius},t.prototype.IntersectsCircle=function(n){return this.Position.Distance(n.Position).Length()<this.Radius+n.Radius},t.prototype.IntersectsRectangle=function(n){var r=n.Rotation===0?this.Position:this.Position.RotateAround(n.Position,-n.Rotation),t=r.Distance(n.Position),i;return t.X>n.Size.HalfWidth+this.Radius?!1:t.Y>n.Size.HalfHeight+this.Radius?!1:t.X<=n.Size.HalfWidth?!0:t.Y<=n.Size.HalfHeight?!0:(i=Math.pow(t.X-n.Size.HalfWidth,2)+Math.pow(t.Y-n.Size.HalfHeight,2),i<=this.Radius*this.Radius)},t.prototype.ContainsPoint=function(n){return this.Position.Distance(n).Magnitude()<this.Radius},t}(n.Abstractions.Bounds2d);n.BoundingCircle=t})(n.Bounds||(n.Bounds={}));var t=n.Bounds}(EndGate||(EndGate={})),function(n){(function(t){var i=function(t){function i(n,i){t.call(this,n),this._type="BoundingRectangle",this._boundsType="BoundingRectangle",this.Size=i}return __extends(i,t),i.prototype.Scale=function(n,t){this.Size.Width*=n,this.Size.Height*=t},Object.defineProperty(i.prototype,"TopLeft",{get:function(){return this.Rotation===0?new n.Vector2d(this.Position.X-this.Size.HalfWidth,this.Position.Y-this.Size.HalfHeight):new n.Vector2d(this.Position.X-this.Size.HalfWidth,this.Position.Y-this.Size.HalfHeight).RotateAround(this.Position,this.Rotation)},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"TopRight",{get:function(){return this.Rotation===0?new n.Vector2d(this.Position.X+this.Size.HalfWidth,this.Position.Y-this.Size.HalfHeight):new n.Vector2d(this.Position.X+this.Size.HalfWidth,this.Position.Y-this.Size.HalfHeight).RotateAround(this.Position,this.Rotation)},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"BotLeft",{get:function(){return this.Rotation===0?new n.Vector2d(this.Position.X-this.Size.HalfWidth,this.Position.Y+this.Size.HalfHeight):new n.Vector2d(this.Position.X-this.Size.HalfWidth,this.Position.Y+this.Size.HalfHeight).RotateAround(this.Position,this.Rotation)},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"BotRight",{get:function(){return this.Rotation===0?new n.Vector2d(this.Position.X+this.Size.HalfWidth,this.Position.Y+this.Size.HalfHeight):new n.Vector2d(this.Position.X+this.Size.HalfWidth,this.Position.Y+this.Size.HalfHeight).RotateAround(this.Position,this.Rotation)},enumerable:!0,configurable:!0}),i.prototype.Corners=function(){return[this.TopLeft,this.TopRight,this.BotLeft,this.BotRight]},i.prototype.IntersectsCircle=function(n){return n.IntersectsRectangle(this)},i.prototype.IntersectsRectangle=function(t){var i;if(this.Rotation===0&&t.Rotation===0){var r=this.TopLeft,u=this.BotRight,f=t.TopLeft,e=t.BotRight;return f.X<=u.X&&e.X>=r.X&&f.Y<=u.Y&&e.Y>=r.Y}if(t.Position.Distance(this.Position).Magnitude()<=t.Size.Radius+this.Size.Radius){var o=[this.TopRight.Subtract(this.TopLeft),this.TopRight.Subtract(this.BotRight),t.TopLeft.Subtract(t.BotLeft),t.TopLeft.Subtract(t.TopRight)],l=this.Corners(),a=t.Corners();for(i=0;i<o.length;i++){var s=o[i],h=n._.Vector2dHelpers.GetMinMaxProjections(s,l),c=n._.Vector2dHelpers.GetMinMaxProjections(s,a);if(c.Max<h.Min||h.Max<c.Min)return!1}return!0}return!1},i.prototype.ContainsPoint=function(n){var r=this.Rotation,t,i;return this.Rotation!==0&&(this.Rotation=0,n=n.RotateAround(this.Position,-r)),t=this.TopLeft,i=this.BotRight,this.Rotation=r,n.X<=i.X&&n.X>=t.X&&n.Y<=i.Y&&n.Y>=t.Y},i}(t.Abstractions.Bounds2d);t.BoundingRectangle=i})(n.Bounds||(n.Bounds={}));var t=n.Bounds}(EndGate||(EndGate={})),function(n){(function(t){var i=function(n){function t(i,r){n.call(this,i,r),this._type="Camera2d",this.Distance=t.DefaultDistance}return __extends(t,n),t.prototype.ToCameraRelative=function(n){var t=this.Position.Subtract(this.Size.Multiply(this._GetDistanceScale()*.5));return t.Add(n.Multiply(this._GetDistanceScale()))},t.prototype._GetInverseDistanceScale=function(){return t.DefaultDistance/this.Distance},t.prototype._GetDistanceScale=function(){return this.Distance/t.DefaultDistance},t.DefaultDistance=1e3,t}(n.Bounds.BoundingRectangle);t.Camera2d=i})(n.Rendering||(n.Rendering={}));var t=n.Rendering}(EndGate||(EndGate={})),function(n){(function(t){var i=function(){function t(t){this._visibleCanvas=t,this._visibleContext=t.getContext("2d"),this._BufferCanvas=document.createElement("canvas"),this._BufferContext=this._BufferCanvas.getContext("2d"),this._onRendererSizeChange=new n.EventHandler1,this.UpdateBufferSize(),this._disposed=!1}return Object.defineProperty(t.prototype,"OnRendererSizeChange",{get:function(){return this._onRendererSizeChange},enumerable:!0,configurable:!0}),t.prototype.Render=function(n){(this._BufferCanvas.width!==this._visibleCanvas.width||this._BufferCanvas.height!==this._visibleCanvas.height)&&this.UpdateBufferSize(),this._visibleContext.clearRect(0,0,this._visibleCanvas.width,this._visibleCanvas.height),this._visibleContext.drawImage(this._BufferCanvas,0,0),this._ClearBuffer(),n.sort(t._zindexSort);for(var i=0;i<n.length;i++)n[i].Draw(this._BufferContext);return this._BufferContext},t.prototype.Dispose=function(){this._disposed||(this._disposed=!0,this._visibleCanvas.parentNode.removeChild(this._visibleCanvas))},t.prototype._ClearBuffer=function(){this._BufferContext.clearRect(0,0,this._BufferCanvas.width,this._BufferCanvas.height)},t.prototype.UpdateBufferSize=function(){this._BufferCanvas.width=this._visibleCanvas.width,this._BufferCanvas.height=this._visibleCanvas.height,this.OnRendererSizeChange.Trigger(new n.Size2d(this._visibleCanvas.width,this._visibleCanvas.height))},t._zindexSort=function(n,t){return n.ZIndex-t.ZIndex},t}();t.Renderer2d=i})(n.Rendering||(n.Rendering={}));var t=n.Rendering}(EndGate||(EndGate={})),function(n){(function(n){(function(n){var t=function(){function n(n){this._camera=n,this._canvasCenter=this._camera.Position.Clone(),this._translated=!1,this._translationState=[],this._translationState.push(this._translated)}return n.prototype.Build=function(n){var t=this,i=n.createRadialGradient,r=n.translate,u=n.save,f=n.restore,e=this.BuildPositionReplacer(n.drawImage,1),o=this.BuildPositionReplacer(n.drawImage,5);return n.unModifiedClearRect=n.clearRect,n.arc=this.BuildPositionReplacer(n.arc),n.arcTo=this.BuildPositionReplacer(n.arcTo,0,4),n.bezierCurveTo=this.BuildPositionReplacer(n.bezierCurveTo,0,6),n.clearRect=this.BuildPositionReplacer(n.clearRect),n.createLinearGradient=this.BuildPositionReplacer(n.createLinearGradient,0,4),n.createRadialGradient=function(){var n=t._camera._GetDistanceScale();return arguments[0]+=-t._camera.Position.X+t._canvasCenter.X*n,arguments[1]+=-t._camera.Position.Y+t._canvasCenter.Y*n,arguments[3]+=-t._camera.Position.X+t._canvasCenter.X*n,arguments[4]+=-t._camera.Position.Y+t._canvasCenter.Y*n,i.apply(this,arguments)},n.drawImage=function(){arguments.length<=5?e.apply(this,arguments):o.apply(this,arguments)},n.fillRect=this.BuildPositionReplacer(n.fillRect),n.fillText=this.BuildPositionReplacer(n.fillText,1),n.getImageData=this.BuildPositionReplacer(n.getImageData),n.isPointInPath=this.BuildPositionReplacer(n.isPointInPath),n.lineTo=this.BuildPositionReplacer(n.lineTo),n.moveTo=this.BuildPositionReplacer(n.moveTo),n.putImageData=this.BuildPositionReplacer(n.putImageData,1),n.quadraticCurveTo=this.BuildPositionReplacer(n.quadraticCurveTo,0,4),n.rect=this.BuildPositionReplacer(n.rect),n.strokeRect=this.BuildPositionReplacer(n.strokeRect),n.strokeText=this.BuildPositionReplacer(n.strokeText,1),n.save=function(){t._translationState.push(t._translated),u.call(this)},n.restore=function(){t._translated=t._translationState.pop(),f.call(this)},n.translate=function(){var n;t._translated||(n=t._camera._GetDistanceScale(),arguments[0]+=-t._camera.Position.X+t._canvasCenter.X*n,arguments[1]+=-t._camera.Position.Y+t._canvasCenter.Y*n),t._translated=!0,r.apply(this,arguments)},n},n.prototype._UpdateCanvasCenter=function(n){this._canvasCenter.X=n.Width/2,this._canvasCenter.Y=n.Height/2},n.prototype.BuildPositionReplacer=function(n,t,i){typeof t=="undefined"&&(t=0),typeof i=="undefined"&&(i=2);var r=this,u=["X","Y"];return function(){var o,e,f;if(!r._translated)for(o=r._camera._GetDistanceScale(),f=0;f<i;f++)e=u[f%2],arguments[t+f]+=-r._camera.Position[e]+r._canvasCenter[e]*o;return n.apply(this,arguments)}},n}();n.Camera2dCanvasContextBuilder=t})(n._||(n._={}));var t=n._})(n.Rendering||(n.Rendering={}));var t=n.Rendering}(EndGate||(EndGate={})),function(n){(function(t){var i=function(i){function r(r,u){i.call(this,r),this._camera=u,this._contextBuilder=new t._.Camera2dCanvasContextBuilder(this._camera),this.OnRendererSizeChange.Bind(this._contextBuilder._UpdateCanvasCenter),this._contextBuilder._UpdateCanvasCenter(new n.Size2d(r.width,r.height)),this._BufferContext=this._contextBuilder.Build(this._BufferContext)}return __extends(r,i),r.prototype.Render=function(n){var t,r=this._camera._GetInverseDistanceScale();return this._BufferContext.save(),this._BufferContext.scale(r,r),t=i.prototype.Render.call(this,this.GetOnScreenRenderables(n)),this._BufferContext.restore(),t},r.prototype._ClearBuffer=function(){var n=this._camera._GetDistanceScale();this._BufferContext.unModifiedClearRect(0,0,this._BufferCanvas.width*n,this._BufferCanvas.height*n)},r.prototype.GetOnScreenRenderables=function(n){var r=[],i=this._camera._GetDistanceScale(),u=1/i,t;for(this._camera.Scale(i,i),t=0;t<n.length;t++)n[t].Visible&&this._camera.Intersects(n[t].GetDrawBounds())&&r.push(n[t]);return this._camera.Scale(u,u),r},r}(t.Renderer2d);t.Camera2dRenderer=i})(n.Rendering||(n.Rendering={}));var t=n.Rendering}(EndGate||(EndGate={})),function(n){(function(t){var i=function(){function i(i,r){typeof i=="undefined"&&(i=function(){}),this._actors=[],typeof r=="undefined"&&(r=this.CreateDefaultDrawArea()),this._onDraw=i,this.ApplyStyles(r),this._drawArea=r,this._camera=new t.Camera2d(new n.Vector2d(this._drawArea.width/2,this._drawArea.height/2),new n.Size2d(this._drawArea.width,this._drawArea.height)),this._renderer=new t.Camera2dRenderer(this._drawArea,this._camera),this._disposed=!1}return Object.defineProperty(i.prototype,"DrawArea",{get:function(){return this._drawArea},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"Camera",{get:function(){return this._camera},enumerable:!0,configurable:!0}),i.prototype.Add=function(n){var t=this;n.OnDisposed.Bind(function(n){t.Remove(n)}),this._actors.push(n)},i.prototype.Remove=function(n){for(var t=0;t<this._actors.length;t++)if(this._actors[t]===n){this._actors.splice(t,1);return}},i.prototype.Draw=function(){this._onDraw(this._renderer.Render(this._actors))},i.prototype.Dispose=function(){if(this._disposed)throw new Error("Scene2d cannot be disposed more than once");else this._disposed=!0,this._actors=[],this._renderer.Dispose()},i.prototype.ApplyStyles=function(n){n.style.position="absolute",n.style.zIndex="2",n.parentElement.style.position="relative"},i.prototype.CreateDefaultDrawArea=function(){var n=document.createElement("canvas"),t=document.getElementsByTagName("body")[0];return n.width=window.innerWidth,n.height=window.innerHeight,t.appendChild(n),t.style.margin="0px",t.style.padding="0px",n},i}();t.Scene2d=i})(n.Rendering||(n.Rendering={}));var t=n.Rendering}(EndGate||(EndGate={})),function(n){(function(n){(function(n){var t=function(){function n(){}return n.Left="Left",n.Middle="Middle",n.Right="Right",n}();n.MouseButton=t})(n._||(n._={}));var t=n._})(n.Input||(n.Input={}));var t=n.Input}(EndGate||(EndGate={})),function(n){(function(t){var i=function(){function i(t){var i=this;this._target=t,this._onClick=new n.EventHandler1,this._onDoubleClick=new n.EventHandler1,this._onDown=new n.EventHandler1,this._onUp=new n.EventHandler1,this._onMove=new n.EventHandler1,this._onScroll=new n.EventHandler1,this._leftIsDown=!1,this._middleIsDown=!1,this._rightIsDown=!1,this.Wire(),this.OnDown.Bind(function(n){i._isDown=!0,i[n.Button+"IsDown"]=!0}),this.OnUp.Bind(function(n){i._isDown=!1,i[n.Button+"IsDown"]=!1})}return Object.defineProperty(i.prototype,"LeftIsDown",{get:function(){return this._leftIsDown},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"MiddleIsDown",{get:function(){return this._middleIsDown},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"RightIsDown",{get:function(){return this._rightIsDown},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"IsDown",{get:function(){return this._isDown},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"OnClick",{get:function(){return this._onClick},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"OnDoubleClick",{get:function(){return this._onDoubleClick},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"OnDown",{get:function(){return this._onDown},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"OnUp",{get:function(){return this._onUp},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"OnMove",{get:function(){return this._onMove},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"OnScroll",{get:function(){return this._onScroll},enumerable:!0,configurable:!0}),i.prototype.Wire=function(){var n=this;this._target.addEventListener("click",this._target.oncontextmenu=this.BuildEvent(this._onClick,this.BuildMouseClickEvent),!1),this._target.addEventListener("dblclick",this.BuildEvent(this._onDoubleClick,this.BuildMouseClickEvent),!1),this._target.addEventListener("mousedown",this.BuildEvent(this._onDown,this.BuildMouseClickEvent),!1),this._target.addEventListener("mouseup",this.BuildEvent(this._onUp,this.BuildMouseClickEvent),!1),this._target.addEventListener("mousemove",this.BuildEvent(this._onMove,this.BuildMouseEvent),!1),/MSIE/i.test(navigator.userAgent)?this._target.addEventListener("wheel",this.BuildEvent(this._onScroll,function(t){return t.wheelDeltaX=-t.deltaX,t.wheelDeltaY=-t.deltaY,n.BuildMouseScrollEvent(t)}),!1):/Firefox/i.test(navigator.userAgent)?this._target.addEventListener("DOMMouseScroll",this.BuildEvent(this._onScroll,function(t){return t.wheelDeltaX=t.axis===1?-t.detail:0,t.wheelDeltaY=t.axis===2?-t.detail:0,n.BuildMouseScrollEvent(t)}),!1):this._target.addEventListener("mousewheel",this.BuildEvent(this._onScroll,this.BuildMouseScrollEvent),!1)},i.prototype.BuildEvent=function(n,t,i){typeof i=="undefined"&&(i=!1);var r=this;return function(u){return n.HasBindings()&&(n.Trigger(t.call(r,u)),u.preventDefault()),i}},i.prototype.BuildMouseScrollEvent=function(n){return{Position:this.GetMousePosition(n),Direction:this.GetMouseScrollDierction(n)}},i.prototype.BuildMouseEvent=function(n){return{Position:this.GetMousePosition(n)}},i.prototype.BuildMouseClickEvent=function(n){return{Position:this.GetMousePosition(n),Button:this.GetMouseButton(n)}},i.prototype.GetMousePosition=function(t){return new n.Vector2d(t.offsetX?t.offsetX:t.pageX-this._target.offsetLeft,t.offsetY?t.offsetY:t.pageY-this._target.offsetTop)},i.prototype.GetMouseButton=function(n){return n.which?i.MouseButtonArray[n.which]:t._.MouseButton.Right},i.prototype.GetMouseScrollDierction=function(t){return new n.Vector2d(-Math.max(-1,Math.min(1,t.wheelDeltaX)),-Math.max(-1,Math.min(1,t.wheelDeltaY)))},i.MouseButtonArray=[null,t._.MouseButton.Left,t._.MouseButton.Middle,t._.MouseButton.Right],i}();t.MouseHandler=i})(n.Input||(n.Input={}));var t=n.Input}(EndGate||(EndGate={})),function(n){var t=function(){function n(){this._type="Event",this._actions=[],this._hasBindings=!1}return n.prototype.Bind=function(n){this._actions.push(n),this._hasBindings=!0},n.prototype.Unbind=function(n){for(var i=this._actions[t],t=0;t<this._actions.length;t++)if(this._actions[t]===n){this._actions.splice(t,1),this._hasBindings=this._actions.length>0;return}},n.prototype.HasBindings=function(){return this._hasBindings},n.prototype.Trigger=function(){for(var n=0;n<this._actions.length;n++)this._actions[n]()},n}();n.EventHandler=t}(EndGate||(EndGate={})),function(n){(function(n){(function(n){var t=function(){function n(t,i){typeof i=="undefined"&&(i=!1),this._invoker=n._noop,this._action=t,i&&this.Trip()}return n.prototype.Invoke=function(){for(var t=[],n=0;n<arguments.length-0;n++)t[n]=arguments[n+0];this._invoker.apply(this,t)},n.prototype.InvokeOnce=function(){for(var t=[],n=0;n<arguments.length-0;n++)t[n]=arguments[n+0];this._invoker.apply(this,t),this.Reset()},n.prototype.Trip=function(){this._invoker=this._action},n.prototype.Reset=function(){this._invoker=n._noop},n._noop=function(){},n}();n.NoopTripInvoker=t})(n.Utilities||(n.Utilities={}));var t=n.Utilities})(n._||(n._={}));var t=n._}(EndGate||(EndGate={})),function(n){(function(n){(function(n){var t=function(){function n(n,t,i){this.Ctrl=n,this.Alt=t,this.Shift=i}return n.prototype.Equivalent=function(n){return this.Ctrl===n.Ctrl&&this.Alt===n.Alt&&this.Shift===n.Shift},n.BuildFromCommandString=function(t){var i=t.toLowerCase().indexOf("ctrl+")>=0?!0:!1,r=t.toLowerCase().indexOf("alt+")>=0?!0:!1,u=t.toLowerCase().indexOf("shift+")>=0?!0:!1;return new n(i,r,u)},n}();n.KeyboardModifiers=t})(n.Assets||(n.Assets={}));var t=n.Assets})(n.Input||(n.Input={}));var t=n.Input}(EndGate||(EndGate={})),function(n){(function(n){var t={"~":"`","!":"1","@":"2","#":"3",$:"4","%":"5","^":"6","&":"7","*":"8","(":"9",")":"0",_:"-","+":"=",":":";",'"':"'","<":",",">":".","?":"/","|":"\\"},i={"27":"esc","27":"escape","9":"tab","32":"space","13":"return","13":"enter","8":"backspace","45":"insert","36":"home","46":"delete","35":"end","37":"left","38":"up","39":"right","40":"down","112":"f1","113":"f2","114":"f3","115":"f4","116":"f5","117":"f6","118":"f7","119":"f8","120":"f9","121":"f10","122":"f11","123":"f12"},r=function(){function r(r){var f,u;this.Modifiers=new n.Assets.KeyboardModifiers(r.ctrlKey,r.altKey,r.shiftKey),r.keyCode?f=r.keyCode:r.which&&(f=r.which),(u=String.fromCharCode(r.keyCode))===r.key||(u=i[f])||(u=String.fromCharCode(f).toLowerCase(),this.Modifiers.Shift&&t[u]&&(u=t[u])),this.Key=u}return r.prototype.Matches=function(n){return this.Key.toLowerCase()===n.Key.toLowerCase()&&n.Modifiers.Equivalent(this.Modifiers)},r}();n.KeyboardCommandEvent=r})(n.Input||(n.Input={}));var t=n.Input}(EndGate||(EndGate={})),function(n){(function(n){(function(n){var t=function(){function n(){}return n.ParseKey=function(n){var t=n.split("+");return t.length>1?t[t.length-1]:t[0]},n}();n.KeyboardCommandHelper=t})(n._||(n._={}));var t=n._})(n.Input||(n.Input={}));var t=n.Input}(EndGate||(EndGate={})),function(n){(function(t){(function(i){var r=function(){function i(i,r){var u=this;this.Action=r,this.Modifiers=t.Assets.KeyboardModifiers.BuildFromCommandString(i),this.Key=t._.KeyboardCommandHelper.ParseKey(i),this._onDisposed=new n.EventHandler,this._onDisposeInvoker=new n._.Utilities.NoopTripInvoker(function(){u._onDisposed.Trigger()},!0)}return Object.defineProperty(i.prototype,"OnDispose",{get:function(){return this._onDisposed},enumerable:!0,configurable:!0}),i.prototype.Dispose=function(){this._onDisposeInvoker.InvokeOnce()},i}();i.KeyboardCommand=r})(t.Assets||(t.Assets={}));var i=t.Assets})(n.Input||(n.Input={}));var t=n.Input}(EndGate||(EndGate={})),function(n){(function(t){var i=function(){function i(){this._onPressCommands={},this._onDownCommands={},this._onUpCommands={},this._onKeyPress=new n.EventHandler1,this._onKeyDown=new n.EventHandler1,this._onKeyUp=new n.EventHandler1,this.Wire()}return Object.defineProperty(i.prototype,"OnKeyPress",{get:function(){return this._onKeyPress},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"OnKeyDown",{get:function(){return this._onKeyDown},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"OnKeyUp",{get:function(){return this._onKeyUp},enumerable:!0,configurable:!0}),i.prototype.OnCommandPress=function(n,t){return this.UpdateCache(n,t,this._onPressCommands)},i.prototype.OnCommandDown=function(n,t){return this.UpdateCache(n,t,this._onDownCommands)},i.prototype.OnCommandUp=function(n,t){return this.UpdateCache(n,t,this._onUpCommands)},i.prototype.UpdateCache=function(n,r,u){var f=new t.Assets.KeyboardCommand(n,r),e=i._keyboardCommandIds++;return f.OnDispose.Bind(function(){delete u[e]}),u[e]=f,f},i.prototype.Wire=function(){document.addEventListener("keypress",this.BuildKeyEvent(this._onPressCommands,this.OnKeyPress),!1),document.addEventListener("keydown",this.BuildKeyEvent(this._onDownCommands,this.OnKeyDown),!1),document.addEventListener("keyup",this.BuildKeyEvent(this._onUpCommands,this.OnKeyUp),!1)},i.prototype.FocusingTextArea=function(n){var t;return(n.target?t=n.target:n.srcElement&&(t=n.srcElement),t.nodeType===3&&(t=t.parentNode),t.tagName==="INPUT"||t.tagName==="TEXTAREA")?!0:!1},i.prototype.BuildKeyEvent=function(n,i){var r=this;return function(u){var f,o=!0,e;if(!r.FocusingTextArea(u)){f=new t.KeyboardCommandEvent(u),i.Trigger(f);for(e in n)f.Matches(n[e])&&(n[e].Action(),u.preventDefault(),o=!1);return o}}},i._keyboardCommandIds=0,i}();t.KeyboardHandler=i})(n.Input||(n.Input={}));var t=n.Input}(EndGate||(EndGate={})),function(n){(function(n){var t=function(){function t(t){this.Mouse=new n.MouseHandler(t),this.Keyboard=new n.KeyboardHandler}return t}();n.InputManager=t})(n.Input||(n.Input={}));var t=n.Input}(EndGate||(EndGate={})),function(n){(function(n){var t=function(){function n(n,t,i,r){typeof n=="undefined"&&(n=!1),typeof t=="undefined"&&(t=100),typeof i=="undefined"&&(i=!1),typeof r=="undefined"&&(r="auto"),this.Repeat=n,this.Volume=t,this.AutoPlay=i,this.Preload=r}return n.prototype.Clone=function(){return new n(this.Repeat,this.Volume,this.AutoPlay,this.Preload)},n.Default=new n,n}();n.AudioSettings=t})(n.Sound||(n.Sound={}));var t=n.Sound}(EndGate||(EndGate={})),function(n){(function(t){var i={mp3:"audio/mpeg",ogg:"audio/ogg",wav:"audio/wav",aac:"audio/aac",m4a:"audio/x-m4a"},r=function(){function r(i,r){typeof r=="undefined"&&(r=t.AudioSettings.Default),this._settings=r.Clone(),this._audio=document.createElement("audio"),this.SetAudioSource(i),this.ApplySettings(),this._onComplete=new n.EventHandler1}return Object.defineProperty(r.prototype,"OnComplete",{get:function(){return this._onComplete},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"Volume",{get:function(){return this._settings.Volume},set:function(n){this._settings.Volume=n,this._audio.volume=Math.max(Math.min(n/100,1),0)},enumerable:!0,configurable:!0}),r.prototype.IsPlaying=function(){return!this._audio.paused},r.prototype.IsComplete=function(){return this._audio.ended},r.prototype.Play=function(){var n=this;this._audio.readyState===0?this._audio.addEventListener("canplay",function(){n._audio.play()},!0):this._audio.play()},r.prototype.Pause=function(){this._audio.pause()},r.prototype.Seek=function(n){var t=this;this._audio.readyState===0?this._audio.addEventListener("canplay",function(){t._audio.currentTime=n},!0):this._audio.currentTime=n},r.prototype.Stop=function(){this.Seek(0),this._audio.pause()},r.prototype.SetAudioSource=function(n){var r,u,t;for(n instanceof Array||(n=[n]),t=0;t<n.length;t++)r=document.createElement("source"),r.src=n[t],u=i[n[t].split(".").pop()],typeof u!="undefined"&&(r.type=u),this._audio.appendChild(r)},r.prototype.ApplySettings=function(){var n=this;this._audio.loop=this._settings.Repeat,this._audio.autoplay=this._settings.AutoPlay,this._audio.preload=this._settings.Preload,this.Volume=this._settings.Volume,this._audio.addEventListener("ended",function(t){n.OnComplete.Trigger(t)},!0)},r}();t.AudioClip=r})(n.Sound||(n.Sound={}));var t=n.Sound}(EndGate||(EndGate={})),function(n){(function(n){var t=function(){function t(n){this._source=n}return t.prototype.Play=function(t){typeof t=="undefined"&&(t=n.AudioSettings.Default);var i=new n.AudioClip(this._source,t);return i.Play(),i},t}();n.AudioPlayer=t})(n.Sound||(n.Sound={}));var t=n.Sound}(EndGate||(EndGate={})),function(n){(function(n){var t=function(){function t(){this._audioPlayers={}}return t.prototype.Load=function(t,i){return this._audioPlayers[t]=new n.AudioPlayer(i),this._audioPlayers[t]},t.prototype.Unload=function(n){var t=this._audioPlayers[n];return delete this._audioPlayers[n],t},t.prototype.Play=function(t,i){return typeof i=="undefined"&&(i=n.AudioSettings.Default),this._audioPlayers[t].Play(i)},t.prototype.GetAudioPlayer=function(n){return this._audioPlayers[n]},t}();n.AudioManager=t})(n.Sound||(n.Sound={}));var t=n.Sound}(EndGate||(EndGate={})),function(n){(function(t){var i=function(){function t(t){this._camera=t.Camera,this._layers=[],this._sceneryCanvas=this.BuildSceneryCanvas(t.DrawArea),this._renderer=new n.Rendering.Camera2dRenderer(this._sceneryCanvas,this._camera)}return t.prototype.AddLayer=function(n){this._layers.push(n)},t.prototype.RemoveLayer=function(n){this._layers.splice(this._layers.indexOf(n),1)},t.prototype.Draw=function(){this._layers.sort(n.Graphics.Abstractions.Graphic2d._zindexSort),this._renderer.Render(this._layers)},t.prototype.BuildSceneryCanvas=function(n){var t=document.createElement("canvas"),i=n;return t.width=n.width,t.height=n.height,t.style.position="absolute",t.style.zIndex="1",n.parentElement.insertBefore(t,n),t},t}();t.SceneryHandler=i})(n.Map||(n.Map={}));var t=n.Map}(EndGate||(EndGate={})),function(n){(function(n){var t=function(){function t(t){this.Scenery=new n.SceneryHandler(t)}return t}();n.MapManager=t})(n.Map||(n.Map={}));var t=n.Map}(EndGate||(EndGate={})),function(n){var t=function(){function t(i){var r=this;this._type="Game",this._gameTime=new n.GameTime,this._ID=t._gameIds++,this.Scene=new n.Rendering.Scene2d(function(n){r.Draw(n)},i),this.Input=new n.Input.InputManager(this.Scene.DrawArea),this.Audio=new n.Sound.AudioManager,this.CollisionManager=new n.Collision.CollisionManager,this.Configuration=new n.GameConfiguration(GameRunnerInstance.Register(this)),this.Map=new n.Map.MapManager(this.Scene)}return t.prototype._PrepareUpdate=function(){this._gameTime.Update(),this.CollisionManager.Update(this._gameTime),this.Update(this._gameTime)},t.prototype.Update=function(){},t.prototype._PrepareDraw=function(){this.Map.Scenery.Draw(),this.Scene.Draw()},t.prototype.Draw=function(){},t.prototype.Dispose=function(){this.Scene.Dispose(),GameRunnerInstance.Unregister(this)},t._gameIds=0,t}();n.Game=t}(EndGate||(EndGate={})),function(n){(function(n){(function(n){var t=function(){function n(){this.Left=!1,this.Right=!1,this.Up=!1,this.Down=!1}return n}();n.LinearDirections=t})(n.Assets||(n.Assets={}));var t=n.Assets})(n.MovementControllers||(n.MovementControllers={}));var t=n.MovementControllers}(EndGate||(EndGate={})),function(n){(function(t){(function(t){var i=function(){function t(t){this.Position=t.length>0?t[0].Position:n.Vector2d.Zero,this.Velocity=n.Vector2d.Zero,this.Rotation=0,this._frozen=!1,this._moveables=t}return t.prototype.Freeze=function(){this._frozen=!0},t.prototype.Thaw=function(){this._frozen=!1},t.prototype.IsMoving=function(){return!this._frozen&&!this.Velocity.IsZero()},t.prototype.Update=function(){for(var n=0;n<this._moveables.length;n++)this._moveables[n].Position=this.Position,this._moveables[n].Rotation=this.Rotation},t}();t.MovementController=i})(t.Abstractions||(t.Abstractions={}));var i=t.Abstractions})(n.MovementControllers||(n.MovementControllers={}));var t=n.MovementControllers}(EndGate||(EndGate={})),function(n){(function(t){var i=function(i){function r(r,u,f,e){typeof f=="undefined"&&(f=!0),typeof e=="undefined"&&(e=!0);var o=this;i.call(this,r),this._moveSpeed=u,this._moving=new t.Assets.LinearDirections,this.OnMove=new n.EventHandler1,this._rotationUpdater=new n._.Utilities.NoopTripInvoker(function(){o.UpdateRotation()},f),this._velocityUpdater=e?this.UpdateVelocityWithMultiDirection:this.UpdateVelocityNoMultiDirection}return __extends(r,i),r.prototype.IsMovingInDirection=function(n){return this._moving[n]||!1},r.prototype.StartMoving=function(n){this.Move(n,!0)},r.prototype.StopMoving=function(n){this.Move(n,!1)},r.prototype.MoveSpeed=function(n){return typeof n!="undefined"&&(this._moveSpeed=n,this._velocityUpdater()),this._moveSpeed},r.prototype.Update=function(n){this._frozen||(this.Position=this.Position.Add(this.Velocity.Multiply(n.Elapsed.Seconds)),i.prototype.Update.call(this,n))},r.prototype.Move=function(n,t){if(typeof this._moving[n]!="undefined")this._moving[n]=t,this._velocityUpdater(),this._rotationUpdater.Invoke(),this.OnMove.Trigger({Direction:n,StartMoving:t});else throw new Error(n+" is an unknown direction.");},r.prototype.UpdateVelocityNoMultiDirection=function(){var t=n.Vector2d.Zero;t.IsZero()&&(this._moving.Up&&(t.Y-=this._moveSpeed),this._moving.Down&&(t.Y+=this._moveSpeed),t.Y===0&&(this._moving.Left&&(t.X-=this._moveSpeed),this._moving.Right&&(t.X+=this._moveSpeed))),this.Velocity=t},r.prototype.UpdateVelocityWithMultiDirection=function(){var t=n.Vector2d.Zero;this._moving.Up&&(t.Y-=this._moveSpeed),this._moving.Down&&(t.Y+=this._moveSpeed),this._moving.Left&&(t.X-=this._moveSpeed),this._moving.Right&&(t.X+=this._moveSpeed),this.Velocity=t},r.prototype.UpdateRotation=function(){this.Velocity.IsZero()||(this.Rotation=Math.atan2(this.Velocity.Y,this.Velocity.X))},r}(t.Abstractions.MovementController);t.LinearMovementController=i})(n.MovementControllers||(n.MovementControllers={}));var t=n.MovementControllers}(EndGate||(EndGate={})),function(n){(function(t){var i=function(){function t(t,i,r,u,f,e){typeof r=="undefined"&&(r=["w","Up"]),typeof u=="undefined"&&(u=["d","Right"]),typeof f=="undefined"&&(f=["s","Down"]),typeof e=="undefined"&&(e=["a","Left"]),this._keyboard=t,this._onMove=i,this._directions=new n.MovementControllers.Assets.LinearDirections,this.BindKeys(r,"OnCommandDown","Up",!0),this.BindKeys(u,"OnCommandDown","Right",!0),this.BindKeys(f,"OnCommandDown","Down",!0),this.BindKeys(e,"OnCommandDown","Left",!0),this.BindKeys(r,"OnCommandUp","Up",!1),this.BindKeys(u,"OnCommandUp","Right",!1),this.BindKeys(f,"OnCommandUp","Down",!1),this.BindKeys(e,"OnCommandUp","Left",!1)}return t.prototype.BindKeys=function(n,t,i,r){for(var f=this,u=0;u<n.length;u++)this._keyboard[t](n[u],function(){f._directions[i]!=r&&(f._directions[i]=r,f._onMove(i,r))})},t}();t.DirectionalInputController=i})(n.InputControllers||(n.InputControllers={}));var t=n.InputControllers}(EndGate||(EndGate={})),function(n){(function(n){(function(n){(function(n){n[n.Antiqua=0]="Antiqua",n[n.Arial=1]="Arial",n[n.Avqest=2]="Avqest",n[n.Blackletter=3]="Blackletter",n[n.Calibri=4]="Calibri",n[n.ComicSans=5]="ComicSans",n[n.Courier=6]="Courier",n[n.Decorative=7]="Decorative",n[n.Fraktur=8]="Fraktur",n[n.Frosty=9]="Frosty",n[n.Garamond=10]="Garamond",n[n.Georgia=11]="Georgia",n[n.Helvetica=12]="Helvetica",n[n.Impact=13]="Impact",n[n.Minion=14]="Minion",n[n.Modern=15]="Modern",n[n.Monospace=16]="Monospace",n[n.Palatino=17]="Palatino",n[n.Roman=18]="Roman",n[n.Script=19]="Script",n[n.Swiss=20]="Swiss",n[n.TimesNewRoman=21]="TimesNewRoman",n[n.Verdana=22]="Verdana"})(n.FontFamily||(n.FontFamily={}));var t=n.FontFamily})(n.Assets||(n.Assets={}));var t=n.Assets})(n.Graphics||(n.Graphics={}));var t=n.Graphics}(EndGate||(EndGate={})),function(n){(function(n){(function(n){(function(n){n[n.Normal=0]="Normal",n[n.SmallCaps=1]="SmallCaps"})(n.FontVariant||(n.FontVariant={}));var t=n.FontVariant})(n.Assets||(n.Assets={}));var t=n.Assets})(n.Graphics||(n.Graphics={}));var t=n.Graphics}(EndGate||(EndGate={})),function(n){(function(n){(function(n){(function(n){n[n.Normal=0]="Normal",n[n.Italic=1]="Italic",n[n.Oblique=2]="Oblique"})(n.FontStyle||(n.FontStyle={}));var t=n.FontStyle})(n.Assets||(n.Assets={}));var t=n.Assets})(n.Graphics||(n.Graphics={}));var t=n.Graphics}(EndGate||(EndGate={})),function(n){(function(n){(function(n){var t=function(){function t(){this._cachedState={fontSize:"10px",fontFamily:n.FontFamily.TimesNewRoman,fontVariant:n.FontVariant.Normal,fontWeight:"",fontStyle:n.FontStyle.Normal},this._refreshCache=!0,this._BuildFont()}return Object.defineProperty(t.prototype,"FontSize",{get:function(){return this._cachedState.fontSize},set:function(n){this._refreshCache=!0,this._cachedState.fontSize=n,this._BuildFont()},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"FontFamily",{get:function(){return this._cachedState.fontFamily},set:function(n){this._refreshCache=!0,this._cachedState.fontFamily=n,this._BuildFont()},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"FontVariant",{get:function(){return this._cachedState.fontVariant},set:function(n){this._refreshCache=!0,this._cachedState.fontVariant=n},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"FontWeight",{get:function(){return this._cachedState.fontWeight},set:function(n){this._refreshCache=!0,this._cachedState.fontWeight=n},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"FontStyle",{get:function(){return this._cachedState.fontStyle},set:function(n){this._refreshCache=!0,this._cachedState.fontStyle=n},enumerable:!0,configurable:!0}),t.prototype._BuildFont=function(){var t;return this._refreshCache&&(t=this._cachedState.fontWeight+" "+n.FontStyle[this._cachedState.fontStyle].replace("Normal","")+" "+n.FontVariant[this._cachedState.fontVariant].replace("Normal","")+" "+this._cachedState.fontSize,this._cachedState.fontFamily!==undefined&&(t+=" "+n.FontFamily[this._cachedState.fontFamily]),this._cachedFont=t.replace(/^\s\s*/,"").replace(/\s\s*$/,""),this._refreshCache=!1),this._cachedFont},t}();n.FontSettings=t})(n.Assets||(n.Assets={}));var t=n.Assets})(n.Graphics||(n.Graphics={}));var t=n.Graphics}(EndGate||(EndGate={})),function(n){(function(t){var i=function(i){function r(r,u,f,e){typeof e=="undefined"&&(e="black");var o=this;i.call(this,new n.Vector2d(r,u)),this._type="Text2d",this._text=f,this._stroker=new n._.Utilities.NoopTripInvoker(function(n){n.strokeText(o._text,0,0)}),this._drawBounds=new n.Bounds.BoundingRectangle(this.Position,n.Size2d.One),this._recalculateBoundsSize=!0,this._fontSettings=new t.Assets.FontSettings,this.Align="center",this.Baseline="middle",this.Color=e}return __extends(r,i),Object.defineProperty(r.prototype,"Align",{get:function(){return this._State.TextAlign},set:function(n){this._State.TextAlign=n},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"Baseline",{get:function(){return this._State.TextBaseline},set:function(n){this._State.TextBaseline=n},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"Color",{get:function(){return this._State.FillStyle},set:function(n){this._State.FillStyle=n},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"ShadowColor",{get:function(){return this._State.ShadowColor},set:function(n){this._State.ShadowColor=n},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"ShadowX",{get:function(){return this._State.ShadowOffsetX},set:function(n){this._State.ShadowOffsetX=n},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"ShadowY",{get:function(){return this._State.ShadowOffsetY},set:function(n){this._State.ShadowOffsetY=n},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"ShadowBlur",{get:function(){return this._State.ShadowBlur},set:function(n){this._State.ShadowBlur=n},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"Opacity",{get:function(){return this._State.GlobalAlpha},set:function(n){this._State.GlobalAlpha=n},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"FontSettings",{get:function(){return this._recalculateBoundsSize=!0,this._fontSettings},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"BorderThickness",{get:function(){return this._State.LineWidth},set:function(n){n===0?this._stroker.Reset():this._stroker.Trip(),this._State.LineWidth=n},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"BorderColor",{get:function(){return this._State.StrokeStyle},set:function(n){this._stroker.Trip(),this._State.StrokeStyle=n},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"Text",{get:function(){return this._text},set:function(n){this._recalculateBoundsSize=!0,this._text=n},enumerable:!0,configurable:!0}),r.prototype.Shadow=function(n,t,i,r){this.ShadowX=n,this.ShadowY=t,this.ShadowColor=i,this.ShadowBlur=r},r.prototype.Border=function(n,t){this.BorderThickness=n,this.BorderColor=t},r.prototype.Draw=function(n){var t;i.prototype._StartDraw.call(this,n),this._State.Font=this._fontSettings._BuildFont(),n.fillText(this._text,0,0),this._stroker.Invoke(n),i.prototype._EndDraw.call(this,n),this._recalculateBoundsSize&&(this._recalculateBoundsSize=!1,t=n.measureText(this._text),this._drawBounds.Size.Width=t.width,this._drawBounds.Size.Height=parseInt(this._fontSettings.FontSize)*1.5)},r.prototype.GetDrawBounds=function(){return this._drawBounds.Rotation=this.Rotation,this._drawBounds.Position=this.Position,this._drawBounds},r}(t.Abstractions.Graphic2d);t.Text2d=i})(n.Graphics||(n.Graphics={}));var t=n.Graphics}(EndGate||(EndGate={})),function(n){(function(t){(function(t){var i=function(){function t(t,i,r,u,f,e,o){typeof u=="undefined"&&(u=0),typeof f=="undefined"&&(f=0),typeof e=="undefined"&&(e=i),typeof o=="undefined"&&(o=r);var s=this,h=typeof i!="undefined";this._loaded=!1,this._onLoaded=new n.EventHandler1,this.Source=new Image,this.Source.onload=function(){s._loaded=!0,h||(s._size=new n.Size2d(s.Source.width,s.Source.height),s.ClipLocation=n.Vector2d.Zero,s.ClipSize=s._size.Clone()),s._onLoaded.Trigger(s)},this.Source.src=t,this._imageLocation=t,h&&(this._size=new n.Size2d(i,r),this.ClipLocation=new n.Vector2d(u,f),this.ClipSize=new n.Size2d(e,o))}return Object.defineProperty(t.prototype,"OnLoaded",{get:function(){return this._onLoaded},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"Size",{get:function(){return this._size.Clone()},enumerable:!0,configurable:!0}),t.prototype.Loaded=function(){return this._loaded},t.prototype.Extract=function(n,i,r,u){return new t(this._imageLocation,this._size.Width,this._size.Height,n,i,r,u)},t}();t.ImageSource=i})(t.Assets||(t.Assets={}));var i=t.Assets})(n.Graphics||(n.Graphics={}));var t=n.Graphics}(EndGate||(EndGate={})),function(n){(function(t){var i=function(t){function i(i,r,u,f,e){typeof f=="undefined"&&(f=u.ClipSize.Width),typeof e=="undefined"&&(e=u.ClipSize.Height),t.call(this,new n.Vector2d(i,r)),this._type="Sprite2d",this.Image=u,this.Size=new n.Size2d(f,e)}return __extends(i,t),Object.defineProperty(i.prototype,"Opacity",{get:function(){return this._State.GlobalAlpha},set:function(n){this._State.GlobalAlpha=n},enumerable:!0,configurable:!0}),i.prototype.Draw=function(n){t.prototype._StartDraw.call(this,n),n.drawImage(this.Image.Source,this.Image.ClipLocation.X,this.Image.ClipLocation.Y,this.Image.ClipSize.Width,this.Image.ClipSize.Height,-this.Size.HalfWidth,-this.Size.HalfHeight,this.Size.Width,this.Size.Height),t.prototype._EndDraw.call(this,n)},i.prototype.GetDrawBounds=function(){var t=new n.Bounds.BoundingRectangle(this.Position,this.Size);return t.Rotation=this.Rotation,t},i}(t.Abstractions.Graphic2d);t.Sprite2d=i})(n.Graphics||(n.Graphics={}));var t=n.Graphics}(EndGate||(EndGate={})),function(n){(function(t){var i=function(){function t(t,i,r,u,f){typeof f=="undefined"&&(f=n.Vector2d.Zero),this._imageSource=t,this._frameSize=r,this._frameCount=u,this._startOffset=f,this._playing=!1,this._repeating=!1,this._currentFrame=0,this._framesPerRow=Math.min(Math.floor((t.ClipSize.Width-f.X)/r.Width),u),this._lastStepAt=0,this._onComplete=new n.EventHandler,this.Fps=i}return Object.defineProperty(t.prototype,"OnComplete",{get:function(){return this._onComplete},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"Fps",{get:function(){return this._fps},set:function(n){this._fps=n,this._stepEvery=1e3/this._fps},enumerable:!0,configurable:!0}),t.prototype.IsPlaying=function(){return this._playing},t.prototype.Play=function(n){typeof n=="undefined"&&(n=!1),this._lastStepAt=(new Date).getTime(),this._repeating=n,this._playing=!0,this.UpdateImageSource()},t.prototype.Pause=function(){this._playing=!1},t.prototype.Step=function(n){typeof n=="undefined"&&(n=1),this._currentFrame+=n,this._currentFrame>=this._frameCount&&(this._repeating?this._currentFrame%=this._frameCount:(this._currentFrame=this._frameCount-1,this.OnComplete.Trigger(),this.Stop(!1))),n!==0&&this.UpdateImageSource()},t.prototype.Stop=function(n){typeof n=="undefined"&&(n=!0),this._playing=!1,n&&this.Reset()},t.prototype.Reset=function(){this._currentFrame=0,this.UpdateImageSource()},t.prototype.Update=function(n){var i=n.Now.getTime()-this._lastStepAt,t=0;this._playing&&(t=Math.floor(i/this._stepEvery),t!==0&&(this._lastStepAt=n.Now.getTime(),this.Step(t)))},t.prototype.UpdateImageSource=function(){var n=this.GetFrameRow(),t=this.GetFrameColumn();this._imageSource.ClipLocation.X=this._startOffset.X+t*this._frameSize.Width,this._imageSource.ClipLocation.Y=this._startOffset.Y+n*this._frameSize.Height,this._imageSource.ClipSize=this._frameSize},t.prototype.GetFrameRow=function(){return Math.floor(this._currentFrame/this._framesPerRow)},t.prototype.GetFrameColumn=function(){return Math.ceil(this._currentFrame%this._framesPerRow)},t}();t.SpriteAnimation=i})(n.Graphics||(n.Graphics={}));var t=n.Graphics}(EndGate||(EndGate={})),function(n){(function(n){(function(n){var t=function(n){function t(t,i){n.call(this,t),this._type="Shape",this._fill=!1,this._stroke=!1,typeof i!="undefined"&&(this.Color=i)}return __extends(t,n),Object.defineProperty(t.prototype,"Color",{get:function(){return this._State.FillStyle},set:function(n){this._fill=!0,this._State.FillStyle=n},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"BorderThickness",{get:function(){return this._State.LineWidth},set:function(n){this._State.LineWidth=n},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"BorderColor",{get:function(){return this._State.StrokeStyle},set:function(n){this._stroke=!0,this._State.StrokeStyle=n},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"ShadowColor",{get:function(){return this._State.ShadowColor},set:function(n){this._fill=!0,this._State.ShadowColor=n},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"ShadowX",{get:function(){return this._State.ShadowOffsetX},set:function(n){this._State.ShadowOffsetX=n},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"ShadowY",{get:function(){return this._State.ShadowOffsetY},set:function(n){this._State.ShadowOffsetY=n},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"ShadowBlur",{get:function(){return this._State.ShadowBlur},set:function(n){this._State.ShadowBlur=n},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"Opacity",{get:function(){return this._State.GlobalAlpha},set:function(n){this._State.GlobalAlpha=n},enumerable:!0,configurable:!0}),t.prototype.Border=function(n,t){this.BorderThickness=n,this.BorderColor=t},t.prototype.Shadow=function(n,t,i,r){this.ShadowX=n,this.ShadowY=t,this.ShadowColor=i,this.ShadowBlur=r},t.prototype._StartDraw=function(t){n.prototype._StartDraw.call(this,t),t.beginPath()},t.prototype._EndDraw=function(t){this._fill&&t.fill(),this._stroke?t.stroke():t.closePath(),n.prototype._EndDraw.call(this,t)},t.prototype._BuildPath=function(){},t.prototype.Draw=function(n){this._StartDraw(n),this._BuildPath(n),this._EndDraw(n)},t}(n.Graphic2d);n.Shape=t})(n.Abstractions||(n.Abstractions={}));var t=n.Abstractions})(n.Graphics||(n.Graphics={}));var t=n.Graphics}(EndGate||(EndGate={})),function(n){(function(t){var i=function(t){function i(i,r,u,f){t.call(this,new n.Vector2d(i,r),f),this._type="Circle",this.Radius=u}return __extends(i,t),i.prototype.GetDrawBounds=function(){var t=new n.Bounds.BoundingCircle(this.Position,this.Radius);return t.Rotation=this.Rotation,t},i.prototype._BuildPath=function(n){n.arc(0,0,this.Radius,0,Math.twoPI)},i}(t.Abstractions.Shape);t.Circle=i})(n.Graphics||(n.Graphics={}));var t=n.Graphics}(EndGate||(EndGate={})),function(n){(function(t){var i=function(t){function i(i,r,u,f,e){t.call(this,new n.Vector2d(i,r),e),this._type="Rectangle",this.Size=new n.Size2d(u,f)}return __extends(i,t),i.prototype.GetDrawBounds=function(){var t=new n.Bounds.BoundingRectangle(this.Position,this.Size);return t.Rotation=this.Rotation,t},i.prototype._BuildPath=function(n){n.rect(-this.Size.HalfWidth,-this.Size.HalfHeight,this.Size.Width,this.Size.Height)},i}(t.Abstractions.Shape);t.Rectangle=i})(n.Graphics||(n.Graphics={}));var t=n.Graphics}(EndGate||(EndGate={})),function(n){(function(t){var i=function(t){function i(i,r,u,f,e,o){typeof e=="undefined"&&(e=1),t.call(this,n.Vector2d.Zero),this._type="Line2d",this._from=new n.Vector2d(i,r),this._to=new n.Vector2d(u,f),this.LineWidth=e,this.UpdatePosition(),typeof o!="undefined"&&(this.Color=o)}return __extends(i,t),Object.defineProperty(i.prototype,"From",{get:function(){return this._from},set:function(n){this._from=n,this.UpdatePosition()},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"To",{get:function(){return this._to},set:function(n){this._to=n,this.UpdatePosition()},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"Color",{get:function(){return this._State.StrokeStyle},set:function(n){this._State.StrokeStyle=n},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"LineWidth",{get:function(){return this._State.LineWidth},set:function(n){this._State.LineWidth=n},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"LineCap",{get:function(){return this._State.LineCap},set:function(n){this._State.LineCap=n},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"Opacity",{get:function(){return this._State.GlobalAlpha},set:function(n){this._State.GlobalAlpha=n},enumerable:!0,configurable:!0}),i.prototype.Draw=function(n){t.prototype._StartDraw.call(this,n),this._cachedPosition.Equivalent(this.Position)||this.RefreshCache(),n.beginPath(),n.moveTo(this._from.X-this.Position.X,this._from.Y-this.Position.Y),n.lineTo(this._to.X-this.Position.X,this._to.Y-this.Position.Y),n.stroke(),t.prototype._EndDraw.call(this,n)},i.prototype.GetDrawBounds=function(){var t=new n.Bounds.BoundingRectangle(this.Position,new n.Size2d(this._boundsWidth,this.LineWidth));return t.Rotation=Math.atan2(this._difference.Y,this._difference.X)+this.Rotation,t},i.prototype.UpdatePosition=function(){this.Position=this._from.Add(this._to).Divide(2),this._difference=this._to.Subtract(this._from),this._boundsWidth=this._from.Distance(this._to).Length(),this._cachedPosition=this.Position.Clone()},i.prototype.RefreshCache=function(){var n=this.Position.Subtract(this._cachedPosition);this._from.X+=n.X,this._from.Y+=n.Y,this._to.X+=n.X,this._to.Y+=n.Y,this._cachedPosition=this.Position.Clone()},i}(t.Abstractions.Graphic2d);t.Line2d=i})(n.Graphics||(n.Graphics={}));var t=n.Graphics}(EndGate||(EndGate={})),function(n){(function(t){var i=function(i){function r(r,u,f,e,o,s,h,c){var y,l,a,v,p;for(typeof h=="undefined"&&(h=!1),typeof c=="undefined"&&(c="gray"),i.call(this,new n.Vector2d(r,u)),this._type="Grid",this._size=new n.Size2d(o*e,s*f),this._tileSize=new n.Size2d(o,s),this._grid=[],this._rows=f,this._columns=e,this.DrawGridLines=h,this._gridLines=[],y=this._size.Multiply(.5),l=new n.Vector2d(-y.Width,-y.Height),a=new n.Vector2d(y.Width,y.Height),v=0;v<f;v++)for(this._grid[v]=[],this._gridLines.push(new t.Line2d(l.X,l.Y+v*this._tileSize.Height,a.X,l.Y+v*this._tileSize.Height,1)),p=0;p<e;p++)v===0&&this._gridLines.push(new t.Line2d(l.X+p*this._tileSize.Width,l.Y,l.X+p*this._tileSize.Width,a.Y,1)),this._grid[v].push(null);this._gridLines.push(new t.Line2d(l.X,a.Y,a.X,a.Y,1)),this._gridLines.push(new t.Line2d(a.X,l.Y,a.X,a.Y,1)),this.GridLineColor=c}return __extends(r,i),Object.defineProperty(r.prototype,"GridLineColor",{get:function(){return this._gridLineColor},set:function(n){this._gridLineColor=n;for(var t=0;t<this._gridLines.length;t++)this._gridLines[t].Color=n},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"Size",{get:function(){return this._size.Clone()},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"TileSize",{get:function(){return this._tileSize.Clone()},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"Rows",{get:function(){return this._rows},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"Columns",{get:function(){return this._columns},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"Opacity",{get:function(){return this._State.GlobalAlpha},set:function(n){this._State.GlobalAlpha=n},enumerable:!0,configurable:!0}),r.prototype.Fill=function(n,t,i){this.ValidRow(n)&&this.ValidColumn(t)&&(i.Position=this.GetInsideGridPosition(n,t),this._grid[n][t]=i,this.AddChild(i))},r.prototype.FillRow=function(n,t,i){var u,r;for(typeof i=="undefined"&&(i=0),r=0;r<t.length;r++)u=t[r],u.Position=this.GetInsideGridPosition(n,r+i),this._grid[n][r+i]=u,this.AddChild(u)},r.prototype.FillColumn=function(n,t,i){var u,r;for(typeof i=="undefined"&&(i=0),r=0;r<t.length;r++)u=t[r],u.Position=this.GetInsideGridPosition(r+i,n),this._grid[r+i][n]=u,this.AddChild(u)},r.prototype.FillSpace=function(n,t,i){for(var f,u,r=0;r<i.length;r++)for(u=0;u<i[r].length;u++)f=i[r][u],f&&(f.Position=this.GetInsideGridPosition(r+n,u+t),this._grid[r+n][u+t]=f,this.AddChild(f))},r.prototype.Get=function(n,t){return!this.ValidRow(n)||!this.ValidColumn(t)?null:this._grid[n][t]},r.prototype.GetRow=function(n,t){var r,i;for(typeof t=="undefined"&&(t=0),r=[],i=t;i<this._columns;i++)r.push(this._grid[n][i]);return r},r.prototype.GetColumn=function(n,t){var r,i;for(typeof t=="undefined"&&(t=0),r=[],i=t;i<this._rows;i++)r.push(this._grid[i][n]);return r},r.prototype.GetSpace=function(n,t,i,r){for(var e=[],o=i>=n?1:-1,s=r>=t?1:-1,f,u=n;u!==i+o;u+=o){if(u>=this._rows)break;for(f=t;f!==r+s;f+=s){if(f>=this._columns)break;e.push(this._grid[u][f])}}return e},r.prototype.Clear=function(n,t){if(!this.ValidRow(n)||!this.ValidColumn(t))return null;var i=this._grid[n][t];return this._grid[n][t]=null,this.RemoveChild(i),i},r.prototype.ClearRow=function(n,t){var r,i;for(typeof t=="undefined"&&(t=0),r=[],i=0;i<this._columns;i++)r.push(this._grid[n][i]),this.RemoveChild(this._grid[n][i]),this._grid[n][i]=null;return r},r.prototype.ClearColumn=function(n,t){var r,i;for(typeof t=="undefined"&&(t=0),r=[],i=0;i<this._rows;i++)r.push(this._grid[i][n]),this.RemoveChild(this._grid[i][n]),this._grid[i][n]=null;return r},r.prototype.ClearSpace=function(n,t,i,r){for(var e=[],o=i>=n?1:-1,s=r>=t?1:-1,f,u=n;u!==i+o;u+=o){if(u>this._rows)break;for(f=t;f!==r+s;f+=s){if(f>this._columns)break;e.push(this._grid[u][f]),this.RemoveChild(this._grid[u][f]),this._grid[u][f]=null}}return e},r.prototype.Draw=function(n){if(i.prototype._StartDraw.call(this,n),n.save(),i.prototype._EndDraw.call(this,n),this.DrawGridLines)for(var t=0;t<this._gridLines.length;t++)this._gridLines[t].Draw(n);n.restore()},r.prototype.GetDrawBounds=function(){var t=new n.Bounds.BoundingRectangle(this.Position,this._size);return t.Rotation=this.Rotation,t},r.prototype.ConvertToRow=function(n){return Math.floor((n-(this.Position.Y-this._size.HalfHeight))/this._tileSize.Height)},r.prototype.ConvertToColumn=function(n){return Math.floor((n-(this.Position.X-this._size.HalfWidth))/this._tileSize.Width)},r.prototype.GetInsideGridPosition=function(t,i){return new n.Vector2d(i*this._tileSize.Width-this._size.HalfWidth+this._tileSize.HalfWidth,t*this._tileSize.Height-this._size.HalfHeight+this._tileSize.HalfHeight)},r.prototype.ValidRow=function(n){return n>=0&&n<this._rows},r.prototype.ValidColumn=function(n){return n>=0&&n<this._columns},r}(t.Abstractions.Graphic2d);t.Grid=i})(n.Graphics||(n.Graphics={}));var t=n.Graphics}(EndGate||(EndGate={})),function(n){var t=function(){function t(n,t,i,r){typeof n=="undefined"&&(n=0),typeof t=="undefined"&&(t=0),typeof i=="undefined"&&(i=0),typeof r=="undefined"&&(r=0),this._type="Matrix2x2",this.Values=[[n,t],[i,r]]}return Object.defineProperty(t,"Zero",{get:function(){return new t},enumerable:!0,configurable:!0}),Object.defineProperty(t,"Identity",{get:function(){return new t(1,0,0,1)},enumerable:!0,configurable:!0}),t.prototype.Apply=function(n){this.Values[0][0]=n(this.Values[0][0]),this.Values[0][1]=n(this.Values[0][1]),this.Values[1][0]=n(this.Values[1][0]),this.Values[1][1]=n(this.Values[1][1])},t.prototype.Trigger=function(n){n(this.Values[0][0]),n(this.Values[0][1]),n(this.Values[1][0]),n(this.Values[1][1])},t.prototype.Add=function(n){return n._type==="Matrix2x2"?new t(this.Values[0][0]+n.Values[0][0],this.Values[0][1]+n.Values[0][1],this.Values[1][0]+n.Values[1][0],this.Values[1][1]+n.Values[1][1]):new t(this.Values[0][0]+n,this.Values[0][1]+n,this.Values[1][0]+n,this.Values[1][1]+n)},t.prototype.Multiply=function(n){return n._type==="Matrix2x2"?new t(this.Values[0][0]*n.Values[0][0]+this.Values[0][1]*n.Values[1][0],this.Values[0][0]*n.Values[0][1]+this.Values[0][1]*n.Values[1][1],this.Values[1][0]*n.Values[0][0]+this.Values[1][1]*n.Values[1][0],this.Values[1][0]*n.Values[0][1]+this.Values[1][1]*n.Values[1][1]):new t(this.Values[0][0]*n,this.Values[0][1]*n,this.Values[1][0]*n,this.Values[1][1]*n)},t.prototype.Subtract=function(n){return n._type==="Matrix2x2"?new t(this.Values[0][0]-n.Values[0][0],this.Values[0][1]-n.Values[0][1],this.Values[1][0]-n.Values[1][0],this.Values[1][1]-n.Values[1][1]):new t(this.Values[0][0]-n,this.Values[0][1]-n,this.Values[1][0]-n,this.Values[1][1]-n)},t.prototype.SubtractFrom=function(n){return n._type==="Matrix2x2"?new t(n.Values[0][0]-this.Values[0][0],n.Values[0][1]-this.Values[0][1],n.Values[1][0]-this.Values[1][0],n.Values[1][1]-this.Values[1][1]):new t(n-this.Values[0][0],n-this.Values[0][1],n-this.Values[1][0],n-this.Values[1][1])},t.prototype.Divide=function(n){return n._type==="Matrix2x2"?new t(this.Values[0][0]/n.Values[0][0],this.Values[0][1]/n.Values[0][1],this.Values[1][0]/n.Values[1][0],this.Values[1][1]/n.Values[1][1]):new t(this.Values[0][0]/n,this.Values[0][1]/n,this.Values[1][0]/n,this.Values[1][1]/n)},t.prototype.DivideFrom=function(n){return n._type==="Matrix2x2"?new t(n.Values[0][0]/this.Values[0][0],n.Values[0][1]/this.Values[0][1],n.Values[1][0]/this.Values[1][0],n.Values[1][1]/this.Values[1][1]):new t(n/this.Values[0][0],n/this.Values[0][1],n/this.Values[1][0],n/this.Values[1][1])},t.prototype.Transform=function(t){return new n.Vector2d(this.Values[0][0]*t.X+this.Values[0][1]*t.Y,this.Values[1][0]*t.X+this.Values[1][1]*t.Y)},t.prototype.Transpose=function(){return new t(this.Values[0][0],this.Values[1][0],this.Values[0][1],this.Values[1][1])},t.prototype.Determinant=function(){return this.Values[0][0]*this.Values[1][1]-this.Values[0][1]*this.Values[1][0]},t.prototype.Inverse=function(){return new t(this.Values[1][1],-this.Values[0][1],-this.Values[1][0],this.Values[0][0]).Multiply(1/this.Determinant())},t.prototype.Clone=function(){return new t(this.Values[0][0],this.Values[0][1],this.Values[1][0],this.Values[1][1])},t.prototype.Equivalent=function(n){return this.Values[0][0]===n.Values[0][0]&&this.Values[0][1]===n.Values[0][1]&&this.Values[1][0]===n.Values[1][0]&&this.Values[1][1]===n.Values[1][1]},t.prototype.toString=function(){return this.Values[0].toString()+" "+this.Values[1].toString()},t.Scale=function(n){return new t(n.X,0,0,n.Y)},t}();n.Matrix2x2=t}(EndGate||(EndGate={})),function(n){(function(t){var i=function(t){function i(i,r,u){t.call(this,new n.Vector2d(i,r)),this._Resources=u}return __extends(i,t),i}(n.Graphics.Abstractions.Graphic2d);t.TileMap=i})(n.Map||(n.Map={}));var t=n.Map}(EndGate||(EndGate={})),function(n){(function(t){var i=function(n){function t(t,i,r){n.call(this,0,0,t,i,r)}return __extends(t,n),t}(n.Graphics.Sprite2d);t.SquareTile=i})(n.Map||(n.Map={}));var t=n.Map}(EndGate||(EndGate={})),function(n){(function(t){var i=function(i){function r(t,r,u,f,e,o,s,h){typeof s=="undefined"&&(s=!0),typeof h=="undefined"&&(h=!1),i.call(this,t,r,e),this._grid=new n.Graphics.Grid(0,0,o.length,o[0].length,u,f,h),this._staticMap=s,this.FillGridWith(o),this._staticMap&&this.BuildCache()}return __extends(r,i),r.ExtractTiles=function(n,t,i){for(var f=[],e=Math.floor(n.ClipSize.Width/t),o=Math.floor(n.ClipSize.Height/i),u,r=0;r<o;r++)for(u=0;u<e;u++)f.push(n.Extract(u*t,r*i,t,i));return f},r.prototype.Draw=function(n){i.prototype._StartDraw.call(this,n),this._staticMap?n.drawImage(this._mapCache,-this._mapCache.width/2,-this._mapCache.height/2):this._grid.Draw(n),i.prototype._EndDraw.call(this,n)},r.prototype.GetDrawBounds=function(){var n=this._grid.GetDrawBounds();return n.Position=this.Position,n},r.prototype.BuildCache=function(){var t=this._grid.Size,i=this._grid.Position;this._mapCache=document.createElement("canvas"),this._mapCache.width=t.Width,this._mapCache.height=t.Height,this._grid.Position=new n.Vector2d(t.HalfWidth,t.HalfHeight),this._grid.Draw(this._mapCache.getContext("2d")),this._grid.Position=i},r.prototype.FillGridWith=function(n){for(var u=[],r,i=0;i<n.length;i++)for(u[i]=[],r=0;r<n[i].length;r++)n[i][r]>=0?u[i].push(new t.SquareTile(this._Resources[n[i][r]],this._grid.TileSize.Width,this._grid.TileSize.Height)):u[i].push(null);this._grid.FillSpace(0,0,u)},r}(t.TileMap);t.SquareTileMap=i})(n.Map||(n.Map={}));var t=n.Map}(EndGate||(EndGate={})),eg=EndGate,Number.prototype.Clone=function(){return this},function(n){(function(t){var i=function(){function t(t,i,r,u){this._from=t.Clone(),this._to=i.Clone(),this._current=this._from.Clone(),this._duration=r,this._elapsed=n.TimeSpan.Zero,this._playing=!1,this._onChange=new n.EventHandler1,this._onComplete=new n.EventHandler1,this._tweeningFunction=u}return Object.defineProperty(t.prototype,"OnChange",{get:function(){return this._onChange},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"OnComplete",{get:function(){return this._onComplete},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"From",{get:function(){return this._from},set:function(n){this._from=n},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"To",{get:function(){return this._to},set:function(n){this._to=n},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"Current",{get:function(){return this._current},set:function(n){this._current=n},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"Duration",{get:function(){return this._duration},set:function(n){this._duration=n},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"Elapsed",{get:function(){return this._elapsed.Clone()},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"TweeningFunction",{get:function(){return this._tweeningFunction},set:function(n){this._tweeningFunction=n},enumerable:!0,configurable:!0}),t.prototype.IsPlaying=function(){return this._playing},t.prototype.Play=function(){this._playing=!0},t.prototype.Pause=function(){this._playing=!1},t.prototype.Reset=function(){this._elapsed.Milliseconds=0,this._current=this._from.Clone()},t.prototype.Stop=function(){this._playing=!1,this.Reset()},t.prototype.Restart=function(){this.Reset(),this.Play()},t.prototype.Reverse=function(){this._elapsed=n.TimeSpan.Zero,this._to=this._from,this._from=this.Current.Clone()},t.prototype.Update=function(n){this._playing&&!this._elapsed.Equivalent(this._duration)&&(this._elapsed=this._elapsed.Add(n.Elapsed),this._elapsed.Milliseconds>=this._duration.Milliseconds?(this._elapsed=this._duration.Clone(),this._current=this._to.Clone(),this._playing=!1,this._onComplete.Trigger(this)):(this._UpdateTween(),this._onChange.Trigger(this._current.Clone())))},t.prototype._UpdateTween=function(){},t}();t.Tween=i})(n.Tweening||(n.Tweening={}));var t=n.Tweening}(EndGate||(EndGate={})),function(n){(function(n){var t=function(n){function t(t,i,r,u){n.call(this,t,i,r,u)}return __extends(t,n),t.prototype._UpdateTween=function(){this.Current=this.TweeningFunction(this.From,this.To,this.Elapsed,this.Duration)},t}(n.Tween);n.NumberTween=t})(n.Tweening||(n.Tweening={}));var t=n.Tweening}(EndGate||(EndGate={})),function(n){(function(t){var i=function(t){function i(n,i,r,u){t.call(this,n,i,r,u)}return __extends(i,t),i.prototype._UpdateTween=function(){this.Current=new n.Size2d(this.TweeningFunction(this.From.Width,this.To.Width,this.Elapsed,this.Duration),this.TweeningFunction(this.From.Height,this.To.Height,this.Elapsed,this.Duration))},i}(t.Tween);t.Size2dTween=i})(n.Tweening||(n.Tweening={}));var t=n.Tweening}(EndGate||(EndGate={})),function(n){(function(t){var i=function(t){function i(n,i,r,u){t.call(this,n,i,r,u)}return __extends(i,t),i.prototype._UpdateTween=function(){this.Current=new n.Vector2d(this.TweeningFunction(this.From.X,this.To.X,this.Elapsed,this.Duration),this.TweeningFunction(this.From.Y,this.To.Y,this.Elapsed,this.Duration))},i}(t.Tween);t.Vector2dTween=i})(n.Tweening||(n.Tweening={}));var t=n.Tweening}(EndGate||(EndGate={})),function(n){(function(n){(function(n){var t=function(){function n(){}return Object.defineProperty(n,"EaseIn",{get:function(){return n._easeIn},enumerable:!0,configurable:!0}),Object.defineProperty(n,"EaseOut",{get:function(){return n._easeOut},enumerable:!0,configurable:!0}),Object.defineProperty(n,"EaseInOut",{get:function(){return n._easeInOut},enumerable:!0,configurable:!0}),n._easeIn=function(n,t,i,r){var f=t-n,u=i.Milliseconds;return f*(u/=r.Milliseconds)*u*((1.70158+1)*u-1.70158)+n},n._easeOut=function(n,t,i,r){var f=t-n,u=i.Milliseconds;return f*((u=u/r.Milliseconds-1)*u*((1.70158+1)*u+1.70158)+1)+n},n._easeInOut=function(n,t,i,r){var e=t-n,u=i.Milliseconds,f=1.70158;return(u/=r.Milliseconds/2)<1?e/2*u*u*(((f*=1.525)+1)*u-f)+n:e/2*((u-=2)*u*(((f*=1.525)+1)*u+f)+2)+n},n}();n.Back=t})(n.Functions||(n.Functions={}));var t=n.Functions})(n.Tweening||(n.Tweening={}));var t=n.Tweening}(EndGate||(EndGate={})),function(n){(function(n){(function(n){var t=function(){function n(){}return Object.defineProperty(n,"EaseIn",{get:function(){return n._easeIn},enumerable:!0,configurable:!0}),Object.defineProperty(n,"EaseOut",{get:function(){return n._easeOut},enumerable:!0,configurable:!0}),Object.defineProperty(n,"EaseInOut",{get:function(){return n._easeInOut},enumerable:!0,configurable:!0}),n._easeIn=function(t,i,r,u){var f=i-t;return f-n.EaseOut(0,f,u.Subtract(r),u)+t},n._easeOut=function(n,t,i,r){var f=t-n,u=i.Milliseconds;return(u/=r.Milliseconds)<1/2.75?f*7.5625*u*u+n:u<2/2.75?f*(7.5625*(u-=1.5/2.75)*u+.75)+n:u<2.5/2.75?f*(7.5625*(u-=2.25/2.75)*u+.9375)+n:f*(7.5625*(u-=2.625/2.75)*u+.984375)+n},n._easeInOut=function(t,i,r,u){var f=i-t;return r.Milliseconds<u.Milliseconds/2?n.EaseIn(0,f,r.Multiply(2),u)*.5+t:n.EaseOut(0,f,r.Multiply(2).Subtract(u),u)*.5+f*.5+t},n}();n.Bounce=t})(n.Functions||(n.Functions={}));var t=n.Functions})(n.Tweening||(n.Tweening={}));var t=n.Tweening}(EndGate||(EndGate={})),function(n){(function(n){(function(n){var t=function(){function n(){}return Object.defineProperty(n,"EaseIn",{get:function(){return n._easeIn},enumerable:!0,configurable:!0}),Object.defineProperty(n,"EaseOut",{get:function(){return n._easeOut},enumerable:!0,configurable:!0}),Object.defineProperty(n,"EaseInOut",{get:function(){return n._easeInOut},enumerable:!0,configurable:!0}),n._easeIn=function(n,t,i,r){var f=t-n,u=i.Milliseconds;return-f*(Math.sqrt(1-(u/=r.Milliseconds)*u)-1)+n},n._easeOut=function(n,t,i,r){var f=t-n,u=i.Milliseconds;return f*Math.sqrt(1-(u=u/r.Milliseconds-1)*u)+n},n._easeInOut=function(n,t,i,r){var f=t-n,u=i.Milliseconds;return(u/=r.Milliseconds/2)<1?-f/2*(Math.sqrt(1-u*u)-1)+n:f/2*(Math.sqrt(1-(u-=2)*u)+1)+n},n}();n.Circular=t})(n.Functions||(n.Functions={}));var t=n.Functions})(n.Tweening||(n.Tweening={}));var t=n.Tweening}(EndGate||(EndGate={})),function(n){(function(n){(function(n){var t=function(){function n(){}return Object.defineProperty(n,"EaseIn",{get:function(){return n._easeIn},enumerable:!0,configurable:!0}),Object.defineProperty(n,"EaseOut",{get:function(){return n._easeOut},enumerable:!0,configurable:!0}),Object.defineProperty(n,"EaseInOut",{get:function(){return n._easeInOut},enumerable:!0,configurable:!0}),n._easeIn=function(n,t,i,r){var f=t-n,u=i.Milliseconds;return f*(u/=r.Milliseconds)*u*u+n},n._easeOut=function(n,t,i,r){var f=t-n,u=i.Milliseconds;return f*((u=u/r.Milliseconds-1)*u*u+1)+n},n._easeInOut=function(n,t,i,r){var f=t-n,u=i.Milliseconds;return(u/=r.Milliseconds/2)<1?f/2*u*u*u+n:f/2*((u-=2)*u*u+2)+n},n}();n.Cubic=t})(n.Functions||(n.Functions={}));var t=n.Functions})(n.Tweening||(n.Tweening={}));var t=n.Tweening}(EndGate||(EndGate={})),function(n){(function(n){(function(n){var t=function(){function n(){}return Object.defineProperty(n,"EaseIn",{get:function(){return n._easeIn},enumerable:!0,configurable:!0}),Object.defineProperty(n,"EaseOut",{get:function(){return n._easeOut},enumerable:!0,configurable:!0}),Object.defineProperty(n,"EaseInOut",{get:function(){return n._easeInOut},enumerable:!0,configurable:!0}),n._easeIn=function(n,t,i,r){var e=t-n,u=i.Milliseconds,f,o;return u===0?n:(u/=r.Milliseconds)==1?n+e:(f=r.Milliseconds*.3,o=f/4,-(e*Math.pow(2,10*(u-=1))*Math.sin((u*r.Milliseconds-o)*2*Math.PI/f))+n)},n._easeOut=function(n,t,i,r){var f=t-n,u=i.Milliseconds,e,o;return u===0?n:(u/=r.Milliseconds)==1?n+f:(e=r.Milliseconds*.3,o=e/4,f*Math.pow(2,-10*u)*Math.sin((u*r.Milliseconds-o)*2*Math.PI/e)+f+n)},n._easeInOut=function(n,t,i,r){var f=t-n,u=i.Milliseconds,e,o;return u===0?n:(u/=r.Milliseconds/2)==2?n+f:(e=r.Milliseconds*.3*1.5,o=e/4,u<1)?-.5*f*Math.pow(2,10*(u-=1))*Math.sin((u*r.Milliseconds-o)*2*Math.PI/e)+n:f*Math.pow(2,-10*(u-=1))*Math.sin((u*r.Milliseconds-o)*2*Math.PI/e)*.5+f+n},n}();n.Elastic=t})(n.Functions||(n.Functions={}));var t=n.Functions})(n.Tweening||(n.Tweening={}));var t=n.Tweening}(EndGate||(EndGate={})),function(n){(function(n){(function(n){var t=function(){function n(){}return Object.defineProperty(n,"EaseIn",{get:function(){return n._easeIn},enumerable:!0,configurable:!0}),Object.defineProperty(n,"EaseOut",{get:function(){return n._easeOut},enumerable:!0,configurable:!0}),Object.defineProperty(n,"EaseInOut",{get:function(){return n._easeInOut},enumerable:!0,configurable:!0}),n._easeIn=function(n,t,i,r){var f=t-n,u=i.Milliseconds;return u==0?n:f*Math.pow(2,10*(u/r.Milliseconds-1))+n},n._easeOut=function(n,t,i,r){var u=t-n,f=i.Milliseconds;return f==r.Milliseconds?n+u:u*(-Math.pow(2,-10*f/r.Milliseconds)+1)+n},n._easeInOut=function(n,t,i,r){var f=t-n,u=i.Milliseconds;return u==0?n:u==r.Milliseconds?n+f:(u/=r.Milliseconds/2)<1?f/2*Math.pow(2,10*(u-1))+n:f/2*(-Math.pow(2,-10*--u)+2)+n},n}();n.Exponential=t})(n.Functions||(n.Functions={}));var t=n.Functions})(n.Tweening||(n.Tweening={}));var t=n.Tweening}(EndGate||(EndGate={})),function(n){(function(n){(function(n){var t=function(){function n(){}return Object.defineProperty(n,"EaseNone",{get:function(){return n._easeNone},enumerable:!0,configurable:!0}),n._easeNone=function(n,t,i,r){var u=t-n;return u*i.Milliseconds/r.Milliseconds+n},n}();n.Linear=t})(n.Functions||(n.Functions={}));var t=n.Functions})(n.Tweening||(n.Tweening={}));var t=n.Tweening}(EndGate||(EndGate={})),function(n){(function(n){(function(n){var t=function(){function n(){}return Object.defineProperty(n,"EaseIn",{get:function(){return n._easeIn},enumerable:!0,configurable:!0}),Object.defineProperty(n,"EaseOut",{get:function(){return n._easeOut},enumerable:!0,configurable:!0}),Object.defineProperty(n,"EaseInOut",{get:function(){return n._easeInOut},enumerable:!0,configurable:!0}),n._easeIn=function(n,t,i,r){var f=t-n,u=i.Milliseconds;return f*(u/=r.Milliseconds)*u+n},n._easeOut=function(n,t,i,r){var f=t-n,u=i.Milliseconds;return-f*(u/=r.Milliseconds)*(u-2)+n},n._easeInOut=function(n,t,i,r){var f=t-n,u=i.Milliseconds;return(u/=r.Milliseconds/2)<1?f/2*u*u+n:-f/2*(--u*(u-2)-1)+n},n}();n.Quadratic=t})(n.Functions||(n.Functions={}));var t=n.Functions})(n.Tweening||(n.Tweening={}));var t=n.Tweening}(EndGate||(EndGate={})),function(n){(function(n){(function(n){var t=function(){function n(){}return Object.defineProperty(n,"EaseIn",{get:function(){return n._easeIn},enumerable:!0,configurable:!0}),Object.defineProperty(n,"EaseOut",{get:function(){return n._easeOut},enumerable:!0,configurable:!0}),Object.defineProperty(n,"EaseInOut",{get:function(){return n._easeInOut},enumerable:!0,configurable:!0}),n._easeIn=function(n,t,i,r){var f=t-n,u=i.Milliseconds;return f*(u/=r.Milliseconds)*u*u*u+n},n._easeOut=function(n,t,i,r){var f=t-n,u=i.Milliseconds;return-f*((u=u/r.Milliseconds-1)*u*u*u-1)+n},n._easeInOut=function(n,t,i,r){var f=t-n,u=i.Milliseconds;return(u/=r.Milliseconds/2)<1?f/2*u*u*u*u+n:-f/2*((u-=2)*u*u*u-2)+n},n}();n.Quartic=t})(n.Functions||(n.Functions={}));var t=n.Functions})(n.Tweening||(n.Tweening={}));var t=n.Tweening}(EndGate||(EndGate={})),function(n){(function(n){(function(n){var t=function(){function n(){}return Object.defineProperty(n,"EaseIn",{get:function(){return n._easeIn},enumerable:!0,configurable:!0}),Object.defineProperty(n,"EaseOut",{get:function(){return n._easeOut},enumerable:!0,configurable:!0}),Object.defineProperty(n,"EaseInOut",{get:function(){return n._easeInOut},enumerable:!0,configurable:!0}),n._easeIn=function(n,t,i,r){var f=t-n,u=i.Milliseconds;return f*(u/=r.Milliseconds)*u*u*u*u+n},n._easeOut=function(n,t,i,r){var f=t-n,u=i.Milliseconds;return f*((u=u/r.Milliseconds-1)*u*u*u*u+1)+n},n._easeInOut=function(n,t,i,r){var f=t-n,u=i.Milliseconds;return(u/=r.Milliseconds/2)<1?f/2*u*u*u*u*u+n:f/2*((u-=2)*u*u*u*u+2)+n},n}();n.Quintic=t})(n.Functions||(n.Functions={}));var t=n.Functions})(n.Tweening||(n.Tweening={}));var t=n.Tweening}(EndGate||(EndGate={})),function(n){(function(n){(function(n){var t=function(){function n(){}return Object.defineProperty(n,"EaseIn",{get:function(){return n._easeIn},enumerable:!0,configurable:!0}),Object.defineProperty(n,"EaseOut",{get:function(){return n._easeOut},enumerable:!0,configurable:!0}),Object.defineProperty(n,"EaseInOut",{get:function(){return n._easeInOut},enumerable:!0,configurable:!0}),n._easeIn=function(n,t,i,r){var u=t-n,f=i.Milliseconds;return-u*Math.cos(f/r.Milliseconds*(Math.PI/2))+u+n},n._easeOut=function(n,t,i,r){var u=t-n,f=i.Milliseconds;return u*Math.sin(f/r.Milliseconds*(Math.PI/2))+n},n._easeInOut=function(n,t,i,r){var u=t-n,f=i.Milliseconds;return-u/2*(Math.cos(Math.PI*f/r.Milliseconds)-1)+n},n}();n.Sinusoidal=t})(n.Functions||(n.Functions={}));var t=n.Functions})(n.Tweening||(n.Tweening={}));var t=n.Tweening}(EndGate||(EndGate={})),function(n){var t=function(){function n(){this._type="Event",this._actions=[],this._hasBindings=!1}return n.prototype.Bind=function(n){this._actions.push(n),this._hasBindings=!0},n.prototype.Unbind=function(n){for(var t=0;t<this._actions.length;t++)if(this._actions[t]===n){this._actions.splice(t,1),this._hasBindings=this._actions.length>0;return}},n.prototype.HasBindings=function(){return this._hasBindings},n.prototype.Trigger=function(n,t,i){for(var r=0;r<this._actions.length;r++)this._actions[r](n,t,i)},n}();n.EventHandler3=t}(EndGate||(EndGate={}));
//@ sourceMappingURL=endgate-0.1.0.min.js.map