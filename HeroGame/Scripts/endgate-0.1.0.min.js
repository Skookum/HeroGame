var __extends=this.__extends||function(a,f){function e(){this.constructor=a}for(var b in f)f.hasOwnProperty(b)&&(a[b]=f[b]);e.prototype=f.prototype;a.prototype=new e},EndGate;
(function(a){var f=function(){function a(b,c,d){"undefined"===typeof c&&(c=0);"undefined"===typeof d&&(d=0);this._type="TimeSpan";this.Milliseconds=b+c*a._secondsMultiplier+d*a._minutesMultiplier}Object.defineProperty(a.prototype,"Milliseconds",{get:function(){return this._milliseconds},set:function(b){this._milliseconds=b;this._seconds=b/a._secondsMultiplier;this._minutes=b/a._minutesMultiplier},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"Seconds",{get:function(){return this._seconds},
set:function(b){this._seconds=b;this._milliseconds=b*a._secondsMultiplier;this._minutes=this._milliseconds/a._minutesMultiplier},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"Minutes",{get:function(){return this._seconds},set:function(b){this._minutes=b;this._seconds=60*b;this._milliseconds=this._seconds*a._secondsMultiplier},enumerable:!0,configurable:!0});a.prototype.Add=function(b){return"TimeSpan"===b._type?new a(this.Milliseconds+b.Milliseconds):new a(this.Milliseconds+b)};
a.prototype.Multiply=function(b){return"TimeSpan"===b._type?new a(this.Milliseconds*b.Milliseconds):new a(this.Milliseconds*b)};a.prototype.Subtract=function(b){return"TimeSpan"===b._type?new a(this.Milliseconds-b.Milliseconds):new a(this.Milliseconds-b)};a.prototype.SubtractFrom=function(b){return"TimeSpan"===b._type?new a(b.Milliseconds-this.Milliseconds):new a(b-this.Milliseconds)};a.prototype.Divide=function(b){return"TimeSpan"===b._type?new a(this.Milliseconds/b.Milliseconds):new a(this.Milliseconds/
b)};a.prototype.DivideFrom=function(b){return"TimeSpan"===b._type?new a(b.Milliseconds/this.Milliseconds):new a(b/this.Milliseconds)};a.prototype.Equivalent=function(b){return this.Milliseconds===b.Milliseconds};a.prototype.Clone=function(){return new a(this.Milliseconds)};a.prototype.toString=function(){return this.Milliseconds+":"+this.Seconds+":"+this.Minutes};a.FromMilliseconds=function(b){return new a(b)};a.FromSeconds=function(b){return new a(0,b)};a.FromMinutes=function(b){return new a(0,0,
b)};a.DateSpan=function(b,c){return new a(c.getTime()-b.getTime())};Object.defineProperty(a,"Zero",{get:function(){return new a(0)},enumerable:!0,configurable:!0});a._secondsMultiplier=1E3;a._minutesMultiplier=60*a._secondsMultiplier;return a}();a.TimeSpan=f})(EndGate||(EndGate={}));
(function(a){var f=function(){function e(){this._type="GameTime";this._start=this._lastUpdate=new Date;this.Update()}Object.defineProperty(e.prototype,"Elapsed",{get:function(){return this._elapsed},enumerable:!0,configurable:!0});Object.defineProperty(e.prototype,"Now",{get:function(){return this._lastUpdate},enumerable:!0,configurable:!0});Object.defineProperty(e.prototype,"Total",{get:function(){return a.TimeSpan.DateSpan(this._start,new Date)},enumerable:!0,configurable:!0});e.prototype.Update=
function(){var b=new Date;this._elapsed=new a.TimeSpan(b.getTime()-this._lastUpdate.getTime());this._lastUpdate=b};return e}();a.GameTime=f})(EndGate||(EndGate={}));
(function(a){var f=function(){function a(b,c){this._type="Size2d";this.Width=b||0;this.Height="undefined"!==typeof c?c:this.Width}Object.defineProperty(a,"Zero",{get:function(){return new a(0,0)},enumerable:!0,configurable:!0});Object.defineProperty(a,"One",{get:function(){return new a(1,1)},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"Radius",{get:function(){return 0.5*Math.sqrt(this.Width*this.Width+this.Height*this.Height)},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,
"HalfWidth",{get:function(){return this.Width/2},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"HalfHeight",{get:function(){return this.Height/2},enumerable:!0,configurable:!0});a.prototype.Apply=function(b){this.Width=b(this.Width);this.Height=b(this.Height)};a.prototype.Trigger=function(b){b(this.Width);b(this.Height)};a.prototype.Add=function(b){return"Size2d"===b._type?new a(this.Width+b.Width,this.Height+b.Height):"Vector2d"===b._type?new a(this.Width+b.X,this.Height+b.Y):
new a(this.Width+b,this.Height+b)};a.prototype.Multiply=function(b){return"Size2d"===b._type?new a(this.Width*b.Width,this.Height*b.Height):"Vector2d"===b._type?new a(this.Width*b.X,this.Height*b.Y):new a(this.Width*b,this.Height*b)};a.prototype.Subtract=function(b){return"Size2d"===b._type?new a(this.Width-b.Width,this.Height-b.Height):"Vector2d"===b._type?new a(this.Width-b.X,this.Height-b.Y):new a(this.Width-b,this.Height-b)};a.prototype.SubtractFrom=function(b){return"Size2d"===b._type?new a(b.Width-
this.Width,b.Height-this.Height):"Vector2d"===b._type?new a(b.X-this.Width,b.Y-this.Height):new a(b-this.Width,b-this.Height)};a.prototype.Divide=function(b){return"Size2d"===b._type?new a(this.Width/b.Width,this.Height/b.Height):"Vector2d"===b._type?new a(this.Width/b.X,this.Height/b.Y):new a(this.Width/b,this.Height/b)};a.prototype.DivideFrom=function(b){return"Size2d"===b._type?new a(b.Width/this.Width,b.Height/this.Height):"Vector2d"===b._type?new a(b.X/this.Width,b.Y/this.Height):new a(b/this.Width,
b/this.Height)};a.prototype.Negate=function(){return new a(-1*this.Width,-1*this.Height)};a.prototype.Equivalent=function(b){return this.Width===b.Width&&this.Height===b.Height};a.prototype.Clone=function(){return new a(this.Width,this.Height)};a.prototype.toString=function(){return"("+this.Width+", "+this.Height+")"};return a}();a.Size2d=f})(EndGate||(EndGate={}));Math.roundTo=function(a,f){var e=Math.pow(10,f);return Math.round(a*e)/e};Math.twoPI=2*Math.PI;
(function(a){var f=function(){function a(b,c){this._type="Vector2d";this.X=b||0;this.Y=c||0}Object.defineProperty(a,"Zero",{get:function(){return new a(0,0)},enumerable:!0,configurable:!0});Object.defineProperty(a,"One",{get:function(){return new a(1,1)},enumerable:!0,configurable:!0});a.prototype.Reflect=function(b){b=b.Unit();var c=2*this.Dot(b);return new a(this.X-c*b.X,this.Y-c*b.Y)};a.prototype.ProjectOnto=function(b){return b.Multiply(this.Dot(b)/b.Dot(b))};a.prototype.RotateAround=function(b,
c,d){"undefined"===typeof d&&(d=2);var p=Math.cos(c);c=Math.sin(c);return new a(Math.roundTo(p*(this.X-b.X)-c*(this.Y-b.Y)+b.X,d),Math.roundTo(c*(this.X-b.X)+p*(this.Y-b.Y)+b.Y,d))};a.prototype.Apply=function(b){this.X=b(this.X);this.Y=b(this.Y)};a.prototype.Trigger=function(b){b(this.X);b(this.Y)};a.prototype.Normalized=function(){var b=this.Magnitude();return new a(this.X/b,this.Y/b)};a.prototype.Magnitude=function(){return Math.sqrt(this.X*this.X+this.Y*this.Y)};a.prototype.Length=function(){return this.Magnitude()};
a.prototype.Dot=function(b){return b.X*this.X+b.Y*this.Y};a.prototype.Abs=function(){return new a(Math.abs(this.X),Math.abs(this.Y))};a.prototype.Sign=function(){return new a(this.X/Math.abs(this.X),this.Y/Math.abs(this.Y))};a.prototype.Unit=function(){var b=this.Magnitude();return new a(this.X/b,this.Y/b)};a.prototype.Distance=function(b){return new a(Math.abs(b.X-this.X),Math.abs(b.Y-this.Y))};a.prototype.Add=function(b){return"Vector2d"===b._type?new a(this.X+b.X,this.Y+b.Y):"Size2d"===b._type?
new a(this.X+b.Width,this.Y+b.Height):new a(this.X+b,this.Y+b)};a.prototype.Multiply=function(b){return"Vector2d"===b._type?new a(this.X*b.X,this.Y*b.Y):"Size2d"===b._type?new a(this.X*b.Width,this.Y*b.Height):new a(this.X*b,this.Y*b)};a.prototype.Subtract=function(b){return"Vector2d"===b._type?new a(this.X-b.X,this.Y-b.Y):"Size2d"===b._type?new a(this.X-b.Width,this.Y-b.Height):new a(this.X-b,this.Y-b)};a.prototype.SubtractFrom=function(b){return"Vector2d"===b._type?new a(b.X-this.X,b.Y-this.Y):
"Size2d"===b._type?new a(b.Width-this.X,b.Height=this.Y):new a(b-this.X,b-this.Y)};a.prototype.Divide=function(b){return"Vector2d"===b._type?new a(this.X/b.X,this.Y/b.Y):"Size2d"===b._type?new a(this.X/b.Width,this.Y/b.Height):new a(this.X/b,this.Y/b)};a.prototype.DivideFrom=function(b){return"Vector2d"===b._type?new a(b.X/this.X,b.Y/this.Y):"Size2d"===b._type?new a(b.Width/this.X,b.Height/this.Y):new a(b/this.X,b/this.Y)};a.prototype.IsZero=function(){return 0===this.X&&0===this.Y};a.prototype.Negate=
function(){return new a(-1*this.X,-1*this.Y)};a.prototype.Equivalent=function(b){return this.X===b.X&&this.Y===b.Y};a.prototype.Clone=function(){return new a(this.X,this.Y)};a.prototype.toString=function(){return"("+this.X+", "+this.Y+")"};return a}();a.Vector2d=f})(EndGate||(EndGate={}));
(function(a){(function(a){(function(a){var b=function(){function c(d,c){this._boundsType="Bounds2d";this.Position=d;this.Rotation=c||0}c.prototype.Scale=function(d,c){throw Error("This method is abstract!");};c.prototype.ContainsPoint=function(d){throw Error("This method is abstract!");};c.prototype.Intersects=function(d){if("BoundingCircle"===d._boundsType)return this.IntersectsCircle(d);if("BoundingRectangle"===d._boundsType)return this.IntersectsRectangle(d);throw Error("Cannot intersect with unidentifiable object, must be BoundingCircle or BoundingRectangle");
};c.prototype.IntersectsCircle=function(d){throw Error("This method is abstract!");};c.prototype.IntersectsRectangle=function(d){throw Error("This method is abstract!");};return c}();a.Bounds2d=b})(a.Abstractions||(a.Abstractions={}))})(a.Bounds||(a.Bounds={}))})(EndGate||(EndGate={}));
(function(a){(function(a){(function(a){var b=function(){function c(d){this._type="LooperCallback";this.Callback=d;this.ID=c._ids++}c._ids=0;return c}();a.LooperCallback=b})(a.Loopers||(a.Loopers={}))})(a._||(a._={}))})(EndGate||(EndGate={}));
(function(a){(function(a){(function(a){var b=function(c){function d(d,b){c.call(this,b);this._type="TimedCallback";this.Fps=d;this.TimeoutID=0;this.Active=!1}__extends(d,c);return d}(a.LooperCallback);a.TimedCallback=b})(a.Loopers||(a.Loopers={}))})(a._||(a._={}))})(EndGate||(EndGate={}));
(function(a){(function(a){(function(a){var b=function(){function c(){this._type="Looper";this._running=!1;this._callbacks=[]}c.prototype.AddCallback=function(d){var c=this;this._callbacks.push(d);d.Active=!0;this._running&&window.setTimeout(function(){c.Loop(d)},0)};c.prototype.RemoveCallback=function(d){for(var c=0;c<this._callbacks.length;c++)if(this._callbacks[c].ID===d.ID){window.clearTimeout(d.TimeoutID);d.Active=!1;this._callbacks.splice(c,1);break}};c.prototype.Start=function(){this._running=
!0;this.Run()};c.prototype.Run=function(){for(var d=this,c=0;c<this._callbacks.length;c++)window.setTimeout(function(c){return function(){d.Loop(d._callbacks[c])}}(c),0)};c.prototype.Loop=function(d){var c=this,b=1E3/d.Fps;d.Callback();d.Active&&(d.TimeoutID=window.setTimeout(function(){c.Loop(d)},b))};c.prototype.Dispose=function(){for(var d=this._callbacks.length-1;0<=d;d--)this.RemoveCallback(this._callbacks[d]);this._callbacks=[];this._running=!1};return c}();a.Looper=b})(a.Loopers||(a.Loopers=
{}))})(a._||(a._={}))})(EndGate||(EndGate={}));window.OnRepaintCompleted=function(){return window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(a){window.setTimeout(a,0)}}();
(function(a){(function(a){(function(a){var b=function(){function c(){this._type="RepaintLooper";this._callbacksModified=this._running=!1;this._callbacks=[]}c.prototype.Start=function(){this._running=!0;this.Run()};c.prototype.Run=function(){var d=this;if(this._running){this._callbacksModified=!1;for(var c=0;c<this._callbacks.length&&(this._callbacks[c].Callback(),!this._callbacksModified);c++);window.OnRepaintCompleted(function(){d.Run()})}};c.prototype.AddCallback=function(d){this._callbacksModified=
!0;this._callbacks.push(d)};c.prototype.RemoveCallback=function(d){for(var c=0;c<this._callbacks.length;c++)if(this._callbacks[c].ID===d.ID){this._callbacksModified=!0;this._callbacks.splice(c,1);break}};c.prototype.Dispose=function(){this._callbacksModified=!0;this._callbacks=[];this._running=!1};return c}();a.RepaintLooper=b})(a.Loopers||(a.Loopers={}))})(a._||(a._={}))})(EndGate||(EndGate={}));
(function(a){(function(a){var e=function(){function b(){this._type="GameRunner";this._updateCallbacks={};this._drawCallbacks={};this._drawLoop=this._updateLoop=null;this._callbackCount=0}b.prototype.Register=function(c){var d=this.CreateAndCacheUpdateCallback(c);c=this.CreateAndCacheDrawCallback(c);this._callbackCount++;this.TryLoopStart();this._updateLoop.AddCallback(d);this._drawLoop.AddCallback(c);return this.CreateUpdateRateSetter(d)};b.prototype.Unregister=function(c){var d,b;this._updateCallbacks[c._ID]&&
(d=this._updateCallbacks[c._ID],b=this._drawCallbacks[c._ID],this._updateLoop.RemoveCallback(d),this._drawLoop.RemoveCallback(b),delete this._updateCallbacks[c._ID],delete this._drawCallbacks[c._ID],this._callbackCount--,this.TryLoopStop())};b.prototype.TryLoopStart=function(){1===this._callbackCount&&(this._updateLoop=new a.Loopers.Looper,this._updateLoop.Start(),this._drawLoop=new a.Loopers.RepaintLooper,this._drawLoop.Start())};b.prototype.TryLoopStop=function(){0===this._callbackCount&&null!=
this._updateLoop&&(this._updateLoop.Dispose(),this._updateLoop=null,this._drawLoop.Dispose(),this._drawLoop=null)};b.prototype.CreateAndCacheUpdateCallback=function(c){var d=new a.Loopers.TimedCallback(0,function(){c._PrepareUpdate()});return this._updateCallbacks[c._ID]=d};b.prototype.CreateAndCacheDrawCallback=function(c){var d=new a.Loopers.LooperCallback(function(){c._PrepareDraw()});return this._drawCallbacks[c._ID]=d};b.prototype.CreateUpdateRateSetter=function(c){return function(d){c.Fps=d}};
return b}();a.GameRunner=e})(a._||(a._={}))})(EndGate||(EndGate={}));var GameRunnerInstance=new EndGate._.GameRunner;
(function(a){var f=function(){function a(b){this._defaultUpdateRate=40;this._updateRateSetter=b;this._updateRate=this._defaultUpdateRate}Object.defineProperty(a.prototype,"UpdateRate",{get:function(){return this._updateRate},set:function(b){this._updateRate=b;this._updateRateSetter(this._updateRate)},enumerable:!0,configurable:!0});return a}();a.GameConfiguration=f})(EndGate||(EndGate={}));
(function(a){var f=function(){function a(){this._type="Event";this._actions=[];this._hasBindings=!1}a.prototype.Bind=function(b){this._actions.push(b);this._hasBindings=!0};a.prototype.Unbind=function(b){for(var c=0;c<this._actions.length;c++)if(this._actions[c]===b){this._actions.splice(c,1);this._hasBindings=0<this._actions.length;break}};a.prototype.HasBindings=function(){return this._hasBindings};a.prototype.Trigger=function(b){for(var c=0;c<this._actions.length;c++)this._actions[c](b)};return a}();
a.EventHandler1=f})(EndGate||(EndGate={}));(function(a){(function(a){(function(a){var b=function(){return function(c,d){this.At=c;this.With=d}}();a.CollisionData=b})(a.Assets||(a.Assets={}))})(a.Collision||(a.Collision={}))})(EndGate||(EndGate={}));
(function(a){(function(f){var e=function(){function b(c){this._type="Collidable";this._disposed=!1;this.Bounds=c;this._id=b._collidableIDs++;this._onCollision=new a.EventHandler1;this._onDisposed=new a.EventHandler1}Object.defineProperty(b.prototype,"OnCollision",{get:function(){return this._onCollision},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"OnDisposed",{get:function(){return this._onDisposed},enumerable:!0,configurable:!0});b.prototype.IsCollidingWith=function(c){return this.Bounds.Intersects(c.Bounds)};
b.prototype.Collided=function(c){this.OnCollision.Trigger(c)};b.prototype.Dispose=function(){if(this._disposed)throw Error("Cannot dispose collidable more than once.");this._disposed=!0;this.OnDisposed.Trigger(this)};b._collidableIDs=0;return b}();f.Collidable=e})(a.Collision||(a.Collision={}))})(EndGate||(EndGate={}));
(function(a){var f=function(){function a(){this._type="Event";this._actions=[];this._hasBindings=!1}a.prototype.Bind=function(b){this._actions.push(b);this._hasBindings=!0};a.prototype.Unbind=function(b){for(var c=0;c<this._actions.length;c++)if(this._actions[c]===b){this._actions.splice(c,1);this._hasBindings=0<this._actions.length;break}};a.prototype.HasBindings=function(){return this._hasBindings};a.prototype.Trigger=function(b,c){for(var d=0;d<this._actions.length;d++)this._actions[d](b,c)};return a}();
a.EventHandler2=f})(EndGate||(EndGate={}));
(function(a){(function(f){var e=function(){function b(){this._type="CollisionManager";this._collidables=[];this._enabled=!1;this._onCollision=new a.EventHandler2}Object.defineProperty(b.prototype,"OnCollision",{get:function(){return this._onCollision},enumerable:!0,configurable:!0});b.prototype.Monitor=function(c){var d=this;this._enabled=!0;c.OnDisposed.Bind(function(){d.Unmonitor(c)});this._collidables.push(c)};b.prototype.Unmonitor=function(c){for(var d=0;d<this._collidables.length;d++)if(this._collidables[d]._id===
c._id){this._collidables.splice(d,1);break}};b.prototype.Update=function(c){var d;if(this._enabled)for(var b=0;b<this._collidables.length;b++){c=this._collidables[b];for(var a=b+1;a<this._collidables.length;a++)d=this._collidables[a],c.IsCollidingWith(d)&&(c.Collided(new f.Assets.CollisionData(c.Bounds.Position.Clone(),d)),d.Collided(new f.Assets.CollisionData(d.Bounds.Position.Clone(),c)),this.OnCollision.Trigger(c,d))}};return b}();f.CollisionManager=e})(a.Collision||(a.Collision={}))})(EndGate||
(EndGate={}));
(function(a){(function(a){(function(a){(function(b){var c=function(){function d(){this._cachedState={}}Object.defineProperty(d.prototype,"StrokeStyle",{get:function(){return this._cachedState.strokeStyle},set:function(d){this._cachedState.strokeStyle=d},enumerable:!0,configurable:!0});Object.defineProperty(d.prototype,"FillStyle",{get:function(){return this._cachedState.fillStyle},set:function(d){this._cachedState.fillStyle=d},enumerable:!0,configurable:!0});Object.defineProperty(d.prototype,"GlobalAlpha",
{get:function(){return this._cachedState.globalAlpha},set:function(d){this._cachedState.globalAlpha=d},enumerable:!0,configurable:!0});Object.defineProperty(d.prototype,"LineWidth",{get:function(){return this._cachedState.lineWidth},set:function(d){this._cachedState.lineWidth=d},enumerable:!0,configurable:!0});Object.defineProperty(d.prototype,"LineCap",{get:function(){return this._cachedState.lineCap},set:function(d){this._cachedState.lineCap=d},enumerable:!0,configurable:!0});Object.defineProperty(d.prototype,
"LineJoin",{get:function(){return this._cachedState.lineJoin},set:function(d){this._cachedState.lineJoin=d},enumerable:!0,configurable:!0});Object.defineProperty(d.prototype,"MiterLimit",{get:function(){return this._cachedState.miterLimit},set:function(d){this._cachedState.miterLimit=d},enumerable:!0,configurable:!0});Object.defineProperty(d.prototype,"ShadowOffsetX",{get:function(){return this._cachedState.shadowOffsetX},set:function(d){this._cachedState.shadowOffsetX=d},enumerable:!0,configurable:!0});
Object.defineProperty(d.prototype,"ShadowOffsetY",{get:function(){return this._cachedState.shadowOffsetY},set:function(d){this._cachedState.shadowOffsetY=d},enumerable:!0,configurable:!0});Object.defineProperty(d.prototype,"ShadowBlur",{get:function(){return this._cachedState.shadowBlur},set:function(d){this._cachedState.shadowBlur=d},enumerable:!0,configurable:!0});Object.defineProperty(d.prototype,"ShadowColor",{get:function(){return this._cachedState.shadowColor},set:function(d){this._cachedState.shadowColor=
d},enumerable:!0,configurable:!0});Object.defineProperty(d.prototype,"GlobalCompositeOperation",{get:function(){return this._cachedState.globalCompositeOperation},set:function(d){this._cachedState.globalCompositeOperation=d},enumerable:!0,configurable:!0});Object.defineProperty(d.prototype,"Font",{get:function(){return this._cachedState.font},set:function(d){this._cachedState.font=d},enumerable:!0,configurable:!0});Object.defineProperty(d.prototype,"TextAlign",{get:function(){return this._cachedState.textAlign},
set:function(d){this._cachedState.textAlign=d},enumerable:!0,configurable:!0});Object.defineProperty(d.prototype,"TextBaseline",{get:function(){return this._cachedState.textBaseline},set:function(d){this._cachedState.textBaseline=d},enumerable:!0,configurable:!0});d.prototype.SetContextState=function(d){for(var c in this._cachedState)d[c]=this._cachedState[c]};return d}();b.Graphic2dState=c})(a._||(a._={}))})(a.Assets||(a.Assets={}))})(a.Graphics||(a.Graphics={}))})(EndGate||(EndGate={}));
(function(a){(function(f){(function(e){var b=function(){function c(d){this._type="Graphic2d";this.Position=d;this.ZIndex=this.Rotation=0;this.Visible=!0;this._State=new f.Assets._.Graphic2dState;this._children=[];this._disposed=!1;this._onDisposed=new a.EventHandler1}Object.defineProperty(c.prototype,"OnDisposed",{get:function(){return this._onDisposed},enumerable:!0,configurable:!0});c.prototype.AddChild=function(d){this._children.push(d);this._children.sort(c._zindexSort)};c.prototype.RemoveChild=
function(d){d=this._children.indexOf(d);return 0<=d?(this._children.splice(d,1),!0):!1};c.prototype.Children=function(){return this._children};c.prototype._StartDraw=function(d){d.save();this._State.SetContextState(d);d.translate(this.Position.X,this.Position.Y);0!==this.Rotation&&d.rotate(this.Rotation)};c.prototype._EndDraw=function(d){for(var c=0;c<this._children.length;c++)this._children[c].Draw(d);d.restore()};c.prototype.Draw=function(d){throw Error("The Draw method is abstract on Graphic2d and should not be called.");
};c.prototype.GetDrawBounds=function(){throw Error("GetDrawBounds is abstract, it must be implemented.");};c.prototype.Dispose=function(){if(this._disposed)throw Error("Cannot dispose graphic more than once.");this._disposed=!0;this.OnDisposed.Trigger(this)};c._zindexSort=function(d,c){return d.ZIndex-c.ZIndex};return c}();e.Graphic2d=b})(f.Abstractions||(f.Abstractions={}))})(a.Graphics||(a.Graphics={}))})(EndGate||(EndGate={}));
(function(a){(function(a){var e=function(){return function(a,c){this.Min=a;this.Max=c}}();a.MinMax=e})(a._||(a._={}))})(EndGate||(EndGate={}));(function(a){(function(a){var e=function(){function b(){}b.GetMinMaxProjections=function(c,d){for(var b=d[0].ProjectOnto(c).Dot(c),g=b,l=1;l<d.length;l++){var e=d[l].ProjectOnto(c).Dot(c);e<b?b=e:e>g&&(g=e)}return new a.MinMax(b,g)};return b}();a.Vector2dHelpers=e})(a._||(a._={}))})(EndGate||(EndGate={}));
(function(a){(function(a){var e=function(a){function c(d,c){a.call(this,d);this._boundsType=this._type="BoundingCircle";this.Radius=c}__extends(c,a);c.prototype.Scale=function(d){this.Radius*=d};c.prototype.Area=function(){return Math.PI*this.Radius*this.Radius};c.prototype.Circumference=function(){return 2*Math.PI*this.Radius};c.prototype.IntersectsCircle=function(d){return this.Position.Distance(d.Position).Length()<this.Radius+d.Radius};c.prototype.IntersectsRectangle=function(d){var c=(0===d.Rotation?
this.Position:this.Position.RotateAround(d.Position,-d.Rotation)).Distance(d.Position);return c.X>d.Size.HalfWidth+this.Radius||c.Y>d.Size.HalfHeight+this.Radius?!1:c.X<=d.Size.HalfWidth||c.Y<=d.Size.HalfHeight?!0:Math.pow(c.X-d.Size.HalfWidth,2)+Math.pow(c.Y-d.Size.HalfHeight,2)<=this.Radius*this.Radius};c.prototype.ContainsPoint=function(d){return this.Position.Distance(d).Magnitude()<this.Radius};return c}(a.Abstractions.Bounds2d);a.BoundingCircle=e})(a.Bounds||(a.Bounds={}))})(EndGate||(EndGate=
{}));
(function(a){(function(f){var e=function(b){function c(d,c){b.call(this,d);this._boundsType=this._type="BoundingRectangle";this.Size=c}__extends(c,b);c.prototype.Scale=function(d,c){this.Size.Width*=d;this.Size.Height*=c};Object.defineProperty(c.prototype,"TopLeft",{get:function(){return 0===this.Rotation?new a.Vector2d(this.Position.X-this.Size.HalfWidth,this.Position.Y-this.Size.HalfHeight):(new a.Vector2d(this.Position.X-this.Size.HalfWidth,this.Position.Y-this.Size.HalfHeight)).RotateAround(this.Position,this.Rotation)},
enumerable:!0,configurable:!0});Object.defineProperty(c.prototype,"TopRight",{get:function(){return 0===this.Rotation?new a.Vector2d(this.Position.X+this.Size.HalfWidth,this.Position.Y-this.Size.HalfHeight):(new a.Vector2d(this.Position.X+this.Size.HalfWidth,this.Position.Y-this.Size.HalfHeight)).RotateAround(this.Position,this.Rotation)},enumerable:!0,configurable:!0});Object.defineProperty(c.prototype,"BotLeft",{get:function(){return 0===this.Rotation?new a.Vector2d(this.Position.X-this.Size.HalfWidth,
this.Position.Y+this.Size.HalfHeight):(new a.Vector2d(this.Position.X-this.Size.HalfWidth,this.Position.Y+this.Size.HalfHeight)).RotateAround(this.Position,this.Rotation)},enumerable:!0,configurable:!0});Object.defineProperty(c.prototype,"BotRight",{get:function(){return 0===this.Rotation?new a.Vector2d(this.Position.X+this.Size.HalfWidth,this.Position.Y+this.Size.HalfHeight):(new a.Vector2d(this.Position.X+this.Size.HalfWidth,this.Position.Y+this.Size.HalfHeight)).RotateAround(this.Position,this.Rotation)},
enumerable:!0,configurable:!0});c.prototype.Corners=function(){return[this.TopLeft,this.TopRight,this.BotLeft,this.BotRight]};c.prototype.IntersectsCircle=function(d){return d.IntersectsRectangle(this)};c.prototype.IntersectsRectangle=function(d){if(0===this.Rotation&&0===d.Rotation){var c=this.TopLeft,b=this.BotRight,l=d.TopLeft;d=d.BotRight;return l.X<=b.X&&d.X>=c.X&&l.Y<=b.Y&&d.Y>=c.Y}if(d.Position.Distance(this.Position).Magnitude()<=d.Size.Radius+this.Size.Radius){c=[this.TopRight.Subtract(this.TopLeft),
this.TopRight.Subtract(this.BotRight),d.TopLeft.Subtract(d.BotLeft),d.TopLeft.Subtract(d.TopRight)];b=this.Corners();d=d.Corners();for(l=0;l<c.length;l++){var f=c[l],e=a._.Vector2dHelpers.GetMinMaxProjections(f,b),f=a._.Vector2dHelpers.GetMinMaxProjections(f,d);if(f.Max<e.Min||e.Max<f.Min)return!1}return!0}return!1};c.prototype.ContainsPoint=function(d){var c=this.Rotation;0!==this.Rotation&&(this.Rotation=0,d=d.RotateAround(this.Position,-c));var a=this.TopLeft,b=this.BotRight;this.Rotation=c;return d.X<=
b.X&&d.X>=a.X&&d.Y<=b.Y&&d.Y>=a.Y};return c}(f.Abstractions.Bounds2d);f.BoundingRectangle=e})(a.Bounds||(a.Bounds={}))})(EndGate||(EndGate={}));
(function(a){(function(f){var e=function(a){function c(d,p){a.call(this,d,p);this._type="Camera2d";this.Distance=c.DefaultDistance}__extends(c,a);c.prototype.ToCameraRelative=function(d){return this.Position.Subtract(this.Size.Multiply(0.5*this._GetDistanceScale())).Add(d.Multiply(this._GetDistanceScale()))};c.prototype._GetInverseDistanceScale=function(){return c.DefaultDistance/this.Distance};c.prototype._GetDistanceScale=function(){return this.Distance/c.DefaultDistance};c.DefaultDistance=1E3;
return c}(a.Bounds.BoundingRectangle);f.Camera2d=e})(a.Rendering||(a.Rendering={}))})(EndGate||(EndGate={}));
(function(a){(function(f){var e=function(){function b(c){this._visibleCanvas=c;this._visibleContext=c.getContext("2d");this._BufferCanvas=document.createElement("canvas");this._BufferContext=this._BufferCanvas.getContext("2d");this._onRendererSizeChange=new a.EventHandler1;this.UpdateBufferSize();this._disposed=!1}Object.defineProperty(b.prototype,"OnRendererSizeChange",{get:function(){return this._onRendererSizeChange},enumerable:!0,configurable:!0});b.prototype.Render=function(c){this._BufferCanvas.width===
this._visibleCanvas.width&&this._BufferCanvas.height===this._visibleCanvas.height||this.UpdateBufferSize();this._visibleContext.clearRect(0,0,this._visibleCanvas.width,this._visibleCanvas.height);this._visibleContext.drawImage(this._BufferCanvas,0,0);this._ClearBuffer();c.sort(b._zindexSort);for(var d=0;d<c.length;d++)c[d].Draw(this._BufferContext);return this._BufferContext};b.prototype.Dispose=function(){this._disposed||(this._disposed=!0,this._visibleCanvas.parentNode.removeChild(this._visibleCanvas))};
b.prototype._ClearBuffer=function(){this._BufferContext.clearRect(0,0,this._BufferCanvas.width,this._BufferCanvas.height)};b.prototype.UpdateBufferSize=function(){this._BufferCanvas.width=this._visibleCanvas.width;this._BufferCanvas.height=this._visibleCanvas.height;this.OnRendererSizeChange.Trigger(new a.Size2d(this._visibleCanvas.width,this._visibleCanvas.height))};b._zindexSort=function(c,d){return c.ZIndex-d.ZIndex};return b}();f.Renderer2d=e})(a.Rendering||(a.Rendering={}))})(EndGate||(EndGate=
{}));
(function(a){(function(a){(function(a){var b=function(){function c(d){this._camera=d;this._canvasCenter=this._camera.Position.Clone();this._translated=!1;this._translationState=[];this._translationState.push(this._translated)}c.prototype.Build=function(d){var c=this,a=d.createRadialGradient,b=d.translate,f=d.save,e=d.restore,m=this.BuildPositionReplacer(d.drawImage,1),h=this.BuildPositionReplacer(d.drawImage,5);d.unModifiedClearRect=d.clearRect;d.arc=this.BuildPositionReplacer(d.arc);d.arcTo=this.BuildPositionReplacer(d.arcTo,
0,4);d.bezierCurveTo=this.BuildPositionReplacer(d.bezierCurveTo,0,6);d.clearRect=this.BuildPositionReplacer(d.clearRect);d.createLinearGradient=this.BuildPositionReplacer(d.createLinearGradient,0,4);d.createRadialGradient=function(){var d=c._camera._GetDistanceScale();arguments[0]+=-c._camera.Position.X+c._canvasCenter.X*d;arguments[1]+=-c._camera.Position.Y+c._canvasCenter.Y*d;arguments[3]+=-c._camera.Position.X+c._canvasCenter.X*d;arguments[4]+=-c._camera.Position.Y+c._canvasCenter.Y*d;return a.apply(this,
arguments)};d.drawImage=function(){5>=arguments.length?m.apply(this,arguments):h.apply(this,arguments)};d.fillRect=this.BuildPositionReplacer(d.fillRect);d.fillText=this.BuildPositionReplacer(d.fillText,1);d.getImageData=this.BuildPositionReplacer(d.getImageData);d.isPointInPath=this.BuildPositionReplacer(d.isPointInPath);d.lineTo=this.BuildPositionReplacer(d.lineTo);d.moveTo=this.BuildPositionReplacer(d.moveTo);d.putImageData=this.BuildPositionReplacer(d.putImageData,1);d.quadraticCurveTo=this.BuildPositionReplacer(d.quadraticCurveTo,
0,4);d.rect=this.BuildPositionReplacer(d.rect);d.strokeRect=this.BuildPositionReplacer(d.strokeRect);d.strokeText=this.BuildPositionReplacer(d.strokeText,1);d.save=function(){c._translationState.push(c._translated);f.call(this)};d.restore=function(){c._translated=c._translationState.pop();e.call(this)};d.translate=function(){var d;c._translated||(d=c._camera._GetDistanceScale(),arguments[0]+=-c._camera.Position.X+c._canvasCenter.X*d,arguments[1]+=-c._camera.Position.Y+c._canvasCenter.Y*d);c._translated=
!0;b.apply(this,arguments)};return d};c.prototype._UpdateCanvasCenter=function(d){this._canvasCenter.X=d.Width/2;this._canvasCenter.Y=d.Height/2};c.prototype.BuildPositionReplacer=function(d,c,a){"undefined"===typeof c&&(c=0);"undefined"===typeof a&&(a=2);var b=this,f=["X","Y"];return function(){var e,m;if(!b._translated){e=b._camera._GetDistanceScale();for(var h=0;h<a;h++)m=f[h%2],arguments[c+h]+=-b._camera.Position[m]+b._canvasCenter[m]*e}return d.apply(this,arguments)}};return c}();a.Camera2dCanvasContextBuilder=
b})(a._||(a._={}))})(a.Rendering||(a.Rendering={}))})(EndGate||(EndGate={}));
(function(a){(function(f){var e=function(b){function c(d,c){b.call(this,d);this._camera=c;this._contextBuilder=new f._.Camera2dCanvasContextBuilder(this._camera);this.OnRendererSizeChange.Bind(this._contextBuilder._UpdateCanvasCenter);this._contextBuilder._UpdateCanvasCenter(new a.Size2d(d.width,d.height));this._BufferContext=this._contextBuilder.Build(this._BufferContext)}__extends(c,b);c.prototype.Render=function(d){var c=this._camera._GetInverseDistanceScale();this._BufferContext.save();this._BufferContext.scale(c,
c);d=b.prototype.Render.call(this,this.GetOnScreenRenderables(d));this._BufferContext.restore();return d};c.prototype._ClearBuffer=function(){var d=this._camera._GetDistanceScale();this._BufferContext.unModifiedClearRect(0,0,this._BufferCanvas.width*d,this._BufferCanvas.height*d)};c.prototype.GetOnScreenRenderables=function(d){var c=[],a=this._camera._GetDistanceScale(),b=1/a;this._camera.Scale(a,a);for(a=0;a<d.length;a++)d[a].Visible&&this._camera.Intersects(d[a].GetDrawBounds())&&c.push(d[a]);this._camera.Scale(b,
b);return c};return c}(f.Renderer2d);f.Camera2dRenderer=e})(a.Rendering||(a.Rendering={}))})(EndGate||(EndGate={}));
(function(a){(function(f){var e=function(){function b(c,d){"undefined"===typeof c&&(c=function(d){});this._actors=[];"undefined"===typeof d&&(d=this.CreateDefaultDrawArea());this._onDraw=c;this.ApplyStyles(d);this._drawArea=d;this._camera=new f.Camera2d(new a.Vector2d(this._drawArea.width/2,this._drawArea.height/2),new a.Size2d(this._drawArea.width,this._drawArea.height));this._renderer=new f.Camera2dRenderer(this._drawArea,this._camera);this._disposed=!1}Object.defineProperty(b.prototype,"DrawArea",
{get:function(){return this._drawArea},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"Camera",{get:function(){return this._camera},enumerable:!0,configurable:!0});b.prototype.Add=function(c){var d=this;c.OnDisposed.Bind(function(c){d.Remove(c)});this._actors.push(c)};b.prototype.Remove=function(c){for(var d=0;d<this._actors.length;d++)if(this._actors[d]===c){this._actors.splice(d,1);break}};b.prototype.Draw=function(){this._onDraw(this._renderer.Render(this._actors))};b.prototype.Dispose=
function(){if(this._disposed)throw Error("Scene2d cannot be disposed more than once");this._disposed=!0;this._actors=[];this._renderer.Dispose()};b.prototype.ApplyStyles=function(c){c.style.position="absolute";c.style.zIndex="2";c.parentElement.style.position="relative"};b.prototype.CreateDefaultDrawArea=function(){var c=document.createElement("canvas"),d=document.getElementsByTagName("body")[0];c.width=window.innerWidth;c.height=window.innerHeight;d.appendChild(c);d.style.margin="0px";d.style.padding=
"0px";return c};return b}();f.Scene2d=e})(a.Rendering||(a.Rendering={}))})(EndGate||(EndGate={}));(function(a){(function(a){(function(a){var b=function(){function c(){}c.Left="Left";c.Middle="Middle";c.Right="Right";return c}();a.MouseButton=b})(a._||(a._={}))})(a.Input||(a.Input={}))})(EndGate||(EndGate={}));
(function(a){(function(f){var e=function(){function b(c){var d=this;this._target=c;this._onClick=new a.EventHandler1;this._onDoubleClick=new a.EventHandler1;this._onDown=new a.EventHandler1;this._onUp=new a.EventHandler1;this._onMove=new a.EventHandler1;this._onScroll=new a.EventHandler1;this._rightIsDown=this._middleIsDown=this._leftIsDown=!1;this.Wire();this.OnDown.Bind(function(c){d._isDown=!0;d[c.Button+"IsDown"]=!0});this.OnUp.Bind(function(c){d._isDown=!1;d[c.Button+"IsDown"]=!1})}Object.defineProperty(b.prototype,
"LeftIsDown",{get:function(){return this._leftIsDown},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"MiddleIsDown",{get:function(){return this._middleIsDown},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"RightIsDown",{get:function(){return this._rightIsDown},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"IsDown",{get:function(){return this._isDown},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"OnClick",{get:function(){return this._onClick},
enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"OnDoubleClick",{get:function(){return this._onDoubleClick},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"OnDown",{get:function(){return this._onDown},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"OnUp",{get:function(){return this._onUp},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"OnMove",{get:function(){return this._onMove},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,
"OnScroll",{get:function(){return this._onScroll},enumerable:!0,configurable:!0});b.prototype.Wire=function(){var c=this;this._target.addEventListener("click",this._target.oncontextmenu=this.BuildEvent(this._onClick,this.BuildMouseClickEvent),!1);this._target.addEventListener("dblclick",this.BuildEvent(this._onDoubleClick,this.BuildMouseClickEvent),!1);this._target.addEventListener("mousedown",this.BuildEvent(this._onDown,this.BuildMouseClickEvent),!1);this._target.addEventListener("mouseup",this.BuildEvent(this._onUp,
this.BuildMouseClickEvent),!1);this._target.addEventListener("mousemove",this.BuildEvent(this._onMove,this.BuildMouseEvent),!1);/MSIE/i.test(navigator.userAgent)?this._target.addEventListener("wheel",this.BuildEvent(this._onScroll,function(d){d.wheelDeltaX=-d.deltaX;d.wheelDeltaY=-d.deltaY;return c.BuildMouseScrollEvent(d)}),!1):/Firefox/i.test(navigator.userAgent)?this._target.addEventListener("DOMMouseScroll",this.BuildEvent(this._onScroll,function(d){d.wheelDeltaX=1===d.axis?-d.detail:0;d.wheelDeltaY=
2===d.axis?-d.detail:0;return c.BuildMouseScrollEvent(d)}),!1):this._target.addEventListener("mousewheel",this.BuildEvent(this._onScroll,this.BuildMouseScrollEvent),!1)};b.prototype.BuildEvent=function(c,d,a){"undefined"===typeof a&&(a=!1);var b=this;return function(f){c.HasBindings()&&(c.Trigger(d.call(b,f)),f.preventDefault());return a}};b.prototype.BuildMouseScrollEvent=function(c){return{Position:this.GetMousePosition(c),Direction:this.GetMouseScrollDierction(c)}};b.prototype.BuildMouseEvent=
function(c){return{Position:this.GetMousePosition(c)}};b.prototype.BuildMouseClickEvent=function(c){return{Position:this.GetMousePosition(c),Button:this.GetMouseButton(c)}};b.prototype.GetMousePosition=function(c){return new a.Vector2d(c.offsetX?c.offsetX:c.pageX-this._target.offsetLeft,c.offsetY?c.offsetY:c.pageY-this._target.offsetTop)};b.prototype.GetMouseButton=function(c){return c.which?b.MouseButtonArray[c.which]:f._.MouseButton.Right};b.prototype.GetMouseScrollDierction=function(c){return new a.Vector2d(-Math.max(-1,
Math.min(1,c.wheelDeltaX)),-Math.max(-1,Math.min(1,c.wheelDeltaY)))};b.MouseButtonArray=[null,f._.MouseButton.Left,f._.MouseButton.Middle,f._.MouseButton.Right];return b}();f.MouseHandler=e})(a.Input||(a.Input={}))})(EndGate||(EndGate={}));
(function(a){var f=function(){function a(){this._type="Event";this._actions=[];this._hasBindings=!1}a.prototype.Bind=function(a){this._actions.push(a);this._hasBindings=!0};a.prototype.Unbind=function(a){for(var c=0;c<this._actions.length;c++)if(this._actions[c]===a){this._actions.splice(c,1);this._hasBindings=0<this._actions.length;break}};a.prototype.HasBindings=function(){return this._hasBindings};a.prototype.Trigger=function(){for(var a=0;a<this._actions.length;a++)this._actions[a]()};return a}();
a.EventHandler=f})(EndGate||(EndGate={}));
(function(a){(function(a){(function(a){var b=function(){function c(d,a){"undefined"===typeof a&&(a=!1);this._invoker=c._noop;this._action=d;a&&this.Trip()}c.prototype.Invoke=function(){for(var d=[],c=0;c<arguments.length-0;c++)d[c]=arguments[c+0];this._invoker.apply(this,d)};c.prototype.InvokeOnce=function(){for(var d=[],c=0;c<arguments.length-0;c++)d[c]=arguments[c+0];this._invoker.apply(this,d);this.Reset()};c.prototype.Trip=function(){this._invoker=this._action};c.prototype.Reset=function(){this._invoker=
c._noop};c._noop=function(){};return c}();a.NoopTripInvoker=b})(a.Utilities||(a.Utilities={}))})(a._||(a._={}))})(EndGate||(EndGate={}));
(function(a){(function(a){(function(a){var b=function(){function c(d,c,a){this.Ctrl=d;this.Alt=c;this.Shift=a}c.prototype.Equivalent=function(d){return this.Ctrl===d.Ctrl&&this.Alt===d.Alt&&this.Shift===d.Shift};c.BuildFromCommandString=function(d){var a=0<=d.toLowerCase().indexOf("ctrl+")?!0:!1,b=0<=d.toLowerCase().indexOf("alt+")?!0:!1;d=0<=d.toLowerCase().indexOf("shift+")?!0:!1;return new c(a,b,d)};return c}();a.KeyboardModifiers=b})(a.Assets||(a.Assets={}))})(a.Input||(a.Input={}))})(EndGate||
(EndGate={}));
(function(a){(function(a){var e={"~":"`","!":"1","@":"2","#":"3",$:"4","%":"5","^":"6","&":"7","*":"8","(":"9",")":"0",_:"-","+":"=",":":";",'"':"'","<":",",">":".","?":"/","|":"\\"},b={27:"esc",27:"escape",9:"tab",32:"space",13:"return",13:"enter",8:"backspace",45:"insert",36:"home",46:"delete",35:"end",37:"left",38:"up",39:"right",40:"down",112:"f1",113:"f2",114:"f3",115:"f4",116:"f5",117:"f6",118:"f7",119:"f8",120:"f9",121:"f10",122:"f11",123:"f12"},c=function(){function d(d){var c,l;this.Modifiers=
new a.Assets.KeyboardModifiers(d.ctrlKey,d.altKey,d.shiftKey);d.keyCode?c=d.keyCode:d.which&&(c=d.which);(l=String.fromCharCode(d.keyCode))===d.key||(l=b[c])||(l=String.fromCharCode(c).toLowerCase(),this.Modifiers.Shift&&e[l]&&(l=e[l]));this.Key=l}d.prototype.Matches=function(d){return this.Key.toLowerCase()===d.Key.toLowerCase()&&d.Modifiers.Equivalent(this.Modifiers)};return d}();a.KeyboardCommandEvent=c})(a.Input||(a.Input={}))})(EndGate||(EndGate={}));
(function(a){(function(a){(function(a){var b=function(){function c(){}c.ParseKey=function(d){d=d.split("+");return 1<d.length?d[d.length-1]:d[0]};return c}();a.KeyboardCommandHelper=b})(a._||(a._={}))})(a.Input||(a.Input={}))})(EndGate||(EndGate={}));
(function(a){(function(f){(function(e){var b=function(){function c(d,c){var b=this;this.Action=c;this.Modifiers=f.Assets.KeyboardModifiers.BuildFromCommandString(d);this.Key=f._.KeyboardCommandHelper.ParseKey(d);this._onDisposed=new a.EventHandler;this._onDisposeInvoker=new a._.Utilities.NoopTripInvoker(function(){b._onDisposed.Trigger()},!0)}Object.defineProperty(c.prototype,"OnDispose",{get:function(){return this._onDisposed},enumerable:!0,configurable:!0});c.prototype.Dispose=function(){this._onDisposeInvoker.InvokeOnce()};
return c}();e.KeyboardCommand=b})(f.Assets||(f.Assets={}))})(a.Input||(a.Input={}))})(EndGate||(EndGate={}));
(function(a){(function(f){var e=function(){function b(){this._onPressCommands={};this._onDownCommands={};this._onUpCommands={};this._onKeyPress=new a.EventHandler1;this._onKeyDown=new a.EventHandler1;this._onKeyUp=new a.EventHandler1;this.Wire()}Object.defineProperty(b.prototype,"OnKeyPress",{get:function(){return this._onKeyPress},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"OnKeyDown",{get:function(){return this._onKeyDown},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,
"OnKeyUp",{get:function(){return this._onKeyUp},enumerable:!0,configurable:!0});b.prototype.OnCommandPress=function(c,d){return this.UpdateCache(c,d,this._onPressCommands)};b.prototype.OnCommandDown=function(c,d){return this.UpdateCache(c,d,this._onDownCommands)};b.prototype.OnCommandUp=function(c,d){return this.UpdateCache(c,d,this._onUpCommands)};b.prototype.UpdateCache=function(c,d,a){c=new f.Assets.KeyboardCommand(c,d);var g=b._keyboardCommandIds++;c.OnDispose.Bind(function(){delete a[g]});return a[g]=
c};b.prototype.Wire=function(){document.addEventListener("keypress",this.BuildKeyEvent(this._onPressCommands,this.OnKeyPress),!1);document.addEventListener("keydown",this.BuildKeyEvent(this._onDownCommands,this.OnKeyDown),!1);document.addEventListener("keyup",this.BuildKeyEvent(this._onUpCommands,this.OnKeyUp),!1)};b.prototype.FocusingTextArea=function(c){var d;c.target?d=c.target:c.srcElement&&(d=c.srcElement);3===d.nodeType&&(d=d.parentNode);return"INPUT"===d.tagName||"TEXTAREA"===d.tagName?!0:
!1};b.prototype.BuildKeyEvent=function(c,d){var a=this;return function(b){var l,e=!0;if(!a.FocusingTextArea(b)){l=new f.KeyboardCommandEvent(b);d.Trigger(l);for(var k in c)l.Matches(c[k])&&(c[k].Action(),b.preventDefault(),e=!1);return e}}};b._keyboardCommandIds=0;return b}();f.KeyboardHandler=e})(a.Input||(a.Input={}))})(EndGate||(EndGate={}));
(function(a){(function(a){var e=function(){return function(b){this.Mouse=new a.MouseHandler(b);this.Keyboard=new a.KeyboardHandler}}();a.InputManager=e})(a.Input||(a.Input={}))})(EndGate||(EndGate={}));
(function(a){(function(a){var e=function(){function a(c,d,b,g){"undefined"===typeof c&&(c=!1);"undefined"===typeof d&&(d=100);"undefined"===typeof b&&(b=!1);"undefined"===typeof g&&(g="auto");this.Repeat=c;this.Volume=d;this.AutoPlay=b;this.Preload=g}a.prototype.Clone=function(){return new a(this.Repeat,this.Volume,this.AutoPlay,this.Preload)};a.Default=new a;return a}();a.AudioSettings=e})(a.Sound||(a.Sound={}))})(EndGate||(EndGate={}));
(function(a){(function(f){var e={mp3:"audio/mpeg",ogg:"audio/ogg",wav:"audio/wav",aac:"audio/aac",m4a:"audio/x-m4a"},b=function(){function c(d,c){"undefined"===typeof c&&(c=f.AudioSettings.Default);this._settings=c.Clone();this._audio=document.createElement("audio");this.SetAudioSource(d);this.ApplySettings();this._onComplete=new a.EventHandler1}Object.defineProperty(c.prototype,"OnComplete",{get:function(){return this._onComplete},enumerable:!0,configurable:!0});Object.defineProperty(c.prototype,
"Volume",{get:function(){return this._settings.Volume},set:function(d){this._settings.Volume=d;this._audio.volume=Math.max(Math.min(d/100,1),0)},enumerable:!0,configurable:!0});c.prototype.IsPlaying=function(){return!this._audio.paused};c.prototype.IsComplete=function(){return this._audio.ended};c.prototype.Play=function(){var d=this;0===this._audio.readyState?this._audio.addEventListener("canplay",function(){d._audio.play()},!0):this._audio.play()};c.prototype.Pause=function(){this._audio.pause()};
c.prototype.Seek=function(d){var c=this;0===this._audio.readyState?this._audio.addEventListener("canplay",function(){c._audio.currentTime=d},!0):this._audio.currentTime=d};c.prototype.Stop=function(){this.Seek(0);this._audio.pause()};c.prototype.SetAudioSource=function(d){var c,a;d instanceof Array||(d=[d]);for(var b=0;b<d.length;b++)c=document.createElement("source"),c.src=d[b],a=e[d[b].split(".").pop()],"undefined"!==typeof a&&(c.type=a),this._audio.appendChild(c)};c.prototype.ApplySettings=function(){var d=
this;this._audio.loop=this._settings.Repeat;this._audio.autoplay=this._settings.AutoPlay;this._audio.preload=this._settings.Preload;this.Volume=this._settings.Volume;this._audio.addEventListener("ended",function(c){d.OnComplete.Trigger(c)},!0)};return c}();f.AudioClip=b})(a.Sound||(a.Sound={}))})(EndGate||(EndGate={}));
(function(a){(function(a){var e=function(){function b(c){this._source=c}b.prototype.Play=function(c){"undefined"===typeof c&&(c=a.AudioSettings.Default);c=new a.AudioClip(this._source,c);c.Play();return c};return b}();a.AudioPlayer=e})(a.Sound||(a.Sound={}))})(EndGate||(EndGate={}));
(function(a){(function(a){var e=function(){function b(){this._audioPlayers={}}b.prototype.Load=function(c,d){this._audioPlayers[c]=new a.AudioPlayer(d);return this._audioPlayers[c]};b.prototype.Unload=function(c){var d=this._audioPlayers[c];delete this._audioPlayers[c];return d};b.prototype.Play=function(c,d){"undefined"===typeof d&&(d=a.AudioSettings.Default);return this._audioPlayers[c].Play(d)};b.prototype.GetAudioPlayer=function(c){return this._audioPlayers[c]};return b}();a.AudioManager=e})(a.Sound||
(a.Sound={}))})(EndGate||(EndGate={}));
(function(a){(function(f){var e=function(){function b(c){this._camera=c.Camera;this._layers=[];this._sceneryCanvas=this.BuildSceneryCanvas(c.DrawArea);this._renderer=new a.Rendering.Camera2dRenderer(this._sceneryCanvas,this._camera)}b.prototype.AddLayer=function(c){this._layers.push(c)};b.prototype.RemoveLayer=function(c){this._layers.splice(this._layers.indexOf(c),1)};b.prototype.Draw=function(){this._layers.sort(a.Graphics.Abstractions.Graphic2d._zindexSort);this._renderer.Render(this._layers)};
b.prototype.BuildSceneryCanvas=function(c){var d=document.createElement("canvas");d.width=c.width;d.height=c.height;d.style.position="absolute";d.style.zIndex="1";c.parentElement.insertBefore(d,c);return d};return b}();f.SceneryHandler=e})(a.Map||(a.Map={}))})(EndGate||(EndGate={}));(function(a){(function(a){var e=function(){return function(b){this.Scenery=new a.SceneryHandler(b)}}();a.MapManager=e})(a.Map||(a.Map={}))})(EndGate||(EndGate={}));
(function(a){var f=function(){function e(b){var c=this;this._type="Game";this._gameTime=new a.GameTime;this._ID=e._gameIds++;this.Scene=new a.Rendering.Scene2d(function(d){c.Draw(d)},b);this.Input=new a.Input.InputManager(this.Scene.DrawArea);this.Audio=new a.Sound.AudioManager;this.CollisionManager=new a.Collision.CollisionManager;this.Configuration=new a.GameConfiguration(GameRunnerInstance.Register(this));this.Map=new a.Map.MapManager(this.Scene)}e.prototype._PrepareUpdate=function(){this._gameTime.Update();
this.CollisionManager.Update(this._gameTime);this.Update(this._gameTime)};e.prototype.Update=function(a){};e.prototype._PrepareDraw=function(){this.Map.Scenery.Draw();this.Scene.Draw()};e.prototype.Draw=function(a){};e.prototype.Dispose=function(){this.Scene.Dispose();GameRunnerInstance.Unregister(this)};e._gameIds=0;return e}();a.Game=f})(EndGate||(EndGate={}));
(function(a){(function(a){(function(a){var b=function(){return function(){this.Down=this.Up=this.Right=this.Left=!1}}();a.LinearDirections=b})(a.Assets||(a.Assets={}))})(a.MovementControllers||(a.MovementControllers={}))})(EndGate||(EndGate={}));
(function(a){(function(f){(function(e){var b=function(){function c(d){this.Position=0<d.length?d[0].Position:a.Vector2d.Zero;this.Velocity=a.Vector2d.Zero;this.Rotation=0;this._frozen=!1;this._moveables=d}c.prototype.Freeze=function(){this._frozen=!0};c.prototype.Thaw=function(){this._frozen=!1};c.prototype.IsMoving=function(){return!this._frozen&&!this.Velocity.IsZero()};c.prototype.Update=function(d){for(d=0;d<this._moveables.length;d++)this._moveables[d].Position=this.Position,this._moveables[d].Rotation=
this.Rotation};return c}();e.MovementController=b})(f.Abstractions||(f.Abstractions={}))})(a.MovementControllers||(a.MovementControllers={}))})(EndGate||(EndGate={}));
(function(a){(function(f){var e=function(b){function c(d,c,g,l){"undefined"===typeof g&&(g=!0);"undefined"===typeof l&&(l=!0);var e=this;b.call(this,d);this._moveSpeed=c;this._moving=new f.Assets.LinearDirections;this.OnMove=new a.EventHandler1;this._rotationUpdater=new a._.Utilities.NoopTripInvoker(function(){e.UpdateRotation()},g);this._velocityUpdater=l?this.UpdateVelocityWithMultiDirection:this.UpdateVelocityNoMultiDirection}__extends(c,b);c.prototype.IsMovingInDirection=function(d){return this._moving[d]||
!1};c.prototype.StartMoving=function(d){this.Move(d,!0)};c.prototype.StopMoving=function(d){this.Move(d,!1)};c.prototype.MoveSpeed=function(d){"undefined"!==typeof d&&(this._moveSpeed=d,this._velocityUpdater());return this._moveSpeed};c.prototype.Update=function(d){this._frozen||(this.Position=this.Position.Add(this.Velocity.Multiply(d.Elapsed.Seconds)),b.prototype.Update.call(this,d))};c.prototype.Move=function(d,c){if("undefined"!==typeof this._moving[d])this._moving[d]=c,this._velocityUpdater(),
this._rotationUpdater.Invoke(),this.OnMove.Trigger({Direction:d,StartMoving:c});else throw Error(d+" is an unknown direction.");};c.prototype.UpdateVelocityNoMultiDirection=function(){var d=a.Vector2d.Zero;d.IsZero()&&(this._moving.Up&&(d.Y-=this._moveSpeed),this._moving.Down&&(d.Y+=this._moveSpeed),0===d.Y&&(this._moving.Left&&(d.X-=this._moveSpeed),this._moving.Right&&(d.X+=this._moveSpeed)));this.Velocity=d};c.prototype.UpdateVelocityWithMultiDirection=function(){var d=a.Vector2d.Zero;this._moving.Up&&
(d.Y-=this._moveSpeed);this._moving.Down&&(d.Y+=this._moveSpeed);this._moving.Left&&(d.X-=this._moveSpeed);this._moving.Right&&(d.X+=this._moveSpeed);this.Velocity=d};c.prototype.UpdateRotation=function(){this.Velocity.IsZero()||(this.Rotation=Math.atan2(this.Velocity.Y,this.Velocity.X))};return c}(f.Abstractions.MovementController);f.LinearMovementController=e})(a.MovementControllers||(a.MovementControllers={}))})(EndGate||(EndGate={}));
(function(a){(function(f){var e=function(){function b(c,d,b,g,l,e){"undefined"===typeof b&&(b=["w","Up"]);"undefined"===typeof g&&(g=["d","Right"]);"undefined"===typeof l&&(l=["s","Down"]);"undefined"===typeof e&&(e=["a","Left"]);this._keyboard=c;this._onMove=d;this._directions=new a.MovementControllers.Assets.LinearDirections;this.BindKeys(b,"OnCommandDown","Up",!0);this.BindKeys(g,"OnCommandDown","Right",!0);this.BindKeys(l,"OnCommandDown","Down",!0);this.BindKeys(e,"OnCommandDown","Left",!0);this.BindKeys(b,
"OnCommandUp","Up",!1);this.BindKeys(g,"OnCommandUp","Right",!1);this.BindKeys(l,"OnCommandUp","Down",!1);this.BindKeys(e,"OnCommandUp","Left",!1)}b.prototype.BindKeys=function(c,d,a,b){for(var e=this,f=0;f<c.length;f++)this._keyboard[d](c[f],function(){e._directions[a]!=b&&(e._directions[a]=b,e._onMove(a,b))})};return b}();f.DirectionalInputController=e})(a.InputControllers||(a.InputControllers={}))})(EndGate||(EndGate={}));
(function(a){a=a.Graphics||(a.Graphics={});a=a.Assets||(a.Assets={});a=a.FontFamily||(a.FontFamily={});a[a.Antiqua=0]="Antiqua";a[a.Arial=1]="Arial";a[a.Avqest=2]="Avqest";a[a.Blackletter=3]="Blackletter";a[a.Calibri=4]="Calibri";a[a.ComicSans=5]="ComicSans";a[a.Courier=6]="Courier";a[a.Decorative=7]="Decorative";a[a.Fraktur=8]="Fraktur";a[a.Frosty=9]="Frosty";a[a.Garamond=10]="Garamond";a[a.Georgia=11]="Georgia";a[a.Helvetica=12]="Helvetica";a[a.Impact=13]="Impact";a[a.Minion=14]="Minion";a[a.Modern=
15]="Modern";a[a.Monospace=16]="Monospace";a[a.Palatino=17]="Palatino";a[a.Roman=18]="Roman";a[a.Script=19]="Script";a[a.Swiss=20]="Swiss";a[a.TimesNewRoman=21]="TimesNewRoman";a[a.Verdana=22]="Verdana"})(EndGate||(EndGate={}));(function(a){a=a.Graphics||(a.Graphics={});a=a.Assets||(a.Assets={});a=a.FontVariant||(a.FontVariant={});a[a.Normal=0]="Normal";a[a.SmallCaps=1]="SmallCaps"})(EndGate||(EndGate={}));
(function(a){a=a.Graphics||(a.Graphics={});a=a.Assets||(a.Assets={});a=a.FontStyle||(a.FontStyle={});a[a.Normal=0]="Normal";a[a.Italic=1]="Italic";a[a.Oblique=2]="Oblique"})(EndGate||(EndGate={}));
(function(a){(function(a){(function(a){var b=function(){function c(){this._cachedState={fontSize:"10px",fontFamily:a.FontFamily.TimesNewRoman,fontVariant:a.FontVariant.Normal,fontWeight:"",fontStyle:a.FontStyle.Normal};this._refreshCache=!0;this._BuildFont()}Object.defineProperty(c.prototype,"FontSize",{get:function(){return this._cachedState.fontSize},set:function(d){this._refreshCache=!0;this._cachedState.fontSize=d},enumerable:!0,configurable:!0});Object.defineProperty(c.prototype,"FontFamily",
{get:function(){return this._cachedState.fontFamily},set:function(d){this._refreshCache=!0;this._cachedState.fontFamily=d},enumerable:!0,configurable:!0});Object.defineProperty(c.prototype,"FontVariant",{get:function(){return this._cachedState.fontVariant},set:function(d){this._refreshCache=!0;this._cachedState.fontVariant=d},enumerable:!0,configurable:!0});Object.defineProperty(c.prototype,"FontWeight",{get:function(){return this._cachedState.fontWeight},set:function(d){this._refreshCache=!0;this._cachedState.fontWeight=
d},enumerable:!0,configurable:!0});Object.defineProperty(c.prototype,"FontStyle",{get:function(){return this._cachedState.fontStyle},set:function(d){this._refreshCache=!0;this._cachedState.fontStyle=d},enumerable:!0,configurable:!0});c.prototype._BuildFont=function(){var d;this._refreshCache&&(d=this._cachedState.fontWeight+" "+a.FontStyle[this._cachedState.fontStyle].replace("Normal","")+" "+a.FontVariant[this._cachedState.fontVariant].replace("Normal","")+" "+this._cachedState.fontSize,void 0!==
this._cachedState.fontFamily&&(d+=" "+a.FontFamily[this._cachedState.fontFamily]),this._cachedFont=d.replace(/^\s\s*/,"").replace(/\s\s*$/,""),this._refreshCache=!1);return this._cachedFont};return c}();a.FontSettings=b})(a.Assets||(a.Assets={}))})(a.Graphics||(a.Graphics={}))})(EndGate||(EndGate={}));
(function(a){(function(f){var e=function(b){function c(d,c,g,e){"undefined"===typeof e&&(e="black");var n=this;b.call(this,new a.Vector2d(d,c));this._type="Text2d";this._text=g;this._stroker=new a._.Utilities.NoopTripInvoker(function(d){d.strokeText(n._text,0,0)});this._drawBounds=new a.Bounds.BoundingRectangle(this.Position,a.Size2d.One);this._recalculateBoundsSize=!0;this._fontSettings=new f.Assets.FontSettings;this.Align="center";this.Baseline="middle";this.Color=e}__extends(c,b);Object.defineProperty(c.prototype,
"Align",{get:function(){return this._State.TextAlign},set:function(d){this._State.TextAlign=d},enumerable:!0,configurable:!0});Object.defineProperty(c.prototype,"Baseline",{get:function(){return this._State.TextBaseline},set:function(d){this._State.TextBaseline=d},enumerable:!0,configurable:!0});Object.defineProperty(c.prototype,"Color",{get:function(){return this._State.FillStyle},set:function(d){this._State.FillStyle=d},enumerable:!0,configurable:!0});Object.defineProperty(c.prototype,"ShadowColor",
{get:function(){return this._State.ShadowColor},set:function(d){this._State.ShadowColor=d},enumerable:!0,configurable:!0});Object.defineProperty(c.prototype,"ShadowX",{get:function(){return this._State.ShadowOffsetX},set:function(d){this._State.ShadowOffsetX=d},enumerable:!0,configurable:!0});Object.defineProperty(c.prototype,"ShadowY",{get:function(){return this._State.ShadowOffsetY},set:function(d){this._State.ShadowOffsetY=d},enumerable:!0,configurable:!0});Object.defineProperty(c.prototype,"ShadowBlur",
{get:function(){return this._State.ShadowBlur},set:function(d){this._State.ShadowBlur=d},enumerable:!0,configurable:!0});Object.defineProperty(c.prototype,"Opacity",{get:function(){return this._State.GlobalAlpha},set:function(d){this._State.GlobalAlpha=d},enumerable:!0,configurable:!0});Object.defineProperty(c.prototype,"FontSettings",{get:function(){this._recalculateBoundsSize=!0;return this._fontSettings},enumerable:!0,configurable:!0});Object.defineProperty(c.prototype,"BorderThickness",{get:function(){return this._State.LineWidth},
set:function(d){0===d?this._stroker.Reset():this._stroker.Trip();this._State.LineWidth=d},enumerable:!0,configurable:!0});Object.defineProperty(c.prototype,"BorderColor",{get:function(){return this._State.StrokeStyle},set:function(d){this._stroker.Trip();this._State.StrokeStyle=d},enumerable:!0,configurable:!0});Object.defineProperty(c.prototype,"Text",{get:function(){return this._text},set:function(d){this._recalculateBoundsSize=!0;this._text=d},enumerable:!0,configurable:!0});c.prototype.Shadow=
function(d,c,a,b){this.ShadowX=d;this.ShadowY=c;this.ShadowColor=a;this.ShadowBlur=b};c.prototype.Border=function(d,c){this.BorderThickness=d;this.BorderColor=c};c.prototype.Draw=function(d){b.prototype._StartDraw.call(this,d);this._State.Font=this._fontSettings._BuildFont();d.fillText(this._text,0,0);this._stroker.Invoke(d);b.prototype._EndDraw.call(this,d);this._recalculateBoundsSize&&(this._recalculateBoundsSize=!1,d=d.measureText(this._text),this._drawBounds.Size.Width=d.width,this._drawBounds.Size.Height=
1.5*parseInt(this._fontSettings.FontSize))};c.prototype.GetDrawBounds=function(){this._drawBounds.Rotation=this.Rotation;this._drawBounds.Position=this.Position;return this._drawBounds};return c}(f.Abstractions.Graphic2d);f.Text2d=e})(a.Graphics||(a.Graphics={}))})(EndGate||(EndGate={}));
(function(a){(function(f){(function(e){var b=function(){function c(d,c,b,e,f,k,m){"undefined"===typeof e&&(e=0);"undefined"===typeof f&&(f=0);"undefined"===typeof k&&(k=c);"undefined"===typeof m&&(m=b);var h=this,q="undefined"!==typeof c;this._loaded=!1;this._onLoaded=new a.EventHandler1;this.Source=new Image;this.Source.onload=function(){h._loaded=!0;q||(h._size=new a.Size2d(h.Source.width,h.Source.height),h.ClipLocation=a.Vector2d.Zero,h.ClipSize=h._size.Clone());h._onLoaded.Trigger(h)};this._imageLocation=
this.Source.src=d;q&&(this._size=new a.Size2d(c,b),this.ClipLocation=new a.Vector2d(e,f),this.ClipSize=new a.Size2d(k,m))}Object.defineProperty(c.prototype,"OnLoaded",{get:function(){return this._onLoaded},enumerable:!0,configurable:!0});Object.defineProperty(c.prototype,"Size",{get:function(){return this._size.Clone()},enumerable:!0,configurable:!0});c.prototype.Loaded=function(){return this._loaded};c.prototype.Extract=function(d,a,b,e){return new c(this._imageLocation,this._size.Width,this._size.Height,
d,a,b,e)};return c}();e.ImageSource=b})(f.Assets||(f.Assets={}))})(a.Graphics||(a.Graphics={}))})(EndGate||(EndGate={}));
(function(a){(function(f){var e=function(b){function c(d,c,g,e,f){"undefined"===typeof e&&(e=g.ClipSize.Width);"undefined"===typeof f&&(f=g.ClipSize.Height);b.call(this,new a.Vector2d(d,c));this._type="Sprite2d";this.Image=g;this.Size=new a.Size2d(e,f)}__extends(c,b);Object.defineProperty(c.prototype,"Opacity",{get:function(){return this._State.GlobalAlpha},set:function(d){this._State.GlobalAlpha=d},enumerable:!0,configurable:!0});c.prototype.Draw=function(d){b.prototype._StartDraw.call(this,d);d.drawImage(this.Image.Source,
this.Image.ClipLocation.X,this.Image.ClipLocation.Y,this.Image.ClipSize.Width,this.Image.ClipSize.Height,-this.Size.HalfWidth,-this.Size.HalfHeight,this.Size.Width,this.Size.Height);b.prototype._EndDraw.call(this,d)};c.prototype.GetDrawBounds=function(){var d=new a.Bounds.BoundingRectangle(this.Position,this.Size);d.Rotation=this.Rotation;return d};return c}(f.Abstractions.Graphic2d);f.Sprite2d=e})(a.Graphics||(a.Graphics={}))})(EndGate||(EndGate={}));
(function(a){(function(f){var e=function(){function b(c,d,b,g,e){"undefined"===typeof e&&(e=a.Vector2d.Zero);this._imageSource=c;this._frameSize=b;this._frameCount=g;this._startOffset=e;this._repeating=this._playing=!1;this._currentFrame=0;this._framesPerRow=Math.min(Math.floor((c.ClipSize.Width-e.X)/b.Width),g);this._lastStepAt=0;this._onComplete=new a.EventHandler;this.Fps=d}Object.defineProperty(b.prototype,"OnComplete",{get:function(){return this._onComplete},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,
"Fps",{get:function(){return this._fps},set:function(c){this._fps=c;this._stepEvery=1E3/this._fps},enumerable:!0,configurable:!0});b.prototype.IsPlaying=function(){return this._playing};b.prototype.Play=function(c){"undefined"===typeof c&&(c=!1);this._lastStepAt=(new Date).getTime();this._repeating=c;this._playing=!0;this.UpdateImageSource()};b.prototype.Pause=function(){this._playing=!1};b.prototype.Step=function(c){"undefined"===typeof c&&(c=1);this._currentFrame+=c;this._currentFrame>=this._frameCount&&
(this._repeating?this._currentFrame%=this._frameCount:(this._currentFrame=this._frameCount-1,this.OnComplete.Trigger(),this.Stop(!1)));0!==c&&this.UpdateImageSource()};b.prototype.Stop=function(c){"undefined"===typeof c&&(c=!0);this._playing=!1;c&&this.Reset()};b.prototype.Reset=function(){this._currentFrame=0;this.UpdateImageSource()};b.prototype.Update=function(c){var d=c.Now.getTime()-this._lastStepAt,a=0;this._playing&&(a=Math.floor(d/this._stepEvery),0!==a&&(this._lastStepAt=c.Now.getTime(),
this.Step(a)))};b.prototype.UpdateImageSource=function(){var c=this.GetFrameRow(),d=this.GetFrameColumn();this._imageSource.ClipLocation.X=this._startOffset.X+d*this._frameSize.Width;this._imageSource.ClipLocation.Y=this._startOffset.Y+c*this._frameSize.Height;this._imageSource.ClipSize=this._frameSize};b.prototype.GetFrameRow=function(){return Math.floor(this._currentFrame/this._framesPerRow)};b.prototype.GetFrameColumn=function(){return Math.ceil(this._currentFrame%this._framesPerRow)};return b}();
f.SpriteAnimation=e})(a.Graphics||(a.Graphics={}))})(EndGate||(EndGate={}));
(function(a){(function(a){(function(a){var b=function(c){function d(d,a){c.call(this,d);this._type="Shape";this._stroke=this._fill=!1;"undefined"!==typeof a&&(this.Color=a)}__extends(d,c);Object.defineProperty(d.prototype,"Color",{get:function(){return this._State.FillStyle},set:function(d){this._fill=!0;this._State.FillStyle=d},enumerable:!0,configurable:!0});Object.defineProperty(d.prototype,"BorderThickness",{get:function(){return this._State.LineWidth},set:function(d){this._State.LineWidth=d},
enumerable:!0,configurable:!0});Object.defineProperty(d.prototype,"BorderColor",{get:function(){return this._State.StrokeStyle},set:function(d){this._stroke=!0;this._State.StrokeStyle=d},enumerable:!0,configurable:!0});Object.defineProperty(d.prototype,"ShadowColor",{get:function(){return this._State.ShadowColor},set:function(d){this._fill=!0;this._State.ShadowColor=d},enumerable:!0,configurable:!0});Object.defineProperty(d.prototype,"ShadowX",{get:function(){return this._State.ShadowOffsetX},set:function(d){this._State.ShadowOffsetX=
d},enumerable:!0,configurable:!0});Object.defineProperty(d.prototype,"ShadowY",{get:function(){return this._State.ShadowOffsetY},set:function(d){this._State.ShadowOffsetY=d},enumerable:!0,configurable:!0});Object.defineProperty(d.prototype,"ShadowBlur",{get:function(){return this._State.ShadowBlur},set:function(d){this._State.ShadowBlur=d},enumerable:!0,configurable:!0});Object.defineProperty(d.prototype,"Opacity",{get:function(){return this._State.GlobalAlpha},set:function(d){this._State.GlobalAlpha=
d},enumerable:!0,configurable:!0});d.prototype.Border=function(d,c){this.BorderThickness=d;this.BorderColor=c};d.prototype.Shadow=function(d,c,a,b){this.ShadowX=d;this.ShadowY=c;this.ShadowColor=a;this.ShadowBlur=b};d.prototype._StartDraw=function(d){c.prototype._StartDraw.call(this,d);d.beginPath()};d.prototype._EndDraw=function(d){this._fill&&d.fill();this._stroke?d.stroke():d.closePath();c.prototype._EndDraw.call(this,d)};d.prototype._BuildPath=function(d){};d.prototype.Draw=function(d){this._StartDraw(d);
this._BuildPath(d);this._EndDraw(d)};return d}(a.Graphic2d);a.Shape=b})(a.Abstractions||(a.Abstractions={}))})(a.Graphics||(a.Graphics={}))})(EndGate||(EndGate={}));
(function(a){(function(f){var e=function(b){function c(d,c,g,e){b.call(this,new a.Vector2d(d,c),e);this._type="Circle";this.Radius=g}__extends(c,b);c.prototype.GetDrawBounds=function(){var d=new a.Bounds.BoundingCircle(this.Position,this.Radius);d.Rotation=this.Rotation;return d};c.prototype._BuildPath=function(d){d.arc(0,0,this.Radius,0,Math.twoPI)};return c}(f.Abstractions.Shape);f.Circle=e})(a.Graphics||(a.Graphics={}))})(EndGate||(EndGate={}));
(function(a){(function(f){var e=function(b){function c(d,c,g,e,f){b.call(this,new a.Vector2d(d,c),f);this._type="Rectangle";this.Size=new a.Size2d(g,e)}__extends(c,b);c.prototype.GetDrawBounds=function(){var d=new a.Bounds.BoundingRectangle(this.Position,this.Size);d.Rotation=this.Rotation;return d};c.prototype._BuildPath=function(d){d.rect(-this.Size.HalfWidth,-this.Size.HalfHeight,this.Size.Width,this.Size.Height)};return c}(f.Abstractions.Shape);f.Rectangle=e})(a.Graphics||(a.Graphics={}))})(EndGate||
(EndGate={}));
(function(a){(function(f){var e=function(b){function c(d,c,g,e,f,k){"undefined"===typeof f&&(f=1);b.call(this,a.Vector2d.Zero);this._type="Line2d";this._from=new a.Vector2d(d,c);this._to=new a.Vector2d(g,e);this.LineWidth=f;this.UpdatePosition();"undefined"!==typeof k&&(this.Color=k)}__extends(c,b);Object.defineProperty(c.prototype,"From",{get:function(){return this._from},set:function(d){this._from=d;this.UpdatePosition()},enumerable:!0,configurable:!0});Object.defineProperty(c.prototype,"To",{get:function(){return this._to},
set:function(d){this._to=d;this.UpdatePosition()},enumerable:!0,configurable:!0});Object.defineProperty(c.prototype,"Color",{get:function(){return this._State.StrokeStyle},set:function(d){this._State.StrokeStyle=d},enumerable:!0,configurable:!0});Object.defineProperty(c.prototype,"LineWidth",{get:function(){return this._State.LineWidth},set:function(d){this._State.LineWidth=d},enumerable:!0,configurable:!0});Object.defineProperty(c.prototype,"LineCap",{get:function(){return this._State.LineCap},set:function(d){this._State.LineCap=
d},enumerable:!0,configurable:!0});Object.defineProperty(c.prototype,"Opacity",{get:function(){return this._State.GlobalAlpha},set:function(d){this._State.GlobalAlpha=d},enumerable:!0,configurable:!0});c.prototype.Draw=function(d){b.prototype._StartDraw.call(this,d);this._cachedPosition.Equivalent(this.Position)||this.RefreshCache();d.beginPath();d.moveTo(this._from.X-this.Position.X,this._from.Y-this.Position.Y);d.lineTo(this._to.X-this.Position.X,this._to.Y-this.Position.Y);d.stroke();b.prototype._EndDraw.call(this,
d)};c.prototype.GetDrawBounds=function(){var d=new a.Bounds.BoundingRectangle(this.Position,new a.Size2d(this._boundsWidth,this.LineWidth));d.Rotation=Math.atan2(this._difference.Y,this._difference.X)+this.Rotation;return d};c.prototype.UpdatePosition=function(){this.Position=this._from.Add(this._to).Divide(2);this._difference=this._to.Subtract(this._from);this._boundsWidth=this._from.Distance(this._to).Length();this._cachedPosition=this.Position.Clone()};c.prototype.RefreshCache=function(){var d=
this.Position.Subtract(this._cachedPosition);this._from.X+=d.X;this._from.Y+=d.Y;this._to.X+=d.X;this._to.Y+=d.Y;this._cachedPosition=this.Position.Clone()};return c}(f.Abstractions.Graphic2d);f.Line2d=e})(a.Graphics||(a.Graphics={}))})(EndGate||(EndGate={}));
(function(a){(function(f){var e=function(b){function c(d,c,g,e,n,k,m,h){"undefined"===typeof m&&(m=!1);"undefined"===typeof h&&(h="gray");b.call(this,new a.Vector2d(d,c));this._type="Grid";this._size=new a.Size2d(n*e,k*g);this._tileSize=new a.Size2d(n,k);this._grid=[];this._rows=g;this._columns=e;this.DrawGridLines=m;this._gridLines=[];c=this._size.Multiply(0.5);d=new a.Vector2d(-c.Width,-c.Height);c=new a.Vector2d(c.Width,c.Height);for(n=0;n<g;n++)for(this._grid[n]=[],this._gridLines.push(new f.Line2d(d.X,
d.Y+n*this._tileSize.Height,c.X,d.Y+n*this._tileSize.Height,1)),k=0;k<e;k++)0===n&&this._gridLines.push(new f.Line2d(d.X+k*this._tileSize.Width,d.Y,d.X+k*this._tileSize.Width,c.Y,1)),this._grid[n].push(null);this._gridLines.push(new f.Line2d(d.X,c.Y,c.X,c.Y,1));this._gridLines.push(new f.Line2d(c.X,d.Y,c.X,c.Y,1));this.GridLineColor=h}__extends(c,b);Object.defineProperty(c.prototype,"GridLineColor",{get:function(){return this._gridLineColor},set:function(d){this._gridLineColor=d;for(var c=0;c<this._gridLines.length;c++)this._gridLines[c].Color=
d},enumerable:!0,configurable:!0});Object.defineProperty(c.prototype,"Size",{get:function(){return this._size.Clone()},enumerable:!0,configurable:!0});Object.defineProperty(c.prototype,"TileSize",{get:function(){return this._tileSize.Clone()},enumerable:!0,configurable:!0});Object.defineProperty(c.prototype,"Rows",{get:function(){return this._rows},enumerable:!0,configurable:!0});Object.defineProperty(c.prototype,"Columns",{get:function(){return this._columns},enumerable:!0,configurable:!0});Object.defineProperty(c.prototype,
"Opacity",{get:function(){return this._State.GlobalAlpha},set:function(d){this._State.GlobalAlpha=d},enumerable:!0,configurable:!0});c.prototype.Fill=function(d,c,a){this.ValidRow(d)&&this.ValidColumn(c)&&(a.Position=this.GetInsideGridPosition(d,c),this._grid[d][c]=a,this.AddChild(a))};c.prototype.FillRow=function(d,c,a){"undefined"===typeof a&&(a=0);for(var b,e=0;e<c.length;e++)b=c[e],b.Position=this.GetInsideGridPosition(d,e+a),this._grid[d][e+a]=b,this.AddChild(b)};c.prototype.FillColumn=function(d,
c,a){"undefined"===typeof a&&(a=0);for(var b,e=0;e<c.length;e++)b=c[e],b.Position=this.GetInsideGridPosition(e+a,d),this._grid[e+a][d]=b,this.AddChild(b)};c.prototype.FillSpace=function(d,c,a){for(var b,e=0;e<a.length;e++)for(var f=0;f<a[e].length;f++)if(b=a[e][f])b.Position=this.GetInsideGridPosition(e+d,f+c),this._grid[e+d][f+c]=b,this.AddChild(b)};c.prototype.Get=function(d,c){return this.ValidRow(d)&&this.ValidColumn(c)?this._grid[d][c]:null};c.prototype.GetRow=function(d,c){"undefined"===typeof c&&
(c=0);for(var a=[],b=c;b<this._columns;b++)a.push(this._grid[d][b]);return a};c.prototype.GetColumn=function(d,c){"undefined"===typeof c&&(c=0);for(var a=[],b=c;b<this._rows;b++)a.push(this._grid[b][d]);return a};c.prototype.GetSpace=function(d,c,a,b){for(var e=[],f=a>=d?1:-1,m=b>=c?1:-1;d!==a+f&&!(d>=this._rows);d+=f)for(var h=c;h!==b+m&&!(h>=this._columns);h+=m)e.push(this._grid[d][h]);return e};c.prototype.Clear=function(d,c){if(!this.ValidRow(d)||!this.ValidColumn(c))return null;var a=this._grid[d][c];
this._grid[d][c]=null;this.RemoveChild(a);return a};c.prototype.ClearRow=function(d,c){for(var a=[],b=0;b<this._columns;b++)a.push(this._grid[d][b]),this.RemoveChild(this._grid[d][b]),this._grid[d][b]=null;return a};c.prototype.ClearColumn=function(d,c){for(var a=[],b=0;b<this._rows;b++)a.push(this._grid[b][d]),this.RemoveChild(this._grid[b][d]),this._grid[b][d]=null;return a};c.prototype.ClearSpace=function(d,c,a,b){for(var e=[],f=a>=d?1:-1,m=b>=c?1:-1;d!==a+f&&!(d>this._rows);d+=f)for(var h=c;h!==
b+m&&!(h>this._columns);h+=m)e.push(this._grid[d][h]),this.RemoveChild(this._grid[d][h]),this._grid[d][h]=null;return e};c.prototype.Draw=function(d){b.prototype._StartDraw.call(this,d);d.save();b.prototype._EndDraw.call(this,d);if(this.DrawGridLines)for(var c=0;c<this._gridLines.length;c++)this._gridLines[c].Draw(d);d.restore()};c.prototype.GetDrawBounds=function(){var d=new a.Bounds.BoundingRectangle(this.Position,this._size);d.Rotation=this.Rotation;return d};c.prototype.ConvertToRow=function(d){return Math.floor((d-
(this.Position.Y-this._size.HalfHeight))/this._tileSize.Height)};c.prototype.ConvertToColumn=function(d){return Math.floor((d-(this.Position.X-this._size.HalfWidth))/this._tileSize.Width)};c.prototype.GetInsideGridPosition=function(d,c){return new a.Vector2d(c*this._tileSize.Width-this._size.HalfWidth+this._tileSize.HalfWidth,d*this._tileSize.Height-this._size.HalfHeight+this._tileSize.HalfHeight)};c.prototype.ValidRow=function(d){return 0<=d&&d<this._rows};c.prototype.ValidColumn=function(d){return 0<=
d&&d<this._columns};return c}(f.Abstractions.Graphic2d);f.Grid=e})(a.Graphics||(a.Graphics={}))})(EndGate||(EndGate={}));
(function(a){var f=function(){function e(a,c,d,e){"undefined"===typeof a&&(a=0);"undefined"===typeof c&&(c=0);"undefined"===typeof d&&(d=0);"undefined"===typeof e&&(e=0);this._type="Matrix2x2";this.Values=[[a,c],[d,e]]}Object.defineProperty(e,"Zero",{get:function(){return new e},enumerable:!0,configurable:!0});Object.defineProperty(e,"Identity",{get:function(){return new e(1,0,0,1)},enumerable:!0,configurable:!0});e.prototype.Apply=function(a){this.Values[0][0]=a(this.Values[0][0]);this.Values[0][1]=
a(this.Values[0][1]);this.Values[1][0]=a(this.Values[1][0]);this.Values[1][1]=a(this.Values[1][1])};e.prototype.Trigger=function(a){a(this.Values[0][0]);a(this.Values[0][1]);a(this.Values[1][0]);a(this.Values[1][1])};e.prototype.Add=function(a){return"Matrix2x2"===a._type?new e(this.Values[0][0]+a.Values[0][0],this.Values[0][1]+a.Values[0][1],this.Values[1][0]+a.Values[1][0],this.Values[1][1]+a.Values[1][1]):new e(this.Values[0][0]+a,this.Values[0][1]+a,this.Values[1][0]+a,this.Values[1][1]+a)};e.prototype.Multiply=
function(a){return"Matrix2x2"===a._type?new e(this.Values[0][0]*a.Values[0][0]+this.Values[0][1]*a.Values[1][0],this.Values[0][0]*a.Values[0][1]+this.Values[0][1]*a.Values[1][1],this.Values[1][0]*a.Values[0][0]+this.Values[1][1]*a.Values[1][0],this.Values[1][0]*a.Values[0][1]+this.Values[1][1]*a.Values[1][1]):new e(this.Values[0][0]*a,this.Values[0][1]*a,this.Values[1][0]*a,this.Values[1][1]*a)};e.prototype.Subtract=function(a){return"Matrix2x2"===a._type?new e(this.Values[0][0]-a.Values[0][0],this.Values[0][1]-
a.Values[0][1],this.Values[1][0]-a.Values[1][0],this.Values[1][1]-a.Values[1][1]):new e(this.Values[0][0]-a,this.Values[0][1]-a,this.Values[1][0]-a,this.Values[1][1]-a)};e.prototype.SubtractFrom=function(a){return"Matrix2x2"===a._type?new e(a.Values[0][0]-this.Values[0][0],a.Values[0][1]-this.Values[0][1],a.Values[1][0]-this.Values[1][0],a.Values[1][1]-this.Values[1][1]):new e(a-this.Values[0][0],a-this.Values[0][1],a-this.Values[1][0],a-this.Values[1][1])};e.prototype.Divide=function(a){return"Matrix2x2"===
a._type?new e(this.Values[0][0]/a.Values[0][0],this.Values[0][1]/a.Values[0][1],this.Values[1][0]/a.Values[1][0],this.Values[1][1]/a.Values[1][1]):new e(this.Values[0][0]/a,this.Values[0][1]/a,this.Values[1][0]/a,this.Values[1][1]/a)};e.prototype.DivideFrom=function(a){return"Matrix2x2"===a._type?new e(a.Values[0][0]/this.Values[0][0],a.Values[0][1]/this.Values[0][1],a.Values[1][0]/this.Values[1][0],a.Values[1][1]/this.Values[1][1]):new e(a/this.Values[0][0],a/this.Values[0][1],a/this.Values[1][0],
a/this.Values[1][1])};e.prototype.Transform=function(b){return new a.Vector2d(this.Values[0][0]*b.X+this.Values[0][1]*b.Y,this.Values[1][0]*b.X+this.Values[1][1]*b.Y)};e.prototype.Transpose=function(){return new e(this.Values[0][0],this.Values[1][0],this.Values[0][1],this.Values[1][1])};e.prototype.Determinant=function(){return this.Values[0][0]*this.Values[1][1]-this.Values[0][1]*this.Values[1][0]};e.prototype.Inverse=function(){return(new e(this.Values[1][1],-this.Values[0][1],-this.Values[1][0],
this.Values[0][0])).Multiply(1/this.Determinant())};e.prototype.Clone=function(){return new e(this.Values[0][0],this.Values[0][1],this.Values[1][0],this.Values[1][1])};e.prototype.Equivalent=function(a){return this.Values[0][0]===a.Values[0][0]&&this.Values[0][1]===a.Values[0][1]&&this.Values[1][0]===a.Values[1][0]&&this.Values[1][1]===a.Values[1][1]};e.prototype.toString=function(){return this.Values[0].toString()+" "+this.Values[1].toString()};e.Scale=function(a){return new e(a.X,0,0,a.Y)};return e}();
a.Matrix2x2=f})(EndGate||(EndGate={}));(function(a){(function(f){var e=function(b){function c(d,c,g){b.call(this,new a.Vector2d(d,c));this._Resources=g}__extends(c,b);return c}(a.Graphics.Abstractions.Graphic2d);f.TileMap=e})(a.Map||(a.Map={}))})(EndGate||(EndGate={}));(function(a){(function(f){var e=function(a){function c(d,c,g){a.call(this,0,0,d,c,g)}__extends(c,a);return c}(a.Graphics.Sprite2d);f.SquareTile=e})(a.Map||(a.Map={}))})(EndGate||(EndGate={}));
(function(a){(function(f){var e=function(b){function c(d,c,g,e,f,k,m,h){"undefined"===typeof m&&(m=!0);"undefined"===typeof h&&(h=!1);b.call(this,d,c,f);this._grid=new a.Graphics.Grid(0,0,k.length,k[0].length,g,e,h);this._staticMap=m;this.FillGridWith(k);this._staticMap&&this.BuildCache()}__extends(c,b);c.ExtractTiles=function(a,c,b){for(var e=[],f=Math.floor(a.ClipSize.Width/c),k=Math.floor(a.ClipSize.Height/b),m=0;m<k;m++)for(var h=0;h<f;h++)e.push(a.Extract(h*c,m*b,c,b));return e};c.prototype.Draw=
function(a){b.prototype._StartDraw.call(this,a);this._staticMap?a.drawImage(this._mapCache,-this._mapCache.width/2,-this._mapCache.height/2):this._grid.Draw(a);b.prototype._EndDraw.call(this,a)};c.prototype.GetDrawBounds=function(){var a=this._grid.GetDrawBounds();a.Position=this.Position;return a};c.prototype.BuildCache=function(){var d=this._grid.Size,c=this._grid.Position;this._mapCache=document.createElement("canvas");this._mapCache.width=d.Width;this._mapCache.height=d.Height;this._grid.Position=
new a.Vector2d(d.HalfWidth,d.HalfHeight);this._grid.Draw(this._mapCache.getContext("2d"));this._grid.Position=c};c.prototype.FillGridWith=function(a){for(var c=[],b=0;b<a.length;b++){c[b]=[];for(var e=0;e<a[b].length;e++)0<=a[b][e]?c[b].push(new f.SquareTile(this._Resources[a[b][e]],this._grid.TileSize.Width,this._grid.TileSize.Height)):c[b].push(null)}this._grid.FillSpace(0,0,c)};return c}(f.TileMap);f.SquareTileMap=e})(a.Map||(a.Map={}))})(EndGate||(EndGate={}));var eg=EndGate;
Number.prototype.Clone=function(){return this};
(function(a){(function(f){var e=function(){function b(c,d,b,g){this._from=c.Clone();this._to=d.Clone();this._current=this._from.Clone();this._duration=b;this._elapsed=a.TimeSpan.Zero;this._playing=!1;this._onChange=new a.EventHandler1;this._onComplete=new a.EventHandler1;this._tweeningFunction=g}Object.defineProperty(b.prototype,"OnChange",{get:function(){return this._onChange},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"OnComplete",{get:function(){return this._onComplete},
enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"From",{get:function(){return this._from},set:function(a){this._from=a},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"To",{get:function(){return this._to},set:function(a){this._to=a},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"Current",{get:function(){return this._current},set:function(a){this._current=a},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"Duration",{get:function(){return this._duration},
set:function(a){this._duration=a},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"Elapsed",{get:function(){return this._elapsed.Clone()},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"TweeningFunction",{get:function(){return this._tweeningFunction},set:function(a){this._tweeningFunction=a},enumerable:!0,configurable:!0});b.prototype.IsPlaying=function(){return this._playing};b.prototype.Play=function(){this._playing=!0};b.prototype.Pause=function(){this._playing=
!1};b.prototype.Reset=function(){this._elapsed.Milliseconds=0;this._current=this._from.Clone()};b.prototype.Stop=function(){this._playing=!1;this.Reset()};b.prototype.Restart=function(){this.Reset();this.Play()};b.prototype.Reverse=function(){this._elapsed=a.TimeSpan.Zero;this._to=this._from;this._from=this.Current.Clone()};b.prototype.Update=function(a){this._playing&&!this._elapsed.Equivalent(this._duration)&&(this._elapsed=this._elapsed.Add(a.Elapsed),this._elapsed.Milliseconds>=this._duration.Milliseconds?
(this._elapsed=this._duration.Clone(),this._current=this._to.Clone(),this._playing=!1,this._onComplete.Trigger(this)):(this._UpdateTween(),this._onChange.Trigger(this._current.Clone())))};b.prototype._UpdateTween=function(){};return b}();f.Tween=e})(a.Tweening||(a.Tweening={}))})(EndGate||(EndGate={}));
(function(a){(function(a){var e=function(a){function c(d,c,g,e){a.call(this,d,c,g,e)}__extends(c,a);c.prototype._UpdateTween=function(){this.Current=this.TweeningFunction(this.From,this.To,this.Elapsed,this.Duration)};return c}(a.Tween);a.NumberTween=e})(a.Tweening||(a.Tweening={}))})(EndGate||(EndGate={}));
(function(a){(function(f){var e=function(b){function c(a,c,g,e){b.call(this,a,c,g,e)}__extends(c,b);c.prototype._UpdateTween=function(){this.Current=new a.Size2d(this.TweeningFunction(this.From.Width,this.To.Width,this.Elapsed,this.Duration),this.TweeningFunction(this.From.Height,this.To.Height,this.Elapsed,this.Duration))};return c}(f.Tween);f.Size2dTween=e})(a.Tweening||(a.Tweening={}))})(EndGate||(EndGate={}));
(function(a){(function(f){var e=function(b){function c(a,c,g,e){b.call(this,a,c,g,e)}__extends(c,b);c.prototype._UpdateTween=function(){this.Current=new a.Vector2d(this.TweeningFunction(this.From.X,this.To.X,this.Elapsed,this.Duration),this.TweeningFunction(this.From.Y,this.To.Y,this.Elapsed,this.Duration))};return c}(f.Tween);f.Vector2dTween=e})(a.Tweening||(a.Tweening={}))})(EndGate||(EndGate={}));
(function(a){(function(a){(function(a){var b=function(){function a(){}Object.defineProperty(a,"EaseIn",{get:function(){return a._easeIn},enumerable:!0,configurable:!0});Object.defineProperty(a,"EaseOut",{get:function(){return a._easeOut},enumerable:!0,configurable:!0});Object.defineProperty(a,"EaseInOut",{get:function(){return a._easeInOut},enumerable:!0,configurable:!0});a._easeIn=function(a,c,b,e){b=b.Milliseconds;return(c-a)*(b/=e.Milliseconds)*b*(2.70158*b-1.70158)+a};a._easeOut=function(a,c,
b,e){b=b.Milliseconds;return(c-a)*((b=b/e.Milliseconds-1)*b*(2.70158*b+1.70158)+1)+a};a._easeInOut=function(a,c,b,e){c-=a;b=b.Milliseconds;var f=1.70158;return 1>(b/=e.Milliseconds/2)?c/2*b*b*(((f*=1.525)+1)*b-f)+a:c/2*((b-=2)*b*(((f*=1.525)+1)*b+f)+2)+a};return a}();a.Back=b})(a.Functions||(a.Functions={}))})(a.Tweening||(a.Tweening={}))})(EndGate||(EndGate={}));
(function(a){(function(a){(function(a){var b=function(){function a(){}Object.defineProperty(a,"EaseIn",{get:function(){return a._easeIn},enumerable:!0,configurable:!0});Object.defineProperty(a,"EaseOut",{get:function(){return a._easeOut},enumerable:!0,configurable:!0});Object.defineProperty(a,"EaseInOut",{get:function(){return a._easeInOut},enumerable:!0,configurable:!0});a._easeIn=function(d,b,e,f){b-=d;return b-a.EaseOut(0,b,f.Subtract(e),f)+d};a._easeOut=function(a,c,b,e){c-=a;b=b.Milliseconds;
return(b/=e.Milliseconds)<1/2.75?c*7.5625*b*b+a:b<2/2.75?c*(7.5625*(b-=1.5/2.75)*b+0.75)+a:b<2.5/2.75?c*(7.5625*(b-=2.25/2.75)*b+0.9375)+a:c*(7.5625*(b-=2.625/2.75)*b+0.984375)+a};a._easeInOut=function(d,b,e,f){b-=d;return e.Milliseconds<f.Milliseconds/2?0.5*a.EaseIn(0,b,e.Multiply(2),f)+d:0.5*a.EaseOut(0,b,e.Multiply(2).Subtract(f),f)+0.5*b+d};return a}();a.Bounce=b})(a.Functions||(a.Functions={}))})(a.Tweening||(a.Tweening={}))})(EndGate||(EndGate={}));
(function(a){(function(a){(function(a){var b=function(){function a(){}Object.defineProperty(a,"EaseIn",{get:function(){return a._easeIn},enumerable:!0,configurable:!0});Object.defineProperty(a,"EaseOut",{get:function(){return a._easeOut},enumerable:!0,configurable:!0});Object.defineProperty(a,"EaseInOut",{get:function(){return a._easeInOut},enumerable:!0,configurable:!0});a._easeIn=function(a,c,b,e){b=b.Milliseconds;return-(c-a)*(Math.sqrt(1-(b/=e.Milliseconds)*b)-1)+a};a._easeOut=function(a,c,b,
e){b=b.Milliseconds;return(c-a)*Math.sqrt(1-(b=b/e.Milliseconds-1)*b)+a};a._easeInOut=function(a,c,b,e){c-=a;b=b.Milliseconds;return 1>(b/=e.Milliseconds/2)?-c/2*(Math.sqrt(1-b*b)-1)+a:c/2*(Math.sqrt(1-(b-=2)*b)+1)+a};return a}();a.Circular=b})(a.Functions||(a.Functions={}))})(a.Tweening||(a.Tweening={}))})(EndGate||(EndGate={}));
(function(a){(function(a){(function(a){var b=function(){function a(){}Object.defineProperty(a,"EaseIn",{get:function(){return a._easeIn},enumerable:!0,configurable:!0});Object.defineProperty(a,"EaseOut",{get:function(){return a._easeOut},enumerable:!0,configurable:!0});Object.defineProperty(a,"EaseInOut",{get:function(){return a._easeInOut},enumerable:!0,configurable:!0});a._easeIn=function(a,c,b,e){b=b.Milliseconds;return(c-a)*(b/=e.Milliseconds)*b*b+a};a._easeOut=function(a,c,b,e){b=b.Milliseconds;
return(c-a)*((b=b/e.Milliseconds-1)*b*b+1)+a};a._easeInOut=function(a,c,b,e){c-=a;b=b.Milliseconds;return 1>(b/=e.Milliseconds/2)?c/2*b*b*b+a:c/2*((b-=2)*b*b+2)+a};return a}();a.Cubic=b})(a.Functions||(a.Functions={}))})(a.Tweening||(a.Tweening={}))})(EndGate||(EndGate={}));
(function(a){(function(a){(function(a){var b=function(){function a(){}Object.defineProperty(a,"EaseIn",{get:function(){return a._easeIn},enumerable:!0,configurable:!0});Object.defineProperty(a,"EaseOut",{get:function(){return a._easeOut},enumerable:!0,configurable:!0});Object.defineProperty(a,"EaseInOut",{get:function(){return a._easeInOut},enumerable:!0,configurable:!0});a._easeIn=function(a,c,b,e){c-=a;b=b.Milliseconds;var f,k;if(0===b)return a;if(1===(b/=e.Milliseconds))return a+c;f=0.3*e.Milliseconds;
k=f/4;return-(c*Math.pow(2,10*(b-=1))*Math.sin((b*e.Milliseconds-k)*2*Math.PI/f))+a};a._easeOut=function(a,c,b,e){c-=a;b=b.Milliseconds;var f,k;if(0===b)return a;if(1===(b/=e.Milliseconds))return a+c;f=0.3*e.Milliseconds;k=f/4;return c*Math.pow(2,-10*b)*Math.sin((b*e.Milliseconds-k)*2*Math.PI/f)+c+a};a._easeInOut=function(a,c,b,e){c-=a;b=b.Milliseconds;var f,k;if(0===b)return a;if(2===(b/=e.Milliseconds/2))return a+c;f=e.Milliseconds*0.3*1.5;k=f/4;return 1>b?-0.5*c*Math.pow(2,10*(b-=1))*Math.sin((b*
e.Milliseconds-k)*2*Math.PI/f)+a:0.5*c*Math.pow(2,-10*(b-=1))*Math.sin((b*e.Milliseconds-k)*2*Math.PI/f)+c+a};return a}();a.Elastic=b})(a.Functions||(a.Functions={}))})(a.Tweening||(a.Tweening={}))})(EndGate||(EndGate={}));
(function(a){(function(a){(function(a){var b=function(){function a(){}Object.defineProperty(a,"EaseIn",{get:function(){return a._easeIn},enumerable:!0,configurable:!0});Object.defineProperty(a,"EaseOut",{get:function(){return a._easeOut},enumerable:!0,configurable:!0});Object.defineProperty(a,"EaseInOut",{get:function(){return a._easeInOut},enumerable:!0,configurable:!0});a._easeIn=function(a,c,b,e){b=b.Milliseconds;return 0==b?a:(c-a)*Math.pow(2,10*(b/e.Milliseconds-1))+a};a._easeOut=function(a,
c,b,e){c-=a;b=b.Milliseconds;return b==e.Milliseconds?a+c:c*(-Math.pow(2,-10*b/e.Milliseconds)+1)+a};a._easeInOut=function(a,c,b,e){c-=a;b=b.Milliseconds;return 0==b?a:b==e.Milliseconds?a+c:1>(b/=e.Milliseconds/2)?c/2*Math.pow(2,10*(b-1))+a:c/2*(-Math.pow(2,-10*--b)+2)+a};return a}();a.Exponential=b})(a.Functions||(a.Functions={}))})(a.Tweening||(a.Tweening={}))})(EndGate||(EndGate={}));
(function(a){(function(a){(function(a){var b=function(){function a(){}Object.defineProperty(a,"EaseNone",{get:function(){return a._easeNone},enumerable:!0,configurable:!0});a._easeNone=function(a,c,b,e){return(c-a)*b.Milliseconds/e.Milliseconds+a};return a}();a.Linear=b})(a.Functions||(a.Functions={}))})(a.Tweening||(a.Tweening={}))})(EndGate||(EndGate={}));
(function(a){(function(a){(function(a){var b=function(){function a(){}Object.defineProperty(a,"EaseIn",{get:function(){return a._easeIn},enumerable:!0,configurable:!0});Object.defineProperty(a,"EaseOut",{get:function(){return a._easeOut},enumerable:!0,configurable:!0});Object.defineProperty(a,"EaseInOut",{get:function(){return a._easeInOut},enumerable:!0,configurable:!0});a._easeIn=function(a,c,b,e){b=b.Milliseconds;return(c-a)*(b/=e.Milliseconds)*b+a};a._easeOut=function(a,c,b,e){b=b.Milliseconds;
return-(c-a)*(b/=e.Milliseconds)*(b-2)+a};a._easeInOut=function(a,c,b,e){c-=a;b=b.Milliseconds;return 1>(b/=e.Milliseconds/2)?c/2*b*b+a:-c/2*(--b*(b-2)-1)+a};return a}();a.Quadratic=b})(a.Functions||(a.Functions={}))})(a.Tweening||(a.Tweening={}))})(EndGate||(EndGate={}));
(function(a){(function(a){(function(a){var b=function(){function a(){}Object.defineProperty(a,"EaseIn",{get:function(){return a._easeIn},enumerable:!0,configurable:!0});Object.defineProperty(a,"EaseOut",{get:function(){return a._easeOut},enumerable:!0,configurable:!0});Object.defineProperty(a,"EaseInOut",{get:function(){return a._easeInOut},enumerable:!0,configurable:!0});a._easeIn=function(a,c,b,e){b=b.Milliseconds;return(c-a)*(b/=e.Milliseconds)*b*b*b+a};a._easeOut=function(a,c,b,e){b=b.Milliseconds;
return-(c-a)*((b=b/e.Milliseconds-1)*b*b*b-1)+a};a._easeInOut=function(a,c,b,e){c-=a;b=b.Milliseconds;return 1>(b/=e.Milliseconds/2)?c/2*b*b*b*b+a:-c/2*((b-=2)*b*b*b-2)+a};return a}();a.Quartic=b})(a.Functions||(a.Functions={}))})(a.Tweening||(a.Tweening={}))})(EndGate||(EndGate={}));
(function(a){(function(a){(function(a){var b=function(){function a(){}Object.defineProperty(a,"EaseIn",{get:function(){return a._easeIn},enumerable:!0,configurable:!0});Object.defineProperty(a,"EaseOut",{get:function(){return a._easeOut},enumerable:!0,configurable:!0});Object.defineProperty(a,"EaseInOut",{get:function(){return a._easeInOut},enumerable:!0,configurable:!0});a._easeIn=function(a,c,b,e){b=b.Milliseconds;return(c-a)*(b/=e.Milliseconds)*b*b*b*b+a};a._easeOut=function(a,c,b,e){b=b.Milliseconds;
return(c-a)*((b=b/e.Milliseconds-1)*b*b*b*b+1)+a};a._easeInOut=function(a,c,b,e){c-=a;b=b.Milliseconds;return 1>(b/=e.Milliseconds/2)?c/2*b*b*b*b*b+a:c/2*((b-=2)*b*b*b*b+2)+a};return a}();a.Quintic=b})(a.Functions||(a.Functions={}))})(a.Tweening||(a.Tweening={}))})(EndGate||(EndGate={}));
(function(a){(function(a){(function(a){var b=function(){function a(){}Object.defineProperty(a,"EaseIn",{get:function(){return a._easeIn},enumerable:!0,configurable:!0});Object.defineProperty(a,"EaseOut",{get:function(){return a._easeOut},enumerable:!0,configurable:!0});Object.defineProperty(a,"EaseInOut",{get:function(){return a._easeInOut},enumerable:!0,configurable:!0});a._easeIn=function(a,b,c,e){b-=a;return-b*Math.cos(c.Milliseconds/e.Milliseconds*(Math.PI/2))+b+a};a._easeOut=function(a,b,c,e){return(b-
a)*Math.sin(c.Milliseconds/e.Milliseconds*(Math.PI/2))+a};a._easeInOut=function(a,b,c,e){return-(b-a)/2*(Math.cos(Math.PI*c.Milliseconds/e.Milliseconds)-1)+a};return a}();a.Sinusoidal=b})(a.Functions||(a.Functions={}))})(a.Tweening||(a.Tweening={}))})(EndGate||(EndGate={}));
(function(a){var f=function(){function a(){this._type="Event";this._actions=[];this._hasBindings=!1}a.prototype.Bind=function(a){this._actions.push(a);this._hasBindings=!0};a.prototype.Unbind=function(a){for(var c=0;c<this._actions.length;c++)if(this._actions[c]===a){this._actions.splice(c,1);this._hasBindings=0<this._actions.length;break}};a.prototype.HasBindings=function(){return this._hasBindings};a.prototype.Trigger=function(a,c,d){for(var e=0;e<this._actions.length;e++)this._actions[e](a,c,d)};
return a}();a.EventHandler3=f})(EndGate||(EndGate={}));
